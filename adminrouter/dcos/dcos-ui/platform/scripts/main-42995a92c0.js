"use strict";angular.module("com.dcos.app",["ngAnimate","ngResource","ui.router","ui.bootstrap","ngMessages","ui.router.tabs","ui.select","smart-table","angular-svg-round-progressbar","ngTagsInput","ngMaterial","ngCookies","ivh.treeview","angular-advanced-searchbox","angular-json-editor"]),angular.module("com.dcos.app").animation(".ease",function(){return{enter:function(e,t){},leave:function(e,t){},addClass:function(e,t,i){},removeClass:function(e,t,i){}}}),angular.module("com.dcos.app").config(["$httpProvider","JSONEditorProvider",function(e,t){t.configure({defaults:{options:{disable_edit_json:!0,disable_properties:!0}}}),e.interceptors.push("tokenService"),e.interceptors.push(["$rootScope","$q","HttpPendingRequestsService",function(e,t,i){return{request:function(e){return e=e||{},void 0!==e.timeout||e.noCancelOnRouteChange||(e.timeout=i.newTimeout()),e},responseError:function(i){return/\w+\/password$/.test(i.config.url)?t.reject(i):(401==i.status&&e.$broadcast("unauthorized"),i.config.timeout.isGloballyCancelled?t.defer().promise:t.reject(i))}}}])}]),angular.module("com.dcos.app").config(["$httpProvider","$stateProvider","$urlRouterProvider",function(e,t,i){}]),angular.module("com.dcos.app").run(["$templateCache","$rootScope",function(e,t){e.put("bootstrap/choices.tpl.html",'<ul class="ui-select-choices ui-select-choices-content ui-select-dropdown dropdown-menu" role="listbox" ng-show="$select.open && $select.items.length > 0"><li ng-show="childItems && !isParent" class="ui-select-breadcrumbs"><span class="ui-breadcrumb" ng-click="loadParentItems($select)"><< 返回</span></li><li class="ui-select-choices-group" id="ui-select-choices-{{ $select.generatedId }}"><div class="divider" ng-show="$select.isGrouped && $index > 0"></div><div ng-show="$select.isGrouped" class="ui-select-choices-group-label dropdown-header" ng-bind="$group.name"></div><div ng-attr-id="ui-select-choices-row-{{ $select.generatedId }}-{{$index}}" class="ui-select-choices-row" ng-class="{disabled: $select.isDisabled(this)}" role="option"><a href="" class="ui-select-choices-row-inner"></a></div></li></ul>')}]),angular.module("com.dcos.app").factory("tokenService",["$cookies",function(e){return{request:function(t){return e.getObject("token")&&(t.headers["X-Auth-token"]=e.getObject("token").id),t}}}]).factory("HttpPendingRequestsService",["$q",function(e){var t=[];return{newTimeout:function(){var i=e.defer();return t.push(i),i.promise},cancelAll:function(){angular.forEach(t,function(e){e.promise.isGloballyCancelled=!0,e.resolve()}),t.length=0}}}]),angular.module("com.dcos.app").constant("api",{initPageSize:10,serverAddress:"10.254.10.18:9091",root:"/api",apiOf:function(e){if(!e.match("^/"))throw"path must start by /";return this.root+e}}),angular.module("com.dcos.app").constant("Errors",{email:"不是有效格式的邮件地址",required:"此项不能为空",same:"此项必须与密码相同"}),angular.module("com.dcos.app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("app",{url:"/app",template:"<div ui-view></div>","abstract":!0}),e.state("app.list",{url:"/list",templateUrl:"controllers/app/list.html",controller:"AppListController as vm"}),e.state("app.detail",{url:"/detail",templateUrl:"controllers/app/detail/detail.html",controller:"AppDetailController as vm"})}]),angular.module("com.dcos.app").controller("AppCreateController",["$scope","$uibModalInstance","message",function(e,t,i){e.message=i,e.currentStage=0,e.ok=function(){t.close()},e.cancel=function(){t.dismiss("cancel")}}]),angular.module("com.dcos.app").controller("AppDetailController",["$http","$uibModal",function(e,t){var i=this;i.status="active",i.slaves=[];for(var r=0;30>r;r++)i.slaves[r]={name:"node-"+r,cpus:10.3+10*r,ram:"128",disk:"128",status:"Active",owner:"root",operation:"chown"};i.tab="config",i.sortKey="name",i.sort=function(e){i.sortKey=e},i.configs={"节点状态":"active","节点属性":{},"主机名":"ibm-poc-19-74","主机ID":"cc44f8e6-39b8-4f57-9dbc-1b068457ef24-S2","可用资源":{cpus:1.75,disk:179965,mem:15791,ports:"[31002-31759, 31761-32000]"},"进程号":"slave(1)@10.133.19.74:5051","注册时间":1456774068.4234,"预留资源":{},"资源总量":{cpus:8,disk:179965,mem:15023,ports:"[31000-32000]"},"已用资源":{cpus:7.25,disk:0,mem:272,ports:"[31000-31001, 31760-31760]"},"系统版本":"0.26.0"},i.logs=[{time:"20.6.3.4",text:"error, openstack nova",level:"critical"},{time:"20.6.3.5",text:"error, openstack nova",level:"critical"},{time:"20.6.3.6",text:"error, openstack nova",level:"critical"}],i.message="节点进去维护状态后,所有在节点之上的容器都会被清空!",i.operate=function(e){var r=t.open({animation:!0,templateUrl:"operations.html",controller:"ModalInstanceCtrl",size:e,resolve:{message:function(){return i.message}}});r.result.then(function(){},function(){})}}]),angular.module("com.dcos.app").controller("AppListController",["$http","$uibModal",function(e,t){var i=this;i.apps=[];for(var r=0;10>r;r++)i.apps[r]={name:"app"+r,status:r%2?"running":"deploying",healthy:r%2?"health":"unhealth",cpu:r,mem:10*r,instances:r};i.message="节点进去维护状态后,所有在节点之上的容器都会被清空!",i.pkgs=[{name:"Jenkins",icon:"https://downloads.mesosphere.com/universe/assets/icon-service-jenkins-small.png",version:"0.2.3"},{name:"Marathon",icon:"https://downloads.mesosphere.com/universe/assets/icon-service-marathon-small.png",version:"1.1.1"},{name:"Chronos",icon:"https://downloads.mesosphere.com/universe/assets/icon-service-chronos-small.png",version:"2.4.0"},{name:"Spark",icon:"https://downloads.mesosphere.com/universe/assets/icon-service-spark-small.png",version:"0.2.3"},{name:"Kafka",icon:"https://downloads.mesosphere.com/universe/assets/icon-service-kafka-small.png",version:"0.2.3"}],i.create=function(e){var r=t.open({animation:!0,templateUrl:"controllers/app/create.html",controller:"AppCreateController",size:e,resolve:{message:function(){return i.message}}});r.result.then(function(){},function(){})}}]),angular.module("com.dcos.app").controller("HomeIndexController",["$cookies","$http","$scope","$interval","$mdSidenav","HomeService","SystemService",function(e,t,i,r,n,o,a){var s=this,l=e.getObject("token");s.projectName=l.project.name,s.projectId=l.project.id,"*"==s.projectId&&(s.projectName="*"),s.info={"master/cpus_used":0,"master/cpus_total":0,"master/mem_used":0,"master/mem_total":0,"master/disk_used":0,"master/disk_total":0,"master/tasks_running":0,"master/tasks_all":0,"master/slaves_active":0,"master/slaves_all":0},s.getDcosInfo=function(){o.getSnapshot().success(function(e){if(e.slaves){for(var t=e.slaves,i=t.length,r=0,n=0,o=0,a=0,l=0,c=0,d=0,h=0,u=0;i>u;u++)("*"==s.projectId||t[u].reserved_resources[s.projectName])&&(r+=t[u].used_resources.cpus,n+=t[u].used_resources.mem,o+=t[u].used_resources.disk,a+=t[u].resources.cpus,l+=t[u].resources.mem,c+=t[u].resources.disk,h+=1,t[u].active&&(d+=1));s.info["master/slaves_active"]=d,s.info["master/slaves_all"]=h,s.info["master/cpus_used"]=r,s.info["master/mem_used"]=n,s.info["master/disk_used"]=o,s.info["master/cpus_total"]=a,s.info["master/mem_total"]=l,s.info["master/disk_total"]=c}}),o.getStat(s.projectName).success(function(e){s.info["master/tasks_running"]=e.task_stat.task_running||0,s.info["master/tasks_all"]=e.task_stat.task_total||0})},s.getDcosInfo(),s.dcosInfo=r(function(){s.getDcosInfo()},3e4),i.$on("$destroy",function(){r.cancel(s.dcosInfo)})}]),angular.module("com.dcos.app").config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/notFound"),e.state("default",{url:"",templateUrl:"controllers/home/home.html",controller:"HomeIndexController as vm"}),e.state("home",{url:"/",templateUrl:"controllers/home/home.html",controller:"HomeIndexController as vm"}),e.state("notFound",{url:"/notFound",templateUrl:"controllers/home/notFound.html",controller:"HomeNotFoundController as vm"})}]),angular.module("com.dcos.app").factory("HomeService",["$http",function(e){return{getSnapshot:function(){return e({method:"GET",url:"/cache/master/slaves"})},getStat:function(t){return e({method:"GET",url:"/tasc/api/v1/stat?project_id="+t})}}}]),angular.module("com.dcos.app").controller("HomeNotFoundController",function(){}),angular.module("com.dcos.app").controller("ImageCreateController",["$scope","$uibModalInstance","message",function(e,t,i){e.message=i,e.currentStage=0,e.ok=function(){t.close()},e.cancel=function(){t.dismiss("cancel")}}]),angular.module("com.dcos.app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("image",{url:"/image",template:"<div ui-view></div>","abstract":!0}),e.state("image.list",{url:"/list",templateUrl:"controllers/images/list.html",controller:"ImageListController as vm"})}]),angular.module("com.dcos.app").controller("ImageListController",["$http","$uibModal",function(e,t){var i=this;i.apps=[];for(var r=0;10>r;r++)i.apps[r]={name:"app"+r,status:r%2?"running":"deploying",healthy:r%2?"health":"unhealth",cpu:r,mem:10*r,instances:r};i.message="节点进去维护状态后,所有在节点之上的容器都会被清空!",i.upload=function(e){var r=t.open({animation:!0,templateUrl:"controllers/images/create.html",controller:"ImageCreateController",size:e,resolve:{message:function(){return i.message}}});r.result.then(function(){},function(){})}}]),angular.module("com.dcos.app").controller("LogComponentController",["LogService",function(e){var t=this;t.filterParams=[{key:"time",name:"时间",placeholder:"格式[*,*]，*: yyyy-MM-dd HH-mm-ss或空"},{key:"message",name:"日志",placeholder:"message..."}],t.compArr=[{key:"all",value:"*"},{key:"dcos-ddt.service",value:"3dt"},{key:"dcos-epmd.service",value:"epmd"},{key:"dcos-gen-resolvconf.service",value:"gen_resolvconf.py"},{key:"dcos-logrotate.service",value:"logrotate"},{key:"dcos-mesos-slave.service",value:"mesos-slave"},{key:"dcos-minuteman.service",value:"env"},{key:"dcos-spartan.service",value:"spartan"},{key:"dcos-spartan-watchdog.service",value:"toybox"},{key:"dcos-vol-discovery-priv-agent.service",value:"make_disk_resources"},{key:"dcos-adminrouter.service",value:"nginx"},{key:"dcos-exhibitor.service",value:"unshare"},{key:"dcos-history-service.service",value:"dcos-history"},{key:"dcos-keepalived.service",value:"keepalived-wrapper"},{key:"dcos-marathon.service",value:"java"},{key:"dcos-mesos-dns.service",value:"mesos-dns"},{key:"dcos-mesos-master.service",value:"mesos-master"},{key:"dcos-oauth.service",value:"docs-oauth"},{key:"dcos-signal.service",value:"signal"}],t.componentLogs=[],t.loadMore=!1,t.firstLoading=!0,e.getHostsMap().success(function(i){t.hostMap=i,t.hostMap.unshift({IP:"all",hostname:"*"}),e.getComponentLog().success(function(e){t.firstLoading=!1,t.componentLogs=e.hits.hits,t.scrollId=e._scroll_id})}),t.hostnameToIp=function(e){for(var i=0,r=t.hostMap.length;r>i;i++)if(t.hostMap[i].hostname==e)return t.hostMap[i].IP},t.programToComp=function(e){if(e)for(var i=0,r=t.compArr.length;r>i;i++)if(t.compArr[i].value==e)return t.compArr[i].key},t.firstPage=function(){if(t.searchConditions.time){var i=e.formatTimestamp(t.searchConditions.time);if(!i)return void(t.componentLogs=[]);t.searchConditions.timestamp=i}t.firstLoading=!0,e.getComponentLog(t.searchConditions).success(function(e){t.firstLoading=!1,t.componentLogs=e.hits.hits,t.scrollId=e._scroll_id,angular.element(".scroll-area")[0].scrollTop=0})},t.searchLogs=function(){t.firstPage()},t.nextPage=function(){t.loadMore||(t.loadMore=!0,e.getNextPageLog(t.scrollId).success(function(e){t.componentLogs=t.componentLogs.concat(e.hits.hits),t.loadMore=!1}))}}]),angular.module("com.dcos.app").directive("ngMouseScroll",["$window",function(e){return{restrict:"EA",link:function(t,i,r){t.initLayout=function(){for(var e=$(i).parents(".p-log-list").outerHeight()-$(i).parents(".p-log-list").find(".pt").outerHeight(!0)-70,t=0,r=0,n=$(i).siblings().length;n>r;r++)t+=$($(i).siblings()[r]).outerHeight(!0);$(i).css({height:e-t,minHeight:"100px",overflow:"auto"})},t.initLayout(),e.onResize=function(){t.initLayout(),t.$apply()},t.initTop=0,$(i).bind("scroll",function(e){var e=window.event||e,n=$(i)[0].clientHeight,o=$(i)[0].scrollHeight,a=$(i)[0].scrollTop;a>t.initTop&&n+a>=o-100&&t.$apply(function(){t.$eval(r.ngMouseScroll)}),t.initTop=a})}}}]).directive("logSort",function(){return{restrict:"EA",scope:{sortKey:"=",reverse:"=",sort:"&"},link:function(e,t,i){t=$(t),t.on("click",function(){e.sortKey=i.logSort,t.hasClass("sort-asc")||t.hasClass("sort-desc")?t.hasClass("sort-asc")?(t.removeClass("sort-asc").addClass("sort-desc"),e.reverse=!0):t.hasClass("sort-desc")&&(t.removeClass("sort-desc").addClass("sort-asc"),e.reverse=!1):(t.siblings().removeClass("sort-asc").removeClass("sort-desc"),t.addClass("sort-asc"),e.reverse=!1),e.$apply(),e.sort()})}}}),angular.module("com.dcos.app").controller("LogListController",["$scope","$interval","LogService",function(e,t,i){var r=this;r.logs=[],r.searchConditions={},r.hostnameToIp=function(e){for(var t=0,i=r.hostMap.length;i>t;t++)if(r.hostMap[t].hostname==e)return r.hostMap[t].IP},r.changeSelectData=function(e){i.getSelectData(r.searchConditions,e).success(function(t){var i=t.aggregations.unique_users.buckets;if("host"==e){r.hostArr=[],r.hostArr=i;for(var n=0,o=r.hostArr.length;o>n;n++)r.hostArr[n].ip=r.hostnameToIp(r.hostArr[n].key)}else"component_name"==e?(r.componentArr=[],r.componentArr=i):(r.severityArr=[],r.severityArr=i)})},r.resetSearchCondition=function(){delete r.searchConditions.host,delete r.searchConditions.component_name,delete r.searchConditions.severity,delete r.searchConditions.log,r.getLogs()},r.setTimestamp=function(e){var t=e-r.periodTime;r.searchConditions.timestamp='["'+t+'"+TO+"'+e+'"]'},r.sortCondition={sortKey:"timestamp",reverse:!0},r.sendRefreshRequest=function(){i.refreshLog(r.searchConditions,r.sortCondition).success(function(e){r.logs=e.hits.hits,r.scrollId=e._scroll_id,r.showTip=0===r.logs.length})},r.searchLogs=function(){r.searchConditions.host||r.searchConditions.component_name||r.searchConditions.severity||r.searchConditions.message?i.searchLog(r.searchConditions,r.sortCondition).success(function(e){r.logs=e.hits.hits,r.scrollId=e._scroll_id,r.showTip=0===r.logs.length}):r.getLogs()},r.getLogs=function(e){if(e||(e=(new Date).getTime()),r.setTimestamp(e),r.hostMap){if(r.searchConditions.host||r.searchConditions.component_name||r.searchConditions.severity||r.searchConditions.message)return;r.sendRefreshRequest()}else i.getHostsMap().success(function(e){r.hostMap=e,r.searchConditions.host||r.searchConditions.component_name||r.searchConditions.severity||r.searchConditions.message||r.sendRefreshRequest()})},r.nextPage=function(){r.loadMore||(r.loadMore=!0,i.getNextPageLog(r.scrollId).success(function(e){r.logs=r.logs.concat(e.hits.hits),r.loadMore=!1}))},r.goTop=function(){document.getElementById("scroll-area").scrollTop=0},r.showSetting=function(e){"refresh"==e?(r.showChart=!1,r.showRefresh=!r.showRefresh):(r.showRefresh=!1,r.showChart=!r.showChart)},r.hideSelectArea=function(){r.showRefresh=!1,r.showChart=!1},r.periodArr={first:[{key:"Last 15 minutes",value:"15m-30s-1m"},{key:"Last 30 minutes",value:"30m-30s-2m"},{key:"Last 1 hour",value:"1h-1m-10m"},{key:"Last 4 hours",value:"4h-5m-30m"},{key:"Last 12 hours",value:"12h-10m-1h"},{key:"Last 24 hours",value:"24h-30m-3h"}],seconds:[{key:"Last 7 days",value:"7d-3h-1d"},{key:"Last 30 days",value:"30d-12h-4d"},{key:"Last 60 days",value:"60d-1d-8d"},{key:"Last 90 days",value:"90d-1d-12d"},{key:"Last 4 months",value:"120d-1d-16"}],third:[{key:"Last 6 months",value:"180d-1d-20d"},{key:"Last 9 months",value:"270d-1d-30d"},{key:"Last 1 year",value:"1y-7d-30d"},{key:"Last 2 years",value:"2y-7d-90d"},{key:"Last 5 years",value:"5y-30d-1y"}]},Highcharts.setOptions({global:{useUTC:!1}}),r.option={chart:{type:"column",renderTo:"chart",backgroundColor:"transparent",plotBackgroundColor:"transparent"},title:{style:{color:"#999"},text:"日志数量-时间图例"},legend:{backgroundColor:"#3f4a56",itemStyle:{color:"#999"}},tooltip:{animation:!1,crosshairs:!0,formatter:function(){return Highcharts.dateFormat("%H:%M:%S",this.x)+"<br/>"+this.series.name+"："+Highcharts.numberFormat(this.y,0)}},xAxis:{type:"datetime",tickInterval:2e3,labels:{style:{color:"#999"}}},yAxis:{min:0,title:{text:""}},plotOptions:{column:{borderWidth:0,pointWidth:15}},credits:{enabled:!1},series:[{name:"日志数量",data:[]}]},r.chart=new Highcharts.Chart(r.option),r.chart.showLoading(),r.getLogCount=function(e,t){var r='["'+e+'"+TO+"'+t+'"]';i.getLogCount(r).success(function(e){return e.count})},r.initChart=function(e){r.startInitChart=!0;var t=e-r.periodTime,n=r.requestInterval;r.initChartData=[];var o=Math.ceil((e-t)/n);r.chartDataLen=o+1;for(var a=0;o>=a;a++){var s='["'+(t+(a-1)*n)+'"+TO+"'+(t+a*n)+'"]';!function(e,a){i.getLogCount(e).success(function(e){r.initChartData.push({x:t+a*n,y:e.count}),r.initChartData.length>o&&(r.initChartData=r.initChartData.sort(function(e,t){return e.x-t.x}),r.chartLastData=r.initChartData[o].y,r.option=angular.merge({series:[{data:r.initChartData}]},r.option),r.chart=new Highcharts.Chart(r.option),r.startInitChart=!1)})}(s,a)}},r.formatPeriodTime=function(e){var t;return/s$/.test(e)?t=1e3*e.replace(/s$/,""):/m$/.test(e)?t=60*e.replace(/m$/,"")*1e3:/h$/.test(e)?t=60*e.replace(/h$/,"")*60*1e3:/d$/.test(e)?t=24*e.replace(/d$/,"")*60*60*1e3:/w$/.test(e)?t=7*e.replace(/w$/,"")*24*60*60*1e3:/M$/.test(e)?t=30*e.replace(/M$/,"")*24*60*60*1e3:/y$/.test(e)&&(t=365*e.replace(/y$/,"")*24*60*60*1e3),t},r.changePeriod=function(e,t){if(t){var i=angular.element(t.target);if(i.hasClass("active"))return;i.parent().parent().find("li.active").removeClass("active"),i.parent().addClass("active")}r.periodTime=r.formatPeriodTime(e.split("-")[0]),r.requestInterval=r.formatPeriodTime(e.split("-")[1]),r.option.xAxis.tickInterval=r.formatPeriodTime(e.split("-")[2]),r.endTime=(new Date).getTime(),r.getLogs(r.endTime),r.chart.showLoading(),r.chart.series[0].setData([]),r.endTime=(new Date).getTime()-1e4,r.initChart(r.endTime)},r.changePeriod(r.periodArr.first[0].value),r.refreshArr={seconds:[{key:"5 seconds",value:5e3},{key:"10 seconds",value:1e4},{key:"30 seconds",value:5e3},{key:"45 seconds",value:5e3}],minute:[{key:"1 minute",value:6e4},{key:"5 minute",value:3e5},{key:"15 minute",value:9e5},{key:"30 minute",value:18e5}],hour:[{key:"1 hour",value:36e5},{key:"2 hour",value:72e5},{key:"12 hour",value:432e5},{key:"1 day",value:864e5}]},r.changeRefreshInterval=function(e,n){var o=angular.element(e.target);o.hasClass("active")||(o.parent().parent().find("li.active").removeClass("active"),o.parent().addClass("active"),t.cancel(r.refresh),0!=n&&(r.refresh=t(function(){var e=(new Date).getTime();if(r.getLogs(e),!r.startInitChart){e-=1e4;var t=r.chart.series[0].data[r.chartDataLen-1].x,n=r.endTime;if(r.endTime=e,t>=e){var o='["'+n+'"+TO+"'+e+'"]';console.log("update"),i.getLogCount(o).success(function(e){r.chartLastData=r.chartLastData+e.count,r.chart.series[0].data[r.chartDataLen-1].update(r.chartLastData)})}else if(t>n){var o='["'+n+'"+TO+"'+t+'"]';console.log("update and append"),i.getLogCount(o).success(function(i){r.chartLastData=r.chartLastData+i.count,r.chart.series[0].data[r.chartDataLen-1].update(r.chartLastData),r.appendGapData(t,e)})}else console.log("append"),r.appendGapData(n,e)}},n)))},r.appendGapData=function(e,t){for(var n=r.requestInterval,o=[],a=Math.ceil((t-e)/n),s=1;a>=s;s++){var l=e+(s-1)*n,c=e+s*n>=t?t:e+s*n,d='["'+l+'"+TO+"'+c+'"]';!function(t,s){i.getLogCount(t).success(function(t){if(o.push({x:e+s*n,y:t.count}),o.length>=a){o=o.sort(function(e,t){return e.x-t.x}),r.chartLastData=o[a-1].y;for(var i=0;a>i;i++)r.chart.series[0].addPoint([o[i].x,o[i].y],!0,!0)}})}(d,s)}},e.$on("$destroy",function(){t.cancel(r.refresh)})}]),angular.module("com.dcos.app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("log",{url:"/log",template:"<div ui-view></div>","abstract":!0}),e.state("log.list",{url:"/list",templateUrl:"controllers/log/log.html",controller:"LogListController as vm"})}]),angular.module("com.dcos.app").factory("LogService",["$http",function(e){return{getHostsMap:function(){return e.get("/dcos-metadata/dcos-hosts.json")},getSearchJsonData:function(e,t){var i={query:{bool:{must:[]}}};for(var r in e)if(r!=t&&"timestamp"!=r){var n={timestamp:{term:{timestamp:e[r]}},host:{term:{host:e[r]}},component_name:{term:{component_name:e[r]}},severity:{term:{severity:e[r]}},message:{term:{message:e[r]}}};i.query.bool.must.push(n[r])}return i},getSelectData:function(t,i){var r=this.getSearchJsonData(t,i);return r.aggregations={unique_users:{terms:{field:i}}},e({url:"/logs/rsyslog_components/_search",method:"POST",data:r})},getLogCount:function(t){return e.get("/logs/rsyslog_components/_count?q=timestamp:"+t)},searchLog:function(t,i){var r="/logs/rsyslog_components/_search?scroll=1m&size=40",n=i.reverse?"desc":"asc";return r+="&sort="+i.sortKey+":"+n,e({url:r,method:"POST",data:this.getSearchJsonData(t)})},refreshLog:function(t,i){var r="/logs/rsyslog_components/_search?scroll=1m&size=40",n=i.reverse?"desc":"asc";return r+="&sort="+i.sortKey+":"+n,r+="&q=timestamp:"+t.timestamp,e({url:r,method:"GET"})},getNextPageLog:function(t){return e({url:"/logs/_search/scroll?scroll=1m&scroll_id="+t,method:"GET"})},getMesosTasks:function(){return e.get("/mesos/tasks")},formatTimestamp:function(e){var t=/^\[(\d{4}(\-\d{2}){2}\s\d{2}(\:\d{2}){2})?\s*\,\s*(\d{4}(\-\d{2}){2}\s\d{2}(\:\d{2}){2})?\]$/;if(!t.test(e))return null;var i=e.match(t),r=new Date(i[1]).getTime(),n=new Date(i[4]).getTime();return r?n?'["'+r+'"+TO+"'+n+'"]':">="+r:n?"<="+n:void 0}}}]),angular.module("com.dcos.app").controller("LogMesosController",["LogService",function(e){var t=this;t.filterParams=[{key:"time",name:"时间",placeholder:"格式[*,*]，*: yyyy-MM-dd HH-mm-ss或空"},{key:"message",name:"日志"}],t.mesosLogs=[],t.loadMore=!1,t.firstLoading=!0,e.getHostsMap().success(function(i){t.hostMap=i,t.hostMap.unshift({IP:"all",hostname:"*"}),e.getMesosLog().success(function(e){t.firstLoading=!1,t.mesosLogs=e.hits.hits,t.scrollId=e._scroll_id})}),t.hostnameToIp=function(e){for(var i=0,r=t.hostMap.length;r>i;i++)if(t.hostMap[i].hostname==e)return t.hostMap[i].IP},t.firstPage=function(){if(t.searchConditions.time){var i=e.formatTimestamp(t.searchConditions.time);if(!i)return void(t.mesosLogs=[]);t.searchConditions.timestamp=i}t.firstLoading=!0,e.getMesosLog(t.searchConditions).success(function(e){t.firstLoading=!1,t.mesosLogs=e.hits.hits,t.scrollId=e._scroll_id,angular.element(".scroll-area")[0].scrollTop=0})},t.searchLogs=function(){t.firstPage()},t.nextPage=function(){t.loadMore||(t.loadMore=!0,e.getNextPageLog(t.scrollId).success(function(e){t.mesosLogs=t.mesosLogs.concat(e.hits.hits),t.loadMore=!1}))}}]),angular.module("com.dcos.app").controller("LogTaskController",["$http","$scope","$mdSidenav","LogService",function(e,t,i,r){var n=this;n.filterParams=[{key:"time",name:"时间",placeholder:"格式[*,*]，*: yyyy-MM-dd HH-mm-ss或空"},{key:"message",name:"日志"}],n.taskLogs=[],n.loadMore=!1,n.appArr=[],n.apps=[],n.tasks=[],n.taskInit=!1,r.getMesosTasks().success(function(e){for(var t=e.tasks,i=0,r=t.length;r>i;i++){var o=t[i].id.split(".")[0],a=t[i].id.split(".")[1];-1==n.appArr.indexOf(o)?(n.appArr.push(o),n.apps.push({key:o,value:o}),n.tasks[o]=[{key:a,value:a}]):-1==n.tasks[o].indexOf(a)&&n.tasks[o].push({key:a,value:a})}n.apps.unshift({key:"all",value:"*"}),n.taskInit=!0}),n.firstLoading=!0,r.getHostsMap().success(function(e){n.hostMap=e,n.hostMap.unshift({IP:"all",hostname:"*"}),r.getTaskLog().success(function(e){n.firstLoading=!1,n.taskLogs=e.hits.hits,n.scrollId=e._scroll_id})}),n.hostnameToIp=function(e){for(var t=0,i=n.hostMap.length;i>t;t++)if(n.hostMap[t].hostname==e)return n.hostMap[t].IP},n.firstPage=function(){if(n.searchConditions.time){var e=r.formatTimestamp(n.searchConditions.time);if(!e)return void(n.taskLogs=[]);n.searchConditions.timestamp=e}n.firstLoading=!0,r.getTaskLog(n.searchConditions).success(function(e){n.firstLoading=!1,n.taskLogs=e.hits.hits,n.scrollId=e._scroll_id,angular.element(".scroll-area")[0].scrollTop=0})},n.searchLogs=function(){n.firstPage()},n.nextPage=function(){n.loadMore||(n.loadMore=!0,r.getNextPageLog(n.scrollId).success(function(e){n.taskLogs=n.taskLogs.concat(e.hits.hits),n.loadMore=!1}))},n.toggleRight=function(e,t,r,o,a){return n.docker_id=e,n.docker_pid=t,n.docker_host=r,n.message=o,n.timestamp=a,i("right").toggle()},n.cancel=function(){i("right").close()}}]),angular.module("com.dcos.app").controller("LogZookeeperController",["LogService",function(e){var t=this;t.searchConditions={},t.filterParams=[{key:"time",name:"时间",placeholder:"格式[*,*]，*: yyyy-MM-dd HH-mm-ss或空"},{key:"message",name:"日志"}],t.zookeeperLogs=[],t.loadMore=!1,t.firstLoading=!0,e.getHostsMap().success(function(i){t.hostMap=i,t.hostMap.unshift({IP:"all",hostname:"*"}),e.getZookeeperLog().success(function(e){t.firstLoading=!1,t.zookeeperLogs=e.hits.hits,t.scrollId=e._scroll_id})}),t.hostnameToIp=function(e){for(var i=0,r=t.hostMap.length;r>i;i++)if(t.hostMap[i].hostname==e)return t.hostMap[i].IP},t.firstPage=function(){if(t.searchConditions.time){var i=e.formatTimestamp(t.searchConditions.time);if(!i)return void(t.zookeeperLogs=[]);t.searchConditions.timestamp=i}t.firstLoading=!0,e.getZookeeperLog(t.searchConditions).success(function(e){t.firstLoading=!1,t.zookeeperLogs=e.hits.hits,t.scrollId=e._scroll_id,angular.element(".scroll-area")[0].scrollTop=0})},t.searchLogs=function(){t.firstPage()},t.nextPage=function(){t.loadMore||(t.loadMore=!0,e.getNextPageLog(t.scrollId).success(function(e){t.zookeeperLogs=t.zookeeperLogs.concat(e.hits.hits),t.loadMore=!1}))}}]),angular.module("com.dcos.app").controller("EditPasswordController",["$uibModalInstance","$http","$cookies","dialog","LoginService",function(e,t,i,r,n){var o=this,a=i.getObject("token");o.name=a.user.name,o.userId=a.user.id,o.submitted=!1,o.submit=function(t){o.submitted=!0,t.$invalid||n.editPassword(o.userId,o.oldPassword,o.newPassword).success(function(t){e.close()}).error(function(e){401==e.error.code?r.alert("输入原始密码错误！"):r.alert(e)})},o.cancel=function(){e.dismiss("cancel")}}]),angular.module("com.dcos.app").directive("loginValidator",function(){return{restrict:"EA",scope:{submitted:"="},link:function(e,t,i){t=$(t),t.find("#login").click(function(i){var r=t.find("input[name='username']").val(),n=t.find("input[name='password']").val();""==r?(e.submitted=!1,t.find(".input-message").html("请输入用户名"),i.preventDefault()):""==n?(e.submitted=!1,t.find(".input-message").html("请输入密码"),i.preventDefault()):t.find(".input-message").html(""),e.$apply()})}}}).directive("validatorMatch",function(){return{require:"ngModel",link:function(e,t,i,r){r.$parsers.push(function(e){var t=i.validatorMatch;return r.$setValidity("match",e==t),e})}}}).directive("validatorPassword",function(){return{require:"ngModel",link:function(e,t,i,r){var n=/^[\da-zA-Z]{0,30}$/;r.$parsers.push(function(e){var t=n.test(e);return r.$setValidity("password",t),e})}}}),angular.module("com.dcos.app").controller("LoginController",["$rootScope","$state","$timeout","$cookies","LoginService",function(e,t,i,r,n){var o=this;r.remove("token"),o.username=r.get("preservedUsername"),o.password=r.get("preservedPassword"),o.username&&""!=o.username?o.isPreserved=!0:o.isPreserved=!1,o.submitted=!1,o.login=function(){o.submitted=!0,o.isPreserved?(r.put("preservedUsername",o.username),r.put("preservedPassword",o.password)):(r.remove("preservedUsername"),r.remove("preservedPassword")),n.login(o.username,o.password).then(function(e){var i=e.data.token.user.id,o=e.headers("x-subject-token");n.getUserProjects(i,o).then(function(e){n.getTokens(e.data.projects[0].id,o).then(function(e){var i=e.headers("x-subject-token"),n=e.data.token;n.id=i,r.putObject("token",n),r.put("dcos-acs-auth-cookie",i),t.go("home")})})},function(e){o.error=!0})}}]),angular.module("com.dcos.app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("login",{url:"/login",templateUrl:"controllers/login/login.html",controller:"LoginController as vm"})}]),angular.module("com.dcos.app").factory("LoginService",["$http","$cookies",function(e,t){return{login:function(t,i){return e({method:"POST",url:"/acs/api/v3/auth/tokens",data:{auth:{identity:{methods:["password"],password:{user:{name:t,domain:{name:"default"},password:i}}}}}})},getAllProjects:function(){return e({method:"GET",url:"/acs/api/v3/projects"})},getUserProjects:function(i,r){if(t.get("token"))var n={};else var n={"X-Auth-Token":r};return e({method:"GET",headers:n,url:"/acs/api/v3/users/"+i+"/projects"})},getTokens:function(i,r){if(t.get("token"))var n={};else var n={"X-Auth-Token":r};return e({method:"POST",url:"/acs/api/v3/auth/tokens",headers:n,data:{auth:{identity:{methods:["token"],token:{id:r}},scope:{project:{id:i}}}}})},logout:function(){return e({method:"GET",url:"/acs/api/v1/auth/logout"})},editPassword:function(t,i,r){return e({method:"POST",url:"/acs/api/v3/users/"+t+"/password",data:{user:{password:r,original_password:i}}})}}}]),angular.module("com.dcos.app").controller("MonitorAlertController",["$state","$scope",function(e,t){var i=this;i.tab="rule",i.goTab=function(t){switch(t){case"rule":e.go("monitor.alert.rule");break;case"list":e.go("monitor.alert.list");break;case"silence":e.go("monitor.alert.silence");break;default:e.go("monitor.alert.rule")}},t.$on("$stateChangeSuccess",function(){e.includes("monitor.alert.rule")?i.tab="rule":e.includes("monitor.alert.list")?i.tab="list":e.includes("monitor.alert.silence")&&(i.tab="silence")})}]),angular.module("com.dcos.app").controller("MonitorAlertsController",["$timeout","$filter","api","SystemService","$uibModal","dialog",function(e,t,i,r,n,o){var a=this;a.initPageSize=i.initPageSize,a.components=[],a.allCount=0,a.healthyCount=0,a.unhealthyCount=0,r.getComponentList().success(function(e){a.components=e.units,a.allCount=e.units.length;for(var t=0;t<a.allCount;t++)0==a.components[t].health&&a.healthyCount++;a.unhealthyCount=a.allCount-a.healthyCount,a.page=1,a.pageSize=a.initPageSize,a.compLength=a.allCount,a.sortKey="name",a.reverse=!1}),a.statusFilter="",a.searchStatus=function(e){"all"==e?a.statusFilter="":"healthy"==e?a.statusFilter=0:"unhealthy"==e&&(a.statusFilter=1),a.changePager()},a.changePager=function(){var i=t("filter")(a.components,{name:a.compFilter,health:a.statusFilter});a.compLength=0,e(function(){a.compLength=i.length},1)},a.create=function(){var e=n.open({animation:!0,templateUrl:"controllers/monitor/alerts/create/create.html",controller:"MonitorAlertCreateController as vm",size:"lgSize"});e.result.then(function(){o.alert("告警创建成功")})}}]),angular.module("com.dcos.app").controller("MonitorAlertListController",["$state","$uibModal","$cookies","MonitorService","dialog",function(e,t,i,r,n){var o=this,a=i.getObject("token");o.project=a.project.id,o.role=a.roles[0].name,o.alerts=[],o.groups=[],o.allReceivers=[],o.alertModule={node:"主机",app:"应用"},o.alertGrade={warning:"一般",minor:"次要",major:"重要",critical:"严重"},o.alertRuleObject={cpus:"CPU利用率",mem:"内存利用率",disk:"磁盘利用率",status:"状态"},o.alertRuleMethod={sum:"总和",max:"最大值",min:"最小值",avg:"平均值"},r.getAlertList().success(function(e){o.groups=e.data;for(var t=0;t<o.groups.length;t++)if(o.groups[t].blocks)for(var i=0;i<o.groups[t].blocks.length;i++)for(var r=0;r<o.groups[t].blocks[i].alerts.length;r++){var n=o.groups[t].blocks[i].alerts[r],a=n.annotations.description.split("#")[1],s=n.annotations.description.split("#")[2];if("super"!=o.role)if("admin"==o.role){if(a!=o.project){o.groups[t].blocks[i].alerts.splice(r,1),r-=1;continue}}else if(a!=o.project||s!=o.role){o.groups[t].blocks[i].alerts.splice(r,1),r-=1;continue}var l=n.annotations.description.split("#")[0],c=l.split(":");n.name=c[0],n.module=c[1],n.ruleObject=c[2],n.ruleMethod=c[3],n.ruleOperator=c[4].match(/^[^\d]{1,2}/)[0],n.ruleValue=parseFloat(c[4].replace(/^[^\d]{1,2}/,"")),n.ruleLastTime=c[5],n.grade=c[6]}console.log(o.groups),o.allReceivers=[],angular.forEach(o.groups,function(e){angular.forEach(e.blocks,function(e){this.indexOf(e.routeOpts.receiver)<0&&this.push(e.routeOpts.receiver)},this)},o.allReceivers),o.receivers||(o.receivers=o.allReceivers)}),o.notEmpty=function(e){var t=!1;return angular.forEach(e.blocks,function(e){if(this.indexOf(e.routeOpts.receiver)>=0){
var i=e.alerts.filter(function(e){return!e.silenced});(!o.hideSilenced&&e.alerts.length>0||o.hideSilenced&&i.length>0)&&(t=!0)}},o.receivers),t},o.createSilence=function(i){var r=t.open({animation:!0,templateUrl:"controllers/monitor/alert/silence/modal/modal.html",controller:"MonitorAlertSilenceModalController as vm",size:"lgSize",resolve:{type:function(){return"create"},silence:function(){var e={matchers:[]};return angular.forEach(i,function(e,t){this.push({name:t,value:e,isRegex:!1})},e.matchers),e}}});r.result.then(function(){e.go("monitor.alert.silence")})}}]),angular.module("com.dcos.app").controller("MonitorAlertRuleModalController",["$uibModalInstance","$cookies","MonitorService","type","alert","appList","alertsName",function(e,t,i,r,n,o,a){var s=this,l=t.getObject("token");s.project=l.project.id,s.role=l.roles[0].name,s.type=r,s.alertsName=a,n?s.alert=angular.copy(n):s.alert={module:"app",grade:"warning",rule:{object:"cpus",method:"sum",operator:">=",value:80,lastTime:"5m"}},s.appList=o,s.alert.appId?s.app=s.alert.appId:s.app=s.appList[0].id,s.alertModule=[{key:"主机",value:"node"},{key:"应用",value:"app"}],s.alertGrade=[{key:"一般",value:"warning"},{key:"次要",value:"minor"},{key:"重要",value:"major"},{key:"严重",value:"critical"}],s.alertRuleObject=[{key:"CPU利用率(%)",value:"cpus"},{key:"内存利用率(%)",value:"mem"},{key:"磁盘利用率(%)",value:"disk"},{key:"状态",value:"status"}],s.alertRuleMethod=[{key:"总和",value:"sum"},{key:"最大值",value:"max"},{key:"最小值",value:"min"},{key:"平均值",value:"avg"}],s.alertRuleOperator=[">=","<=",">","<"],s.alertLastTime=[{key:"5分钟",value:"5m"},{key:"30分钟",value:"30m"},{key:"1小时",value:"1h"},{key:"3小时",value:"3h"}],s.changeModule=function(){"component"==s.alert.module&&(s.alert.rule.object="status")},s.alertsConfig={node:{cpus:"(sum by (instance)(rate(container_cpu_usage_seconds_total{id='/'}[5m])) /count by (instance)(container_cpu_usage_seconds_total{id='/'}))",mem:"(sum by ( instance)(container_memory_usage_bytes) / sum by (instance)(machine_memory_bytes))",disk:"(sum by (device, instance)(container_fs_usage_bytes) / sum by (device, instance)(container_fs_limit_bytes))",status:"(up)"},app:{cpus:"(sum by (mesos_task_id,instance)(rate(container_cpu_usage_seconds_total{marathon_app_id='{app}'}[5m])) / count by (mesos_task_id,instance)(container_cpu_usage_seconds_total{marathon_app_id='{app}'}))",mem:"(sum by (mesos_task_id,instance)(container_memory_usage_bytes{marathon_app_id='{app}'}) / sum by (mesos_task_id,instance)(machine_memory_bytes{marathon_app_id='{app}'}))",disk:"(sum by (marathon_app_id,device, instance)(container_fs_usage_bytes{marathon_app_id='{app}'}) / sum by (marathon_app_id,device, instance)(container_fs_limit_bytes{marathon_app_id='{app}'}))"}},s.cancel=function(){e.dismiss("cancel")},s.submitted=!1,s.ok=function(t){if(s.submitted=!0,!t.$invalid){var r=null,n=null;"node"==s.alert.module?(r=s.alertsConfig[s.alert.module][s.alert.rule.object]+" "+s.alert.rule.operator+" "+s.alert.rule.value/100,n=s.alert.name+":"+s.alert.module+":"+s.alert.rule.object+":"+s.alert.rule.method+":"+s.alert.rule.operator+s.alert.rule.value/100+":"+s.alert.rule.lastTime+":"+s.alert.grade):(r=s.alert.rule.method+s.alertsConfig[s.alert.module][s.alert.rule.object].replace(/{app}/g,s.app)+" "+s.alert.rule.operator+" "+s.alert.rule.value/100,n=s.alert.name+":"+s.alert.module+":"+s.alert.rule.object+":"+s.alert.rule.method+":"+s.alert.rule.operator+s.alert.rule.value/100+":"+s.alert.rule.lastTime+":"+s.alert.grade+":"+s.app),n+="#"+s.project+"#"+s.role;var o={alert:s.alert.name,"if":r,"for":s.alert.rule.lastTime,labels:{severity:s.alert.grade},annotations:n};"modify"==s.type?i.modifyRule(s.alert.name,o).success(function(t){e.close()}):i.createRule(o).success(function(t){e.close()})}}}]),angular.module("com.dcos.app").controller("MonitorAlertRuleController",["$cookies","$timeout","$filter","api","MonitorService","$uibModal","dialog",function(e,t,i,r,n,o,a){var s=this,l=e.getObject("token");s.project=l.project.id,s.role=l.roles[0].name,s.initPageSize=r.initPageSize,s.alerts=[],s.alertModule={node:"主机",app:"应用",component:"主机"},s.alertGrade={warning:"一般",minor:"次要",major:"重要",critical:"严重"},s.alertGradeArr=[{key:"所有",value:""},{key:"一般",value:"warning"},{key:"次要",value:"minor"},{key:"重要",value:"major"},{key:"严重",value:"critical"}],s.gradeFilter=s.alertGradeArr[0].value,s.alertRuleObject={cpus:"CPU利用率(%)",mem:"内存利用率(%)",disk:"磁盘利用率(%)",status:"健康状态"},s.alertRuleMethod={sum:"总和",max:"最大值",min:"最小值",avg:"平均值"},s.getRuleList=function(){s.alerts=[],s.loading=!0,n.getRuleList().success(function(e){s.loading=!1;for(var t=e.data.alerts,i=0;i<t.length;i++){var r=t[i].annotations.split("#")[1],n=t[i].annotations.split("#")[2];if("super"!=s.role)if("admin"==s.role){if(r!=s.project)continue}else if(r!=s.project||n!=s.role)continue;var o=t[i].annotations.split("#")[0].split(":");if(t[i]["if"].match(/app_id='([\/\.\-\w]+)'/))var a=t[i]["if"].match(/app_id='([\/\.\-\w]+)'/)[1];s.alerts.push({name:o[0],module:o[1],rule:{object:o[2],method:o[3],operator:o[4].match(/^[^\d]{1,2}/)[0],value:parseInt(o[4].replace(/^[^\d]{1,2}/,"")),lastTime:o[5]},parsedRule:s.alertRuleObject[o[2]]+" "+s.alertRuleMethod[o[3]]+o[4],lastTime:o[5],grade:o[6],appId:a})}s.page=1,s.pageSize=s.initPageSize,s.alertLength=t.length,s.sortKey="name",s.reverse=!1})},s.getRuleList(),s.changePager=function(){var e=i("filter")(s.alerts,{name:s.nameFilter,grade:s.gradeFilter});s.alertLength=0,t(function(){s.alertLength=e.length},1)},s.createRule=function(){var e=o.open({animation:!0,templateUrl:"controllers/monitor/alert/rule/modal/modal.html",controller:"MonitorAlertRuleModalController as vm",size:"lgSize",resolve:{type:function(){return"create"},alert:function(){return null},appList:["$q",function(e){var t=e.defer();return n.getAppList().success(function(e){t.resolve(e.apps)}).error(function(e){t.reject()}),t.promise}],alertsName:["$q",function(e){var t=e.defer();return n.getRuleList().success(function(e){for(var i=[],r=e.data.alerts,n=0,o=r.length;o>n;n++)i.push(r[n].alert);t.resolve(i)}).error(function(e){t.reject()}),t.promise}]}});e.result.then(function(){s.getRuleList(),a.alert("告警规则创建成功")})},s.modifyRule=function(e){var t=o.open({animation:!0,templateUrl:"controllers/monitor/alert/rule/modal/modal.html",controller:"MonitorAlertRuleModalController as vm",size:"lgSize",resolve:{type:function(){return"modify"},alert:function(){return e},appList:["$q",function(e){var t=e.defer();return n.getAppList().success(function(e){t.resolve(e.apps)}).error(function(e){t.reject()}),t.promise}],alertsName:["$q",function(e){var t=e.defer();return n.getRuleList().success(function(e){for(var i=[],r=e.data.alerts,n=0,o=r.length;o>n;n++)i.push(r[n].alert);t.resolve(i)}).error(function(e){t.reject()}),t.promise}]}});t.result.then(function(){s.getRuleList(),a.alert("告警规则修改成功")})},s.deleteRule=function(e){var t=a.confirm("确认删除该报警规则?");t.then(function(t){t&&n.deleteRule(e).success(function(){s.getRuleList(),a.alert("删除成功")})})}}]),angular.module("com.dcos.app").controller("MonitorAlertSilenceModalController",["$cookies","$uibModalInstance","MonitorService","type","silence",function(e,t,i,r,n){var o=this,a=e.getObject("token");o.project=a.project.id,o.role=a.roles[0].name,o.type=r,o.silence=n,"modify"==o.type&&(o.silence.createdBy=o.silence.createdBy.split("#")[0]),0===o.silence.matchers.length&&(o.silence.matchers=[{}]),o.setTime=function(){var e=new Date,t=new Date;e.setMilliseconds(0),t.setMilliseconds(0),e.setSeconds(0),t.setSeconds(0),t.setHours(t.getHours()+4),o.silence.startsAt&&!o.silence.elapsed||(o.silence.startsAt=e),o.silence.endsAt&&!o.silence.elapsed||(o.silence.endsAt=t)},o.setTime(),o.addMatcher=function(){o.silence.matchers.push({})},o.delMatcher=function(e){o.silence.matchers.splice(e,1)},o.submitted=!1,o.ok=function(e){o.submitted=!0,e.$invalid||(o.silence.createdBy+="#"+o.project+"#"+o.role,i.createSilence(o.silence).success(function(){o.silence.id?i.deleteSilence(o.silence.id).success(function(){t.close()}):t.close()}))},o.cancel=function(){t.dismiss("cancel")}}]),angular.module("com.dcos.app").controller("MonitorAlertSilenceController",["$cookies","$stateParams","$uibModal","MonitorService","dialog",function(e,t,i,r,n){var o=this,a=e.getObject("token");o.project=a.project.id,o.role=a.roles[0].name,o.silences=[],o.getSilenceList=function(){r.getSilenceList().success(function(e){o.silences=e.data,o.activeCount=0,o.pendingCount=0,o.elapsedCount=0;var t=new Date;angular.forEach(o.silences,function(e){var i=e.createdBy.split("#")[1],r=e.createdBy.split("#")[2];if("super"!=o.role)if("admin"==o.role){if(i!=o.project)return null}else if(i!=o.project||r!=o.role)return null;e.endsAt=new Date(e.endsAt),e.startsAt=new Date(e.startsAt),e.updatedAt=new Date(e.updatedAt),e.endsAt<t&&(e.elapsed=!0,o.elapsedCount+=1),e.startsAt>t&&(e.pending=!0,o.pendingCount+=1),e.startsAt<=t&&e.endsAt>t&&(e.active=!0,o.activeCount+=1)})})},o.getSilenceList(),o.createSilence=function(){var e=i.open({animation:!0,templateUrl:"controllers/monitor/alert/silence/modal/modal.html",controller:"MonitorAlertSilenceModalController as vm",size:"lgSize",resolve:{type:function(){return"create"},silence:function(){var e={matchers:[]};return e}}});e.result.then(function(){o.getSilenceList(),n.alert("创建成功")})},o.modifySilence=function(e){var t=i.open({animation:!0,templateUrl:"controllers/monitor/alert/silence/modal/modal.html",controller:"MonitorAlertSilenceModalController as vm",size:"lgSize",resolve:{type:function(){return"modify"},silence:function(){return e}}});t.result.then(function(){o.getSilenceList(),n.alert("修改成功")})},o.delSilence=function(e){r.deleteSilence(e).success(function(){o.getSilenceList(),n.alert("删除成功")})}}]),angular.module("com.dcos.app").controller("MonitorAppController",["api","MonitorService",function(e,t){var i=this;i.initPageSize=e.initPageSize,i.appList=[],i.getAppData=function(){i.loading=!0,t.getAppList().success(function(e){i.loading=!1,i.appList=e.apps,i.page=1,i.pageSize=i.initPageSize,i.appLength=i.appList.length,i.sortKey="id",i.reverse=!1})},i.getAppData()}]),angular.module("com.dcos.app").controller("MonitorAppTaskDetailController",["$scope","$q","$state","$stateParams","$interval","$timeout","MonitorService",function(e,t,i,r,n,o,a){var s=this;s.appId=r.appId,s.id=r.id,s.systemData=0,s.userData=0,s.memoryData=0,s.rxData=0,s.txData=0,Highcharts.setOptions({global:{useUTC:!1}}),s.option={chart:{animation:Highcharts.svg,marginRight:10,backgroundColor:"transparent",plotBackgroundColor:"transparent"},legend:{backgroundColor:"#3f4a56",itemStyle:{color:"#999"}},title:{style:{color:"#fff"}},tooltip:{animation:!1,crosshairs:!0},xAxis:{type:"datetime",tickInterval:2e3,labels:{style:{color:"#999"}}},yAxis:{title:"",lineWidth:1,lineColor:"#f0f0f0",gridLineDashStyle:"longdash",min:0,labels:{style:{color:"#999"}}},credits:{enabled:!1},exporting:{enabled:!1},plotOptions:{series:{marker:{radius:3}}}},s.cpuOption=angular.merge({chart:{type:"line"},tooltip:{formatter:function(){return Highcharts.dateFormat("%H:%M:%S",this.x)+"<br/>"+this.points[0].series.name+"："+Highcharts.numberFormat(this.points[0].y,2)+"%<br />"+this.points[1].series.name+"："+Highcharts.numberFormat(this.points[1].y,2)+"%"},shared:!0},yAxis:{labels:{format:"{value}%"}},colors:["#9351e5","#F33745"]},s.option),s.memoryOption=angular.merge({chart:{type:"area"},tooltip:{formatter:function(){return Highcharts.dateFormat("%H:%M:%S",this.x)+"M<br/>"+this.series.name+"："+Highcharts.numberFormat(this.y,0)+"M"}},plotOptions:{area:{color:"#39b3ef",fillColor:"rgba(57,179,239,0.1)"}},yAxis:{labels:{format:"{value}M"}}},s.option),s.networkOption=angular.merge({chart:{type:"line"},tooltip:{formatter:function(){return Highcharts.dateFormat("%H:%M:%S",this.x)+"<br/>"+this.points[0].series.name+"："+Highcharts.numberFormat(this.points[0].y,2)+"M<br />"+this.points[1].series.name+"："+Highcharts.numberFormat(this.points[1].y,2)+"M"},shared:!0},yAxis:{labels:{format:"{value}M"}},colors:["#9351e5","#F33745"]},s.option),s.cpuChart=new Highcharts.Chart(angular.merge({chart:{renderTo:"cpu-chart"},title:{text:"CPU使用率"},series:[{name:"系统态使用率"},{name:"用户态使用率"}]},s.cpuOption)),s.cpuChart.showLoading(),s.memoryChart=new Highcharts.Chart(angular.merge({chart:{renderTo:"memory-chart"},title:{text:"Memory使用量"},series:[{name:"Memory使用量"}]},s.memoryOption)),s.memoryChart.showLoading(),s.networkChart=new Highcharts.Chart(angular.merge({chart:{renderTo:"network-chart"},title:{text:"网络吞吐量"},series:[{name:"总下行流量"},{name:"总上行流量"}]},s.networkOption)),s.networkChart.showLoading(),s.appendCpuChart=function(e){var t=!1;s.cpuChart.series[0].data.length>20&&(t=!0);var i=s.cpuChart.series[0],r=s.cpuChart.series[1];i.addPoint([e,s.systemData],!0,t),r.addPoint([e,s.userData],!0,t)},s.appendMemoryChart=function(e){var t=!1;s.memoryChart.series[0].data.length>20&&(t=!0),s.memoryChart.series[0].addPoint([e,s.memoryData],!0,t)},s.appendNetworkChart=function(e){var t=!1;s.networkChart.series[0].data.length>20&&(t=!0);var i=s.networkChart.series[0],r=s.networkChart.series[1];i.addPoint([e,s.rxData],!0,t),r.addPoint([e,s.txData],!0,t)},s.getCpuData=function(e){var i=(new Date).getTime(),r=a.getTaskSystemCpu(s.appId,s.id),n=a.getTaskUserCpu(s.appId,s.id);t.all([r,n]).then(function(e){s.cpuChart.hideLoading(),e[0].data.data.result[0]&&(s.systemData=parseFloat(100*e[0].data.data.result[0].value[1])),e[1].data.data.result[0]&&(s.userData=parseFloat(100*e[1].data.data.result[0].value[1])),s.appendCpuChart(i),o(function(){s.appendCpuChart(i+1e3)},2e3)})},s.getMemoryData=function(e){var t=(new Date).getTime();a.getTaskMemory(s.appId,s.id).success(function(e){if(s.memoryChart.hideLoading(),e.data.result[0]){var i=e.data.result[0].value[1];s.memoryData=parseFloat((i/1024/1024).toFixed(2))}s.appendMemoryChart(t),o(function(){s.appendMemoryChart(t+1e3)},1e3)})},s.getNetworkData=function(e){var i=(new Date).getTime(),r=a.getTaskRxNetwork(s.appId,s.id),n=a.getTaskTxNetwork(s.appId,s.id);t.all([r,n]).then(function(e){if(s.networkChart.hideLoading(),e[0].data.data.result[0]){var t=e[0].data.data.result[0].value[1];s.rxData=parseFloat((t/1024/1024).toFixed(2))}if(e[1].data.data.result[0]){var r=e[1].data.data.result[0].value[1];s.txData=parseFloat((r/1024/1024).toFixed(2))}s.appendNetworkChart(i),o(function(){s.appendNetworkChart(i+1e3)},1e3)})},s.getCpuData(),s.getMemoryData(),s.getNetworkData(),s.resourceInterval=n(function(){s.getCpuData(),s.getMemoryData(),s.getNetworkData()},2e3),e.$on("$destroy",function(){n.cancel(s.resourceInterval)})}]),angular.module("com.dcos.app").controller("MonitorAppTaskController",["$state","$stateParams","api","MonitorService",function(e,t,i,r){var n=this;n.initPageSize=i.initPageSize,n.taskList=[],n.appId=t.appId,n.isLoading=!0,n.getTaskData=function(){r.getTaskList(n.appId).success(function(e){n.isLoading=!1,n.app=e.app,n.taskList=e.app.tasks,n.page=1,n.pageSize=n.initPageSize,n.taskLength=n.taskList.length,n.sortKey="id",n.reverse=!1}).error(function(e){n.isLoading=!1,console.log(e)})},n.taskMonitor=function(t){e.go("monitor.app.task.detail",{appId:n.appId,id:t})}}]),angular.module("com.dcos.app").controller("MonitorComponentController",["$timeout","$filter","api","SystemService",function(e,t,i,r){var n=this;n.initPageSize=i.initPageSize,n.components=[],n.allCount=0,n.healthyCount=0,n.unhealthyCount=0,n.loading=!0,r.getComponentList().success(function(e){n.loading=!1,n.components=e.units,n.allCount=e.units.length;for(var t=0;t<n.allCount;t++)0==n.components[t].health&&n.healthyCount++;n.unhealthyCount=n.allCount-n.healthyCount,n.page=1,n.pageSize=n.initPageSize,n.compLength=n.allCount,n.sortKey="name",n.reverse=!1}),n.statusFilter="",n.searchStatus=function(e){"all"==e?n.statusFilter="":"healthy"==e?n.statusFilter=0:"unhealthy"==e&&(n.statusFilter=1),n.changePager()},n.changePager=function(){var i=t("filter")(n.components,{name:n.compFilter,health:n.statusFilter});n.compLength=0,e(function(){n.compLength=i.length},1)}}]),angular.module("com.dcos.app").controller("MonitorComponentDetailController",["$stateParams","$timeout","$filter","api","SystemService",function(e,t,i,r,n){var o=this;o.initPageSize=r.initPageSize,o.comp_id=e.comp_id,o.allCount=0,o.healthyCount=0,o.unhealthyCount=0,o.query={key:"host_ip",value:""},n.getComponentNodeList(o.comp_id).success(function(e){o.nodes=e.nodes,o.allCount=o.nodes.length;for(var t=0;t<o.allCount;t++)0==o.nodes[t].health&&o.healthyCount++;o.unhealthyCount=o.allCount-o.healthyCount,o.page=1,o.pageSize=o.initPageSize,o.nodeLength=o.allCount,o.sortKey="host_ip",o.reverse=!1}),o.statusFilter="",o.searchStatus=function(e){"all"==e?o.statusFilter="":"healthy"==e?o.statusFilter=0:"unhealthy"==e&&(o.statusFilter=1),o.changePager()},o.changePager=function(){var e=i("filter")(o.nodes,{health:o.statusFilter});e=i("objectFilter")(o.filtered,o.query.key,o.query.value),o.nodeLength=0,t(function(){o.nodeLength=e.length},1)},o.filterArr=[{key:"节点",value:"host_ip"},{key:"角色",value:"role"}]}]),angular.module("com.dcos.app").controller("MonitorHaproxyController",["MonitorService",function(e){var t=this;t.haproxys=[],t.selectedHost="",e.getProxyHost().success(function(e){for(var i=0;i<e.data.result.length;i++)"1"==e.data.result[i].value[1]&&t.haproxys.push(e.data.result[i].metric.instance.split(":")[0]);t.selectedHost=t.haproxys[0],t.getProxyData()}),t.getProxyData=function(){t.selectedHost&&(t.showData=!1,e.getProxyData(t.selectedHost).success(function(e){Papa.parse(e,{complete:function(e,i){t.haproxyData={};for(var r=1;r<e.data.length&&e.data[r].length>1;r++)if(t.haproxyData[e.data[r][0]])t.haproxyData[e.data[r][0]].push(e.data[r].slice(1));else{var n=[];n.push(e.data[r].slice(1)),t.haproxyData[e.data[r][0]]=n}t.showData=!0}})}))}}]),angular.module("com.dcos.app").controller("MonitorListController",["$rootScope","$state","$scope","HttpPendingRequestsService",function(e,t,i,r){var n=this;n.goTab=function(e){switch(e){case"overview":t.go("monitor.overview");break;case"node":t.go("monitor.node");break;case"app":t.go("monitor.app");break;case"component":t.go("monitor.component");break;case"alert":t.go("monitor.alert.rule");break;case"haproxy":t.go("monitor.haproxy");break;default:t.go("monitor.overview")}},i.$on("$stateChangeSuccess",function(){t.includes("monitor.overview")?n.tab="overview":t.includes("monitor.app")?n.tab="app":t.includes("monitor.node")?n.tab="node":t.includes("monitor.component")?n.tab="component":t.includes("monitor.haproxy")?n.tab="haproxy":t.includes("monitor.alert")&&(n.tab="alert")}),e.$on("$stateChangeSuccess",function(){r.cancelAll()})}]),angular.module("com.dcos.app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("monitor",{url:"/monitor",templateUrl:"controllers/monitor/monitor.html",controller:"MonitorListController as vm"}),e.state("monitor.overview",{url:"/overview",templateUrl:"controllers/monitor/overview/overview.html",controller:"MonitorOverviewController as vm"}),e.state("monitor.haproxy",{url:"/haproxy",templateUrl:"controllers/monitor/haproxy/haproxy.html",controller:"MonitorHaproxyController as vm"}),e.state("monitor.node",{url:"/node",templateUrl:"controllers/monitor/node/node.html",controller:"MonitorNodeController as vm",resolve:{slaves:["$q","$http","$rootScope",function(e,t,i){var r=e.defer();return i.loading=!0,t.get("/monitor/api/v1/query?query=up{job='dcos'}").success(function(e){i.loading=!1,r.resolve(e.data.result)}),r.promise}]}}),e.state("monitor.app",{url:"/app",templateUrl:"controllers/monitor/app/app.html",controller:"MonitorAppController as vm"}),e.state("monitor.app.task",{url:"/task/{appId:string}",views:{"@monitor":{templateUrl:"controllers/monitor/app/task/task.html",controller:"MonitorAppTaskController as vm"}}}),e.state("monitor.app.task.detail",{url:"/detail/{id:string}",views:{"@monitor":{templateUrl:"controllers/monitor/app/task/detail/detail.html",controller:"MonitorAppTaskDetailController as vm"}}}),e.state("monitor.component",{url:"/components",templateUrl:"controllers/monitor/component/component.html",controller:"MonitorComponentController as vm"}),e.state("monitor.component.detail",{url:"/detail/{comp_id:string}",views:{"@monitor":{templateUrl:"controllers/monitor/component/detail/detail.html",controller:"MonitorComponentDetailController as vm"}}}),e.state("monitor.alert",{url:"/alert",templateUrl:"controllers/monitor/alert/alert.html",controller:"MonitorAlertController as vm","abstract":!0}),e.state("monitor.alert.rule",{url:"/rules",templateUrl:"controllers/monitor/alert/rule/rule.html",controller:"MonitorAlertRuleController as vm"}),e.state("monitor.alert.list",{url:"/lists",templateUrl:"controllers/monitor/alert/list/list.html",controller:"MonitorAlertListController as vm"}),e.state("monitor.alert.silence",{url:"/silences",templateUrl:"controllers/monitor/alert/silence/silence.html",controller:"MonitorAlertSilenceController as vm"})}]),angular.module("com.dcos.app").factory("MonitorService",["$http",function(e){return{getOverviewSystemCpu:function(){return e({method:"GET",url:'/monitor/api/v1/query?query=sum(irate(container_cpu_system_seconds_total{id="/",job="dcos"}[1m])) /avg(machine_cpu_cores)'})},getOverviewUserCpu:function(){return e({method:"GET",url:'/monitor/api/v1/query?query=sum(irate(container_cpu_user_seconds_total{id="/",job="dcos"}[1m]))/avg(machine_cpu_cores)'})},getOverviewMemory:function(){return e({method:"GET",url:"/monitor/api/v1/query?query=sum(container_memory_usage_bytes{job='dcos'})"})},getOverviewDisk:function(){return e({method:"GET",url:"/monitor/api/v1/query?query=sum(container_fs_usage_bytes{job='dcos'})/8"})},getOverviewRxNetwork:function(){return e({method:"GET",url:"/monitor/api/v1/query?query=sum(irate(container_network_receive_bytes_total{job='dcos',id='/'}[1m]))"})},getOverviewTxNetwork:function(){return e({method:"GET",url:"/monitor/api/v1/query?query=sum(irate(container_network_transmit_bytes_total{job='dcos',id='/'}[1m]))"})},getNodeSystemCpu:function(t){return e({method:"GET",url:'/monitor/api/v1/query?query=irate(container_cpu_system_seconds_total{id="/",instance="'+t+'",job="dcos"}[1m]) '})},getNodeUserCpu:function(t){return e({method:"GET",url:'/monitor/api/v1/query?query=irate(container_cpu_user_seconds_total{id="/",instance="'+t+'",job="dcos"}[1m]) '})},getNodeMemory:function(t){return e({method:"GET",url:"/monitor/api/v1/query?query=sum(container_memory_usage_bytes{instance='"+t+"',job='dcos'})"})},getNodeRxNetwork:function(t){return e({method:"GET",url:'/monitor/api/v1/query?query=sum(irate(container_network_receive_bytes_total{job="dcos",id="/",instance="'+t+'"}[1m]))'})},getNodeTxNetwork:function(t){return e({method:"GET",url:'/monitor/api/v1/query?query=sum(irate(container_network_transmit_bytes_total{job="dcos",id="/",instance="'+t+'"}[1m]))'})},getNodeDiskLimit:function(t){return e({method:"GET",url:'/monitor/api/v1/query?query=sum by (device) (container_fs_limit_bytes{instance="'+t+'"})'})},getNodeDiskUsage:function(t){return e({method:"GET",url:'/monitor/api/v1/query?query=sum by (device) (container_fs_usage_bytes{instance="'+t+'"})'})},getAppList:function(){return e({method:"GET",url:"/marathon/v2/apps/"})},getTaskList:function(t){return e({method:"GET",url:"/marathon/v2/apps/"+t.replace(/^\//g,"")+"?embed=app.taskStats&embed=app.readiness"})},getTaskSystemCpu:function(t,i){return e({method:"GET",url:'/monitor/api/v1/query?query=irate(container_cpu_system_seconds_total{group="slave",marathon_app_id="'+t+'",mesos_task_id="'+i+'",job="dcos"}[1m])'})},getTaskUserCpu:function(t,i){return e({method:"GET",url:'/monitor/api/v1/query?query=irate(container_cpu_user_seconds_total{group="slave",marathon_app_id="'+t+'",mesos_task_id="'+i+'",job="dcos"}[1m])'})},getTaskMemory:function(t,i){return e({method:"GET",url:"/monitor/api/v1/query?query=sum(container_memory_usage_bytes{marathon_app_id='"+t+"',mesos_task_id='"+i+"',job='dcos'})"})},getTaskRxNetwork:function(t,i){return e({method:"GET",url:"/monitor/api/v1/query?query=sum(irate(container_network_receive_bytes_total{job='dcos',marathon_app_id='"+t+"',mesos_task_id='"+i+"'}[1m]))"})},getTaskTxNetwork:function(t,i){return e({method:"GET",url:"/monitor/api/v1/query?query=sum(irate(container_network_transmit_bytes_total{job='dcos',marathon_app_id='"+t+"',mesos_task_id='"+i+"'}[1m]))"})},getComponentList:function(){return e.get("/system/health/v1/units")},getNodeList:function(t){return e.get("/system/health/v1/units/"+t+"/nodes")},getRuleList:function(){return e.get("/alert/api/v1/alarms")},createRule:function(t){return e({method:"POST",url:"/alert/api/v1/alarms",data:JSON.stringify(t)})},modifyRule:function(t,i){return e({method:"POST",url:"/alert/api/v1/alarms/"+t,data:JSON.stringify(i)})},deleteRule:function(t){return e({method:"DELETE",url:"/alert/api/v1/alarms/"+t})},getAlertList:function(){return e.get("/alert/api/v1/alerts/groups")},getSilenceList:function(){return e.get("/alert/api/v1/silences")},createSilence:function(t){return e({method:"POST",url:"/alert/api/v1/silences",data:t})},deleteSilence:function(t){return e({method:"DELETE",url:"alert/api/v1/silence/"+t})},getProxyHost:function(){return e({method:"GET",url:'/monitor/api/v1/query?query=up{group="haproxy"}'})},getProxyData:function(t){return e({method:"GET",url:"/haproxy/"+t})}}}]),angular.module("com.dcos.app").controller("MonitorNodeController",["$scope","$q","$interval","$timeout","slaves","MonitorService",function(e,t,i,r,n,o){var a=this;a.isDumplicate=function(e,t){for(var i in e)if(e[i].key==t)return!0;return!1},a.hosts=[],a.instances={},a.instanceInfo=[],a.hostObj={selectedHost:""};for(var s=0,l=n.length;l>s;s++){var c=n[s].metric.instance,d=c.split(":")[0];a.instanceInfo.push({instance:c,group:n[s].metric.group}),a.instances[d]||(a.instances[d]=[]),a.isDumplicate(a.hosts,d)||a.hosts.push({key:d,value:c}),a.instances[d].push({key:c,value:c}),a.instances[d]=a.instances[d].sort(function(e,t){return e.key>t.key?1:-1})}a.hosts=a.hosts.sort(function(e,t){return e.key>t.key?1:-1}),a.hostObj.selectedHost=a.hosts[0].value,e.$watch("vm.hostObj.selectedHost",function(){for(a.cpuChart.series[0].setData([]),a.cpuChart.series[1].setData([]),a.memoryChart.series[0].setData([]),a.networkChart.series[0].setData([]),a.networkChart.series[1].setData([]),a.cpuChart.showLoading(),a.memoryChart.showLoading(),a.networkChart.showLoading(),a.fileData=[],s=0,l=a.instanceInfo.length;l>s;s++)a.hostObj.selectedHost==a.instanceInfo[s].instance&&(a.hostGroup=a.instanceInfo[s].group)}),a.systemData=0,a.userData=0,a.memoryData=0,a.rxData=0,a.txData=0,Highcharts.setOptions({global:{useUTC:!1}}),a.option={chart:{animation:Highcharts.svg,marginRight:10,backgroundColor:"transparent",plotBackgroundColor:"transparent"},legend:{backgroundColor:"#3f4a56",itemStyle:{color:"#999"}},title:{style:{color:"#fff"}},tooltip:{animation:!1,crosshairs:!0},xAxis:{type:"datetime",tickInterval:2e3,labels:{style:{color:"#999"}}},yAxis:{title:"",lineWidth:1,lineColor:"#f0f0f0",gridLineDashStyle:"longdash",labels:{style:{color:"#999"}}},credits:{enabled:!1},exporting:{enabled:!1},plotOptions:{series:{marker:{radius:3}}}},a.cpuOption=angular.merge({chart:{type:"line"},tooltip:{formatter:function(){return Highcharts.dateFormat("%H:%M:%S",this.x)+"<br/>"+this.points[0].series.name+"："+Highcharts.numberFormat(this.points[0].y,2)+"%<br />"+this.points[1].series.name+"："+Highcharts.numberFormat(this.points[1].y,2)+"%"},shared:!0},colors:["#9351e5","#F33745"],yAxis:{labels:{format:"{value}%"},min:0}},a.option),a.memoryOption=angular.merge({chart:{type:"area"},tooltip:{formatter:function(){return Highcharts.dateFormat("%H:%M:%S",this.x)+"M<br/>"+this.series.name+"："+Highcharts.numberFormat(this.y,0)+"M"}},plotOptions:{area:{color:"#39b3ef",fillColor:"rgba(57,179,239,0.1)"}},yAxis:{labels:{format:"{value}M"},min:0}},a.option),a.networkOption=angular.merge({chart:{type:"line"},tooltip:{formatter:function(){return Highcharts.dateFormat("%H:%M:%S",this.x)+"<br/>"+this.points[0].series.name+"："+Highcharts.numberFormat(this.points[0].y,2)+"M<br />"+this.points[1].series.name+"："+Highcharts.numberFormat(this.points[1].y,2)+"M"},shared:!0},colors:["#9351e5","#F33745"],yAxis:{labels:{format:"{value}M"},min:0}},a.option),a.cpuChart=new Highcharts.Chart(angular.merge({chart:{renderTo:"cpu-chart"},title:{text:"CPU使用率"},series:[{name:"系统态使用率"},{name:"用户态使用率"}]},a.cpuOption)),a.cpuChart.showLoading(),a.memoryChart=new Highcharts.Chart(angular.merge({chart:{renderTo:"memory-chart"},title:{text:"Memory使用量"},series:[{name:"Memory使用量"}]},a.memoryOption)),a.memoryChart.showLoading(),a.networkChart=new Highcharts.Chart(angular.merge({chart:{renderTo:"network-chart"},title:{text:"网络吞吐量"},series:[{name:"总下行流量"},{name:"总上行流量"}]},a.networkOption)),a.networkChart.showLoading(),a.appendCpuChart=function(e){var t=!1;a.cpuChart.series[0].data.length>20&&(t=!0);var i=a.cpuChart.series[0],r=a.cpuChart.series[1];i.addPoint([e,a.systemData],!0,t),r.addPoint([e,a.userData],!0,t)},a.appendMemoryChart=function(e){var t=!1;a.memoryChart.series[0].data.length>20&&(t=!0),a.memoryChart.series[0].addPoint([e,a.memoryData],!0,t)},a.appendNetworkChart=function(e){var t=!1;a.networkChart.series[0].data.length>20&&(t=!0);var i=a.networkChart.series[0],r=a.networkChart.series[1];i.addPoint([e,a.rxData],!0,t),r.addPoint([e,a.txData],!0,t)},a.getCpuData=function(){var e=(new Date).getTime(),i=o.getNodeSystemCpu(a.hostObj.selectedHost),n=o.getNodeUserCpu(a.hostObj.selectedHost);t.all([i,n]).then(function(t){if(a.cpuChart.hideLoading(),t[0].data.data.result[0]){var i=100*t[0].data.data.result[0].value[1];a.systemData=parseFloat(i.toFixed(2))}if(t[1].data.data.result[0]){var n=100*t[1].data.data.result[0].value[1];a.userData=parseFloat(n.toFixed(2))}a.appendCpuChart(e),r(function(){a.appendCpuChart(e+1e3)},1e3)})},a.getMemoryData=function(){var e=(new Date).getTime();o.getNodeMemory(a.hostObj.selectedHost).success(function(t){if(a.memoryChart.hideLoading(),t.data.result[0]){var i=t.data.result[0].value[1];a.memoryData=parseFloat((i/1048576).toFixed(2))}a.appendMemoryChart(e),r(function(){a.appendMemoryChart(e+1e3)},2e3)})},a.getNetworkData=function(){var e=(new Date).getTime(),i=o.getNodeRxNetwork(a.hostObj.selectedHost),n=o.getNodeTxNetwork(a.hostObj.selectedHost);t.all([i,n]).then(function(t){if(a.networkChart.hideLoading(),t[0].data.data.result[0]){var i=t[0].data.data.result[0].value[1];a.rxData=parseFloat((i/1048576).toFixed(2))}if(t[1].data.data.result[0]){var n=t[1].data.data.result[0].value[1];a.txData=parseFloat((n/1048576).toFixed(2))}a.appendNetworkChart(e),r(function(){a.appendNetworkChart(e+1e3)},1e3)})},a.diskData=[],a.getDiskData=function(){var e=((new Date).getTime(),o.getNodeDiskLimit(a.hostObj.selectedHost)),i=o.getNodeDiskUsage(a.hostObj.selectedHost);t.all([e,i]).then(function(e){var t=e[0].data.data.result,i=e[1].data.data.result,r=t.length,n={},o={};if(t&&i){for(var s=0;r>s;s++)n[t[s].metric.device]=(t[s].value[1]/1073741824).toFixed(2),o[i[s].metric.device]=(i[s].value[1]/1073741824).toFixed(2);var l=n.overlay,c=o.overlay;a.diskData=[];for(var d in n)/var/g.test(d)?a.diskData.push({device:d,limit:l,usage:c,percentage:(c/l*100).toFixed(2)+"%"}):a.diskData.push({device:d,limit:n[d],usage:o[d],percentage:(o[d]/n[d]*100).toFixed(2)+"%"})}})},a.getCpuData(),a.getMemoryData(),a.getNetworkData(),a.getDiskData(),a.resourceInterval=i(function(){a.getCpuData(),a.getMemoryData(),a.getNetworkData(),a.getDiskData()},2e3),e.$on("$destroy",function(){i.cancel(a.resourceInterval)})}]),angular.module("com.dcos.app").controller("MonitorOverviewController",["$scope","$q","$interval","$timeout","MonitorService","$http",function(e,t,i,r,n,o){var a=this;a.cpuData=0,a.memoryData=0,a.diskData=0,a.rxData=0,a.txData=0,Highcharts.setOptions({global:{useUTC:!1}}),a.option={chart:{animation:Highcharts.svg,marginRight:10,backgroundColor:"transparent",plotBackgroundColor:"transparent"},legend:{backgroundColor:"#3f4a56",itemStyle:{color:"#999"}},title:{style:{color:"#fff"}},tooltip:{
animation:!1,crosshairs:!0},xAxis:{type:"datetime",tickInterval:2e3,labels:{style:{color:"#999"}}},yAxis:{title:"",lineWidth:1,lineColor:"#a0a0a0",gridLineColor:"#a0a0a0",gridLineDashStyle:"longdash",labels:{style:{color:"#999"}}},credits:{enabled:!1},exporting:{enabled:!1},plotOptions:{series:{marker:{radius:3}}}},a.cpuOption=angular.merge({chart:{type:"line"},tooltip:{formatter:function(){return Highcharts.dateFormat("%H:%M:%S",this.x)+"<br/>"+this.points[0].series.name+"："+Highcharts.numberFormat(this.points[0].y,2)+"%<br />"+this.points[1].series.name+"："+Highcharts.numberFormat(this.points[1].y,2)+"%"},shared:!0},colors:["#9351e5","#F33745"],yAxis:{labels:{format:"{value}%"},min:0}},a.option),a.memoryOption=angular.merge({chart:{type:"area"},tooltip:{formatter:function(){return Highcharts.dateFormat("%H:%M:%S",this.x)+"M<br/>"+this.series.name+"："+Highcharts.numberFormat(this.y,0)+"M"}},plotOptions:{area:{color:"#39b3ef",fillColor:"rgba(57,179,239,0.1)"}},yAxis:{labels:{format:"{value}M"},min:0}},a.option),a.diskOption=angular.merge({chart:{type:"area"},tooltip:{formatter:function(){return Highcharts.dateFormat("%H:%M:%S",this.x)+"M<br/>"+this.series.name+"："+Highcharts.numberFormat(this.y,0)+"M"}},plotOptions:{area:{color:"#9351e5",fillColor:"rgba(147, 81, 229, 0.1)"}},yAxis:{labels:{format:"{value}M"},min:0}},a.option),a.networkOption=angular.merge({tooltip:{formatter:function(){return Highcharts.dateFormat("%H:%M:%S",this.x)+"<br/>"+this.points[0].series.name+"："+Highcharts.numberFormat(this.points[0].y,0)+"M<br />"+this.points[1].series.name+"："+Highcharts.numberFormat(this.points[1].y,0)+"M"},shared:!0},chart:{type:"line"},colors:["#9351e5","#F33745"],yAxis:{labels:{format:"{value}M"},min:0}},a.option),a.cpuChart=new Highcharts.Chart(angular.merge({chart:{renderTo:"cpu-chart"},title:{text:"CPU使用率"},series:[{name:"系统态使用率"},{name:"用户态使用率"}]},a.cpuOption)),a.cpuChart.showLoading(),a.memoryChart=new Highcharts.Chart(angular.merge({chart:{renderTo:"memory-chart"},title:{text:"Memory使用量"},series:[{name:"Memory使用量"}]},a.memoryOption)),a.memoryChart.showLoading(),a.diskChart=new Highcharts.Chart(angular.merge({chart:{renderTo:"disk-chart"},title:{text:"Disk使用量"},plotOptions:{area:{color:"#008000",fillColor:"rgba(0,128,0,0.1)"}},series:[{name:"Disk使用率"}]},a.diskOption)),a.diskChart.showLoading(),a.networkChart=new Highcharts.Chart(angular.merge({chart:{renderTo:"network-chart"},title:{text:"网络吞吐量"},series:[{name:"总下行流量"},{name:"总上行流量"}]},a.networkOption)),a.networkChart.showLoading(),a.appendCpuChart=function(e){var t=!1;a.cpuChart.series[0].data.length>20&&(t=!0);var i=a.cpuChart.series[0],r=a.cpuChart.series[1];i.addPoint([e,a.systemData],!0,t),r.addPoint([e,a.userData],!0,t)},a.appendMemoryChart=function(e){var t=!1;a.memoryChart.series[0].data.length>20&&(t=!0),a.memoryChart.series[0].addPoint([e,a.memoryData],!0,t)},a.appendDiskChart=function(e){var t=!1;a.diskChart.series[0].data.length>20&&(t=!0),a.diskChart.series[0].addPoint([e,a.diskData],!0,t)},a.appendNetworkChart=function(e){var t=!1;a.networkChart.series[0].data.length>20&&(t=!0);var i=a.networkChart.series[0],r=a.networkChart.series[1];i.addPoint([e,a.rxData],!0,t),r.addPoint([e,a.txData],!0,t)},a.getCpuData=function(e){var i=(new Date).getTime(),o=n.getOverviewSystemCpu(),s=n.getOverviewUserCpu();t.all([o,s]).then(function(e){if(a.cpuChart.hideLoading(),e[0].data.data.result[0]){var t=100*e[0].data.data.result[0].value[1];a.systemData=parseFloat(t.toFixed(2))}if(e[1].data.data.result[0]){var n=100*e[1].data.data.result[0].value[1];a.userData=parseFloat(n.toFixed(2))}a.appendCpuChart(i),r(function(){a.appendCpuChart(i+1e3)},1e3)})},a.getMemoryData=function(e){var t=(new Date).getTime();n.getOverviewMemory().success(function(e){if(a.memoryChart.hideLoading(),e.data.result[0]){var i=e.data.result[0].value[1];a.memoryData=parseFloat((i/1048576).toFixed(2))}a.appendMemoryChart(t),r(function(){a.appendMemoryChart(t+1e3)},2e3)})},a.getDiskData=function(e){var t=(new Date).getTime();n.getOverviewDisk().success(function(e){if(a.diskChart.hideLoading(),e.data.result[0]){var i=e.data.result[0].value[1];a.diskData=parseFloat((i/1048576).toFixed(2))}a.appendDiskChart(t),r(function(){a.appendDiskChart(t+1e3)},2e3)})},a.getNetworkData=function(){var e=(new Date).getTime(),i=n.getOverviewRxNetwork(),o=n.getOverviewTxNetwork();t.all([i,o]).then(function(t){if(a.networkChart.hideLoading(),t[0].data.data.result[1]){var i=t[0].data.data.result[0].value[1];a.rxData=parseInt((i/1048576).toFixed(2))}if(t[1].data.data.result[0]){var n=t[1].data.data.result[0].value[1];a.txData=parseInt((n/1048576).toFixed(2))}a.appendNetworkChart(e),r(function(){a.appendNetworkChart(e+1e3)},1e3)})},a.getCpuData(),a.getMemoryData(),a.getDiskData(),a.getNetworkData(),a.resourceInterval=i(function(){a.getCpuData(),a.getMemoryData(),a.getDiskData(),a.getNetworkData()},2e3),e.$on("$destroy",function(){i.cancel(a.resourceInterval)})}]),angular.module("com.dcos.app").controller("CommunityController",["$state","$filter","$uibModal","api","PackageService","dialog",function(e,t,i,r,n,o){var a=this;a.initPageSize=r.initPageSize,a.packageFilter="",a.loading=!0,n.getAllPkgs().success(function(e){a.loading=!1,a.pkgs=[];for(var t=0;t<e.packages.length;t++)a.pkgs.push(e.packages[t]);a.page=1,a.pageSize=a.initPageSize,a.length=a.pkgs.length}),a.installPkg=function(e,t){var r=i.open({animation:!0,templateUrl:"controllers/package/community/install/install.html",controller:"PackageInstallController as vm",size:"sm",resolve:{pkg:t}});r.result.then(function(){a.pkgs.splice(e,1),o.alert(t.name+"安装成功！")})},a.showDetail=function(t){e.go("package.list.detail",{name:t.name,version:t.currentVersion})}}]),angular.module("com.dcos.app").controller("PackageDetailController",["$stateParams","$uibModal","dialog","PackageService",function(e,t,i,r){var n=this;n.name=e.name,n.currentVersion=e.currentVersion,r.describePkg(n.name,n.currentVersion).success(function(e){n.description=e["package"].description,n.images=e.resource.images,n.scm=e["package"].scm,n.maintainer=e["package"].maintainer,n.licenses=e["package"].licenses,n.preInstallNotes=e["package"].preInstallNotes}),n.installPkg=function(){var e=t.open({animation:!0,templateUrl:"controllers/package/community/install/install.html",controller:"PackageInstallController as vm",size:"sm",resolve:{pkg:{name:n.name,version:n.currentVersion,images:n.images}}});e.result.then(function(){i.alert(pkg.name+"安装成功！")})}}]),angular.module("com.dcos.app").controller("PackageInstallController",["$uibModalInstance","$timeout","dialog","PackageService","pkg",function(e,t,i,r,n){var o=this;o.jsonValue=[],o.isValid=[],o["package"]=angular.copy(n),o.simpleInstall=function(){r.installPkg(o["package"].name,o["package"].version).success(function(t){e.close()}).error(function(e){e.type&&i.alert(e.message)})},o.advancedInstall=function(){o.advanced=!0,angular.element(".modal-sm").removeClass("modal-sm").addClass("modal-md")},o.changeTab=function(e){o.tab=e},r.describePkg(o["package"].name,o["package"].currentVersion).success(function(e){var t=o.makePropertiesRequired(e.config);o.properties=t.properties;for(var i in o.properties){o.tab=i;break}}),o.makePropertiesRequired=function(e){if(e.type&&"object"==e.type)for(var t in e.properties)e.required&&-1!=e.required.indexOf(t)||(e.required||(e.required=[]),e.required.push(t)),e.properties[t].type&&"object"==e.properties[t].type&&o.makePropertiesRequired(e.properties[t]);return e},o.ok=function(){o.submitted=!0,t(function(){o.options={};var t=0;for(var n in o.properties){if(!o.isValid[t])return void(o.submitted=!1);o.options[n]=o.jsonValue[t],t++}r.installPkg(o["package"].name,o["package"].version,o.options).success(function(t){o.submitted=!1,e.close()}).error(function(e){o.submitted=!1,e.type&&i.alert(e.message)})},100)},o.cancel=function(){e.dismiss("cancel")}}]),angular.module("com.dcos.app").controller("InstalledController",["$http","$uibModal","PackageService","dialog","api",function(e,t,i,r,n){var o=this;o.initPageSize=n.initPageSize,o.sortKey="name",o.reverse=!1,o.loading=!0,i.getInstalledPkgs().success(function(e){o.loading=!1,o.installedPkgs=[];var t,i,r;if(e.packages.length)for(var n=0;n<e.packages.length;n++)t=e.packages[n].packageInformation.packageDefinition.name,i=e.packages[n].packageInformation.packageDefinition.version,r=e.packages[n].packageInformation.resourceDefinition.images["icon-small"],o.installedPkgs.push({name:t,version:i,image:r});o.page=1,o.pageSize=o.initPageSize,o.length=o.installedPkgs.length}),o.uninstallPkg=function(e){i.uninstallPkg(e.name,e.version).success(function(t){for(var i,n=0;n<o.installedPkgs.length;n++)if(e.name==o.installedPkgs[n].name&&e.version==o.installedPkgs[n].version){i=n;break}o.installedPkgs.splice(i,1),r.alert("卸载成功！")})}}]),angular.module("com.dcos.app").controller("PackageController",["$http","$scope","$rootScope","$state","HttpPendingRequestsService","$uibModal","PackageService","dialog",function(e,t,i,r,n,o,a,s){var l=this;l.sortKey="name",l.reverse=!1,l.tab="community",l.goTab=function(e){switch(e){case"list":r.go("package.list");break;case"installed":r.go("package.installed");break;case"repository":r.go("package.repository");break;default:r.go("package.community")}},t.$on("$stateChangeSuccess",function(){r.includes("package.list")?l.tab="list":r.includes("package.installed")?l.tab="installed":r.includes("package.repository")&&(l.tab="repository")}),i.$on("$stateChangeSuccess",function(){n.cancelAll()})}]),angular.module("com.dcos.app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("package",{url:"/package",templateUrl:"controllers/package/package.html",controller:"PackageController as vm"}),e.state("package.list",{url:"/list",templateUrl:"controllers/package/community/community.html",controller:"CommunityController as vm"}),e.state("package.list.detail",{url:"/detail/{name:string}/{version:string}",views:{"@package":{templateUrl:"controllers/package/community/detail/detail.html",controller:"PackageDetailController as vm"}}}),e.state("package.installed",{url:"/installed",templateUrl:"controllers/package/installed/installed.html",controller:"InstalledController as vm"}),e.state("package.repository",{url:"/repository",templateUrl:"controllers/package/repository/repository.html",controller:"RepoController as vm"})}]),angular.module("com.dcos.app").factory("PackageService",["$http",function(e){return{getAllPkgs:function(){return e({method:"POST",url:"/package/search",headers:{"Content-type":"application/vnd.dcos.package.search-request+json;charset=UTF-8;version=v1",Accept:" application/vnd.dcos.package.search-response+json;charset=utf-8;version=v1"},data:{}})},getInstalledPkgs:function(){return e({method:"POST",url:"/package/list",headers:{"Content-Type":"application/vnd.dcos.package.list-request+json;charset=UTF-8;version=v1",Accept:"application/vnd.dcos.package.list-response+json;charset=utf-8;version=v1"},data:{}})},describePkg:function(t,i){return e({method:"POST",url:"/package/describe",headers:{"Content-Type":"application/vnd.dcos.package.describe-request+json;charset=UTF-8;version=v1",Accept:"application/vnd.dcos.package.describe-response+json;charset=utf-8;version=v1"},data:{packageName:t,packageVersion:i}})},installPkg:function(t,i,r){return e({method:"POST",url:"/package/install",headers:{"Content-Type":"application/vnd.dcos.package.install-request+json;charset=UTF-8;version=v1",Accept:"application/vnd.dcos.package.install-response+json;charset=utf-8;version=v1"},data:{packageName:t,packageVersion:i,appId:t,options:r||{}}})},uninstallPkg:function(t,i){return e({method:"POST",url:"/package/uninstall",headers:{Accept:"application/vnd.dcos.package.uninstall-response+json;charset=utf-8;version=v1","Content-Type":"application/vnd.dcos.package.uninstall-request+json;charset=UTF-8;version=v1"},data:{packageName:t,packageVersion:i,appId:"/"+t,all:!1}})},deleteRepo:function(t){return e({method:"POST",url:"/package/repository/delete",headers:{"Content-Type":"application/vnd.dcos.package.repository.delete-request+json;charset=UTF-8;version=v1",Accept:"application/vnd.dcos.package.repository.delete-response+json;charset=utf-8;version=v1"},data:{name:t}})},addRepo:function(t,i){return e({method:"POST",url:"/package/repository/add/",headers:{"Content-Type":"application/vnd.dcos.package.repository.add-request+json;charset=UTF-8;version=v1",Accept:"application/vnd.dcos.package.repository.add-response+json;charset=utf-8;version=v1"},data:{name:t,uri:i}})},listRepo:function(){return e({method:"POST",url:"/package/repository/list",headers:{"Content-Type":"application/vnd.dcos.package.repository.list-request+json;charset=UTF-8;version=v1",Accept:"application/vnd.dcos.package.repository.list-response+json;charset=utf-8;version=v1"},data:{}})}}}]),angular.module("com.dcos.app").controller("RepoCreateController",["$uibModalInstance","PackageService","dialog",function(e,t,i){var r=this;r.ok=function(){t.addRepo(r.repoName,r.repoUri).success(function(t){e.close()})},r.cancel=function(){e.dismiss("cancel")}}]),angular.module("com.dcos.app").controller("RepoController",["$http","$uibModal","$filter","PackageService","dialog","api",function(e,t,i,r,n,o){var a=this;a.initPageSize=o.initPageSize,a.addRepo=function(){var e=t.open({animation:!0,templateUrl:"controllers/package/repository/create/create.html",controller:"RepoCreateController as vm",size:"md"});e.result.then(function(){a.listRepo()})},a.deleteRepo=function(e,t){var i=n.confirm("确定删除软件仓库"+t.name+"吗？");i.then(function(i){i&&r.deleteRepo(t.name).success(function(t){a.repos.splice(e,1)})})},a.listRepo=function(){a.loading=!0,r.listRepo().success(function(e){if(a.loading=!1,a.repos=[],e.repositories.length){a.repos=[];for(var t=0;t<e.repositories.length;t++)a.repos.push({name:e.repositories[t].name,uri:e.repositories[t].uri})}a.page=1,a.pageSize=a.initPageSize,a.length=a.repos.length})},a.listRepo()}]),angular.module("com.dcos.app").controller("EntityCreateController",["$scope","$cookies","$uibModalInstance","$q","PrivilegeService","dialog","entities","projects","roles","users",function(e,t,i,r,n,o,a,s,l,c){var d=this;d.entities=a,d.projects=s,d.roles=l,d.users=c;var h=t.getObject("token");d.currentRole=h.roles[0].name,d.userId=h.user.id,d.entity={project:d.projects[0],user:d.users[0],role:d.roles[0]},d.changeProject=function(){for(var e=0,t=d.entities.length;t>e;e++)if(d.entity.project==d.entities[e].project)return d.roles=[d.entities[e].role],void(d.entity.role=d.roles[0]);d.roles=l,d.entity.role=d.roles[0]},d.changeProject(),d.ok=function(){for(var e=0,t=d.entities.length;t>e;e++)if(d.entity.project==d.entities[e].project&&d.entity.user==d.entities[e].user&&d.entity.role==d.entities[e].role)return void o.alert("用户已存在该权限！");var a=n.getProjectIdByName(d.currentRole,d.userId,d.entity.project),s=n.getUserIdByName(d.entity.user),l=n.getRoleIdByName(d.entity.role);r.all([a,s,l]).then(function(e){var t=e[0].data.projects[0].id,r=e[1].data.users[0].id,a=e[2].data.roles[0].id;n.createEntity(t,r,a).success(function(e){i.close()}).error(function(e){o.alert(e.error.message)})})},d.cancel=function(){i.dismiss("cancel")}}]),angular.module("com.dcos.app").controller("PrivilegeEntityController",["$rootScope","$cookies","$uibModal","$q","$filter","$timeout","api","PrivilegeService","dialog",function(e,t,i,r,n,o,a,s,l){var c=this;c.initPageSize=a.initPageSize;var d=t.getObject("token");c.currentUserId=d.user.id,c.currentRole=d.roles[0].name,c.currentProjectId=d.project.id,c.currentProject=d.project.name,c.entities=[],c.filterArr=[{key:"域",value:"project"},{key:"用户",value:"user"},{key:"权限",value:"role"}],c.query={key:"project",value:""},c.listEntitys=function(){c.entities=[],c.loading=!0,"admin"==c.currentRole?s.getUserList(c.currentRole,c.currentProjectId).success(function(e){c.users=e.users;for(var t=0,i=c.users.length;i>t;t++)!function(e,r,n){s.getEntityList(c.currentRole,c.currentProjectId,c.users[t].id).success(function(t){c.roles=t.roles;for(var n=0,o=c.roles.length;o>n;n++)"super"!=c.roles[n].name&&(c.entities.push({project:c.currentProject,user:e,role:c.roles[n].name,projectId:c.currentProjectId,userId:r,roleId:c.roles[n].id}),c.entities.length>=i-1&&n>=o-1&&(c.loading=!1,c.entityLength=c.entities.length))})}(c.users[t].name,c.users[t].id,t)}):"super"==c.currentRole&&s.getEntityList(c.currentRole,"","").success(function(e){for(var t=e.role_assignments,i=0,n=t.length;n>i;i++){var o=s.getProjectDetail(t[i].scope.project.id),a=s.getUserDetail(t[i].user.id),l=s.getRoleDetail(t[i].role.id);!function(e,t,i){r.all([o,a,l]).then(function(r){var o=r[0].data.project.name,a=r[1].data.user.name,s=r[2].data.role.name;c.entities.push({project:o,user:a,role:s,projectId:e,userId:t,roleId:i}),c.entities.length>=n-1&&(c.loading=!1,c.entityLength=n)})}(t[i].scope.project.id,t[i].user.id,t[i].role.id)}}),c.page=1,c.pageSize=c.initPageSize,c.projectSortKey="project",c.projectReverse=!1},c.listEntitys(),c.changePager=function(){var e=n("objectFilter")(c.entities,c.query.key,c.query.value);c.entityLength=0,o(function(){c.entityLength=e.length},1)},c.createEntity=function(){var e=i.open({animation:!0,templateUrl:"controllers/privilege/entity/create/create.html",controller:"EntityCreateController as vm",size:"lgSize",resolve:{entities:function(){return c.entities},projects:["$rootScope","$q",function(e,t){if("admin"==c.currentRole)return[c.currentProject];if("super"==c.currentRole){var i=t.defer();return e.loading=!0,s.getProjectList(c.currentRole,c.currentUserId).success(function(t){e.loading=!1;for(var r=[],n=0,o=t.projects.length;o>n;n++)r.push(t.projects[n].name);i.resolve(r)}).error(function(){i.resolve([])}),i.promise}}],roles:function(){if("admin"==c.currentRole){for(var e=0,t=c.entities.length;t>e;e++)if(c.currentProject==c.entities[e].project)return[c.entities[e].role];return["admin","member"]}return"super"==c.currentRole?["super","admin","member"]:void 0},users:["$rootScope","$q",function(e,t){var i=t.defer();return s.getUsers().success(function(e){for(var t=[],r=0,n=e.users.length;n>r;r++)t.push(e.users[r].name);i.resolve(t)}).error(function(){i.resolve([])}),i.promise}]}});e.result.then(function(){c.listEntitys()})},c.modifyEntity=function(e){var t=i.open({animation:!0,templateUrl:"controllers/privilege/entity/modify/modify.html",controller:"EntityModifyController as vm",size:"lgSize",resolve:{entity:function(){return e}}});t.result.then(function(){c.listEntitys()})},c.deleteEntity=function(e){var t=l.confirm("确定删除该权限？");t.then(function(t){t&&s.deleteEntity(e).success(function(e){c.listEntitys()})})}}]),angular.module("com.dcos.app").controller("EntityModifyController",["$scope","$cookies","$uibModalInstance","PrivilegeService","dialog","entity",function(e,t,i,r,n,o){var a=this;a.entity=angular.copy(o);var s=t.getObject("token");a.currentRole=s.roles[0].name,"admin"==a.currentRole?a.roles=["admin","member"]:"super"==a.currentRole&&(a.roles=["super","admin","member"]),a.ok=function(){r.getRoleIdByName(a.entity.role).success(function(e){var t=e.roles[0].id;r.createEntity(a.entity.projectId,a.entity.userId,t).success(function(e){r.deleteEntity(a.entity).success(function(e){i.close()}).error(function(e){})})})},a.cancel=function(){i.dismiss("cancel")}}]),angular.module("com.dcos.app").directive("customZTree",function(){return{restrict:"EA",scope:{treeObj:"=ngModel",data:"=roleEntity"},link:function(e,t,i){e.setting={check:{enable:!0},data:{simpleData:{enable:!0}},callback:{onCheck:function(t,i,r){var n=$.fn.zTree.getZTreeObj(i);e.treeObj.selectedNodes=n.getCheckedNodes(!0)}}},$.fn.zTree.init(t,e.setting,e.data),e.$on("changeEntityRole",function(i,r){$.fn.zTree.init(t,e.setting,r)})}}}),angular.module("com.dcos.app").controller("PrivilegeListController",["$state","$cookies",function(e,t){var i=this,r=t.getObject("token");i.currentRole=r.roles[0].name,i.goTab=function(t){switch(t){case"user":i.tab="user",e.go("privilege.user");break;case"project":i.tab="project",e.go("privilege.project");break;case"entity":i.tab="entity",e.go("privilege.entity");break;case"role":i.tab="role",e.go("privilege.role");break;default:e.go("privilege.user")}},e.includes("privilege.user")?i.goTab("user"):e.includes("privilege.project")?i.goTab("project"):e.includes("privilege.entity")?i.goTab("entity"):e.includes("privilege.role")&&i.goTab("role")}]),angular.module("com.dcos.app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("privilege",{url:"/privilege",templateUrl:"controllers/privilege/privilege.html",controller:"PrivilegeListController as vm"}),e.state("privilege.user",{url:"/user",templateUrl:"controllers/privilege/user/user.html",controller:"PrivilegeUserController as vm"}),e.state("privilege.project",{url:"/project",templateUrl:"controllers/privilege/project/project.html",controller:"PrivilegeProjectController as vm"}),e.state("privilege.role",{url:"/role",templateUrl:"controllers/privilege/role/role.html",controller:"PrivilegeRoleController as vm"}),e.state("privilege.entity",{url:"/entity",templateUrl:"controllers/privilege/entity/entity.html",controller:"PrivilegeEntityController as vm"}),e.state("privilege.projectmanagelist",{url:"/projectmanagelist?project&name",templateUrl:"controllers/privilege/project/user-manage/projectmanagelist.html",controller:"ProjectManageController as vm"})}]),angular.module("com.dcos.app").factory("PrivilegeService",["$http","$cookies",function(e,t){return{getDomainIdByName:function(t){return e({url:"/acs/api/v3/domains?name="+t,method:"GET"})},getProjectList:function(t,i){if("super"==t)var r="/acs/api/v3/projects";else var r="/acs/api/v3/users/"+i+"/projects";return e({url:r,method:"GET"})},getProjectDetail:function(t){return e({url:"/acs/api/v3/projects/"+t,method:"GET"})},getProjectIdByName:function(t,i,r){if("super"==t)var n="/acs/api/v3/projects?name="+r;else var n="/acs/api/v3/users/"+i+"/projects?name="+r;return e({url:n,method:"GET"})},createProject:function(t,i){return e({url:"/acs/api/v3/projects",method:"POST",data:{project:{domain_id:t,name:i.name,description:i.description}}})},modifyProject:function(t){return e({url:"/acs/api/v3/projects/"+t.id,method:"PATCH",data:{project:{name:t.name,description:t.description,enabled:t.enabled}}})},deleteProject:function(t){return e({url:"/acs/api/v3/projects/"+t,method:"DELETE"})},getRoleList:function(){return e({url:"/acs/api/v3/roles",method:"GET"})},getRoleDetail:function(t){return e({url:"/acs/api/v3/roles/"+t,method:"GET"})},getRoleIdByName:function(t){return e({url:"/acs/api/v3/roles?name="+t,method:"GET"})},createRole:function(t){return e({url:"/acs/api/v3/roles",method:"POST",data:{role:{name:t.name,description:t.description}}})},deleteRole:function(t){return e({url:"/acs/api/v3/roles/"+t,method:"DELETE"})},modifyRole:function(t){return e({url:"/acs/api/v3/roles/"+t.id,method:"PATCH",data:{role:{name:t.name,description:t.description}}})},getUserList:function(t,i){if("admin"==t)var r="/acs/api/v2.0/tenants/"+i+"/users";else if("super"==t)var r="/acs/api/v3/users";return e({url:r,method:"GET"})},getUsers:function(){return e({url:"/acs/api/v3/users",method:"GET"})},getUserDetail:function(t){return e({url:"/acs/api/v3/users/"+t,method:"GET"})},getUserIdByName:function(t){return e({url:"/acs/api/v3/users?name="+t,method:"GET"})},createUser:function(t,i){return e({url:"/acs/api/v3/users",method:"POST",data:{user:{domain_id:t,name:i.name,password:i.password,email:i.email,enabled:i.enabled,description:i.description}}})},modifyUser:function(t){return e({url:"/acs/api/v3/users/"+t.id,method:"PATCH",data:{user:{name:t.name,description:t.description,email:t.email,enabled:t.enabled}}})},deleteUser:function(t){return e({url:"/acs/api/v3/users/"+t,method:"DELETE"})},getEntityList:function(t,i,r){if("admin"==t)var n="/acs/api/v3/projects/"+i+"/users/"+r+"/roles";else if("super"==t)var n="/acs/api/v3/role_assignments";return e({url:n,method:"GET"})},createEntity:function(t,i,r){return e({url:"/acs/api/v3/projects/"+t+"/users/"+i+"/roles/"+r,method:"PUT"})},deleteEntity:function(t){return e({url:"/acs/api/v3/projects/"+t.projectId+"/users/"+t.userId+"/roles/"+t.roleId,method:"DELETE"})}}}]),angular.module("com.dcos.app").controller("ProjectCreateController",["$scope","$uibModalInstance","PrivilegeService","dialog",function(e,t,i,r){var n=this;n.ok=function(e){i.getDomainIdByName("default").success(function(e){n.domain_id=e.domains[0].id,i.createProject(n.domain_id,n.project).success(function(e){t.close()}).error(function(e){r.alert(e.error.message)})})},n.cancel=function(){t.dismiss("cancel")}}]),angular.module("com.dcos.app").controller("ProjectModifyController",["$scope","$uibModalInstance","PrivilegeService","dialog","project",function(e,t,i,r,n){var o=this;o.project=angular.copy(n),o.ok=function(e){"在用"==o.project.enabled?o.project.enabled=!0:o.project.enabled=!1,i.modifyProject(o.project).success(function(e){t.close()}).error(function(e){r.alert(e.error.message)})},o.cancel=function(){t.dismiss("cancel")}}]),angular.module("com.dcos.app").controller("PrivilegeProjectController",["$rootScope","$cookies","$uibModal","$filter","$timeout","api","PrivilegeService","ServiceService","dialog",function(e,t,i,r,n,o,a,s,l){var c=this;c.initPageSize=o.initPageSize;var d=t.getObject("token");c.currentUserId=d.user.id,c.currentRole=d.roles[0].name,c.currentProjectId=d.project.id,c.projects=[],c.listProjects=function(){c.loading=!0,a.getProjectList(c.currentRole,c.currentUserId).success(function(e){c.loading=!1,c.projects=e.projects;for(var t=0,i=c.projects.length;i>t;t++)c.projects[t].enabled?c.projects[t].enabled="在用":c.projects[t].enabled="停用";c.page=1,c.pageSize=c.initPageSize,c.projectLength=c.projects.length,c.sortKey="name",c.reverse=!1})},c.listProjects(),c.changePager=function(){var e=r("filter")(c.projects,{name:c.projectFilter});c.projectLength=0,n(function(){c.projectLength=e.length},1)},c.createProject=function(){var e=i.open({animation:!0,templateUrl:"controllers/privilege/project/create/create.html",controller:"ProjectCreateController as vm",size:"md"});e.result.then(function(){c.listProjects(),l.alert("域创建成功！")})},c.deleteProject=function(e,t){var i=l.confirm("确定删除该域？");i.then(function(i){i&&s.getServiceList(t).success(function(t){null!=t.frameworks?l.alert("请先删除该域对应的marathon服务，再尝试该操作！"):a.deleteProject(e).success(function(e){c.listProjects()}).error(function(e){l.alert(e.error.message)})})})},c.modifyProject=function(e){var t=i.open({animation:!0,templateUrl:"controllers/privilege/project/modify/modify.html",controller:"ProjectModifyController as vm",size:"md",resolve:{project:e}});t.result.then(function(){c.listProjects(),l.alert("域信息修改成功！")})}}]),angular.module("com.dcos.app").controller("RoleCreateController",["$scope","$uibModalInstance","PrivilegeService","dialog",function(e,t,i,r){var n=this;n.ok=function(e){i.createRole(n.role).success(function(e){t.close()}).error(function(e){r.alert(e.error.message)})},n.cancel=function(){t.dismiss("cancel")}}]),angular.module("com.dcos.app").controller("RoleModifyController",["$scope","$uibModalInstance","PrivilegeService","dialog","role",function(e,t,i,r,n){var o=this;o.role=n,o.ok=function(e){i.modifyRole(o.role).success(function(e){t.close()}).error(function(e){r.alert(e.error.message)})},o.cancel=function(){t.dismiss("cancel")}}]),angular.module("com.dcos.app").controller("PrivilegeRoleController",["$rootScope","$cookies","$uibModal","$filter","$timeout","api","PrivilegeService","dialog",function(e,t,i,r,n,o,a,s){var l=this;l.initPageSize=o.initPageSize;var c=t.getObject("token");l.currentRole=c.roles[0].name,l.currentProjectId=c.project.id,l.listRoles=function(){l.roles=[],"super"==l.currentRole&&(l.loading=!0,a.getRoleList().success(function(e){l.loading=!1,l.roles=e.roles,l.page=1,l.pageSize=l.initPageSize,l.roleLength=l.roles.length}))},l.listRoles(),l.changePager=function(){var e=r("filter")(l.roles,{name:l.roleFilter});l.roleLength=0,n(function(){l.roleLength=e.length},1)},l.createRole=function(){var e=i.open({animation:!0,templateUrl:"controllers/privilege/role/create/create.html",controller:"RoleCreateController as vm",size:"md"});e.result.then(function(){l.listRoles(),s.alert("角色创建成功！")})},l.deleteRole=function(e){var t=s.confirm("确定删除该角色？");t.then(function(t){t&&a.deleteRole(e).success(function(e){l.listRoles()}).error(function(e){s.alert(e.error.message)})})},l.modifyRole=function(e){var t=i.open({animation:!0,templateUrl:"controllers/privilege/role/modify/modify.html",controller:"RoleModifyController as vm",size:"md",resolve:{role:e}});t.result.then(function(){l.listRoles(),s.alert("角色信息修改成功！")})}}]),angular.module("com.dcos.app").controller("UserCreateController",["$scope","$uibModalInstance","PrivilegeService","dialog",function(e,t,i,r){var n=this;n.user={enabled:"在用"},n.ok=function(e){"在用"==n.user.enabled?n.user.enabled=!0:n.user.enabled=!1,i.getDomainIdByName("default").success(function(e){n.domain_id=e.domains[0].id,i.createUser(n.domain_id,n.user).success(function(e){t.close()}).error(function(e){r.alert(e.error.message)})})},n.cancel=function(){t.dismiss("cancel")}}]),angular.module("com.dcos.app").controller("UserModifyController",["$scope","$uibModalInstance","PrivilegeService","dialog","user",function(e,t,i,r,n){var o=this;o.user=angular.copy(n),o.ok=function(e){"在用"==o.user.enabled?o.user.enabled=!0:o.user.enabled=!1,i.modifyUser(o.user).success(function(e){t.close()}).error(function(e){r.alert(e.error.message)})},o.cancel=function(){t.dismiss("cancel")}}]),angular.module("com.dcos.app").controller("PrivilegeUserController",["$rootScope","$cookies","$uibModal","$filter","$timeout","api","PrivilegeService","dialog",function(e,t,i,r,n,o,a,s){var l=this;l.initPageSize=o.initPageSize;var c=t.getObject("token");l.currentRole=c.roles[0].name,l.currentProjectId=c.project.id,l.users=[],l.listUsers=function(){"admin"!=l.currentRole&&"super"!=l.currentRole||(l.loading=!0,a.getUserList(l.currentRole,l.currentProjectId).success(function(e){l.loading=!1,l.users=e.users;for(var t=0,i=l.users.length;i>t;t++)l.users[t].enabled?l.users[t].enabled="在用":l.users[t].enabled="停用";l.page=1,l.pageSize=l.initPageSize,l.userLength=l.users.length,l.sortKey="name",l.reverse=!1}))},l.listUsers(),l.changePager=function(){var e=r("filter")(l.users,{name:l.userFilter});l.userLength=0,n(function(){l.userLength=e.length},1)},l.deleteUser=function(e){var t=s.confirm("确定删除该用户？");t.then(function(t){t&&a.deleteUser(e).success(function(e){l.listUsers(),s.alert("删除成功！")}).error(function(e){s.alert(e.error.message)})})},l.modifyUser=function(e){var t=i.open({animation:!0,templateUrl:"controllers/privilege/user/modify/modify.html",controller:"UserModifyController as vm",size:"md",resolve:{user:function(){return e}}});t.result.then(function(){l.listUsers(),s.alert("用户信息修改成功！")})},l.createUser=function(){var e=i.open({animation:!0,templateUrl:"controllers/privilege/user/create/create.html",controller:"UserCreateController as vm",size:"md"});e.result.then(function(){l.listUsers(),s.alert("用户创建成功！")})}}]),angular.module("com.dcos.app").controller("ServiceCreateController",["$scope","$uibModalInstance","message",function(e,t,i){e.message=i,e.currentStage=0,e.ok=function(){t.close()},e.type=["负载均衡/Haproxy"],e.cancel=function(){t.dismiss("cancel")},e.selectedLBs=[{host:"",port:""}],e["new"]=function(){e.selectedLBs[e.selectedLBs.length]={host:"",port:""}}}]),angular.module("com.dcos.app").controller("ServiceListController",["$cookies","$uibModal","$mdSidenav","$timeout","$filter","api","ServiceService",function(e,t,i,r,n,o,a){var s=this;s.initPageSize=o.initPageSize,s.services=[],s.allCount=0,s.healthyCount=0,s.unhealthyCount=0;var l=e.getObject("token");s.project=l.project.name,s.userId=l.user.id,s.role=l.roles[0].name,"super"==s.role&&"All"==s.project&&(s.project="*"),s.loading=!0,a.getServiceList(s.project,s.role).success(function(e){s.services=e.frameworks||[];for(var t=0,i=s.services.length;i>t;t++)s.services[t].active&&s.healthyCount++,
function(e){a.getServiceTasks(s.userId,s.services[t].name,s.role).success(function(t){s.services[e].tasks=t.tasks})}(t);t>=i&&(s.loading=!1),s.allCount=s.services.length,s.unhealthyCount=s.allCount-s.healthyCount,s.servicePage=1,s.servicePageSize=s.initPageSize,s.serviceLength=s.allCount,s.serviceSortKey="name",s.serviceReverse=!1}),s.statusFilter="",s.searchStatus=function(e){"all"==e?s.statusFilter="":"healthy"==e?s.statusFilter=!0:"unhealthy"==e&&(s.statusFilter=!1),s.changePager()},s.changePager=function(){var e=n("filter")(s.services,{name:s.serviceFilter,active:s.statusFilter});s.serviceLength=0,r(function(){s.serviceLength=e.length},1)},s.splitState=function(e){var t=e.split("_");return s.task_state=t[1],s.task_state},s.selected=void 0,s.message="节点进去维护状态后,所有在节点之上的容器都会被清空!",s.create=function(e){var i=t.open({animation:!0,templateUrl:"controllers/service/create.html",controller:"ServiceCreateController",size:e,resolve:{message:function(){return s.message}}});i.result.then(function(){},function(){})},s.cancel=function(){i("right").close()},s.isOpenRight=function(){return i("right").isOpen()},s.toggleRight=function(e){return s.service=e,s.tab="task",s.taskPage=1,s.taskPageSize=s.initPageSize,null!=s.service.tasks?s.taskLength=s.service.tasks.length:s.taskLength=0,s.taskSortKey="name",s.taskReverse=!1,s.service_url="/service/"+s.service.name+"/",i("right").toggle()}}]),angular.module("com.dcos.app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("service",{url:"/service",template:"<div ui-view></div>","abstract":!0}),e.state("service.list",{url:"/list",templateUrl:"controllers/service/service.html",controller:"ServiceListController as vm"})}]),angular.module("com.dcos.app").factory("ServiceService",["$http",function(e){return{getServiceList:function(t){return e({method:"GET",url:"/tasc/api/v1/frameworks?project_id="+t})},getServiceTasks:function(t,i,r){return e({method:"GET",url:"/tasc/api/v1/tasks?user_id="+t+"&service_id="+i+"&role="+r})}}}]),angular.module("com.dcos.app").factory("dialog",["$uibModal",function(e){function t(t,i){var r=e.open({templateUrl:"controllers/shared/dialog/"+t+"/index.html",resolve:{mode:function(){return t},data:function(){return i}},size:"md",windowClass:"dialog-modal",controller:["$uibModalInstance","mode","data",function(e,t,i){var r=this;r.data=i,r.ok=function(){e.close(i)},r.dismiss=function(){e.dismiss()},"tip"==t&&setTimeout(function(){e.dismiss()},2e3)}],controllerAs:"vm"});return r.result}var i={};return i.open=t,i.alert=function(e){return t("alert",e)},i.confirm=function(e){return t("confirm",e)},i.warn=function(e){return t("warn",e)},i.error=function(e){return t("error",e)},i.tip=function(e){return t("tip",e)},i}]),angular.module("com.dcos.app").controller("SlaveCreateController",["$scope","$uibModalInstance","message",function(e,t,i){e.message=i,e.currentStage=0,e.ok=function(){t.close()},e.cancel=function(){t.dismiss("cancel")}}]),angular.module("com.dcos.app").directive("progressBar",function(){return{restrict:"EA",replace:!0,scope:{bgColor:"@",total:"@",used:"@"},template:'<div class="progress-bar"><div class="progress-line">{{text}}</div></div>',link:function(e,t,i){e.text=parseFloat(e.used/e.total*100).toFixed(2)+"%",$(t).find(".progress-line").css({width:e.text,backgroundColor:e.bgColor})}}}),angular.module("com.dcos.app").controller("SlaveListController",["$rootScope","$cookies","$uibModal","$interval","$timeout","$mdSidenav","$filter","api","SlaveService",function(e,t,i,r,n,o,a,s,l){var c=this;c.initPageSize=s.initPageSize,c.slaves=[],c.tasks=[],c.allCount=0,c.healthyCount=0,c.unhealthyCount=0;var d=t.getObject("token");c.projectName=d.project.name,c.projectId=d.project.id,c.loading=!0,l.getSlaveProject().success(function(e){c.slaveProjectMap=e.agents,l.getSlaveList().success(function(e){c.loading=!1,c.slaves=e.slaves||[];for(var t=0,i=c.slaves.length;i>t;t++)"*"==c.projectId||c.slaveProjectMap[c.slaves[t].hostname]&&-1!=c.slaveProjectMap[c.slaves[t].hostname].mesos_roles.indexOf(c.projectName)?c.slaves[t].active&&c.healthyCount++:(c.slaves.splice(t,1),t-=1,i-=1);c.allCount=c.slaves.length,c.unhealthyCount=c.allCount-c.healthyCount,c.slavePage=1,c.slavePageSize=c.initPageSize,c.slaveLength=c.allCount,c.hostSortKey="hostname",c.hostReverse=!1;var r=e.frameworks||[];for(t=0,i=r.length;i>t;t++)c.tasks=c.tasks.concat(r[t].tasks);for(t=0,i=c.slaves.length;i>t;t++){c.slaves[t].activeTask=0,c.slaves[t].failedTask=0;for(var n in c.tasks){var o=c.tasks[n];o.slave_id==c.slaves[t].id&&("TASK_RUNNING"==o.state?c.slaves[t].activeTask+=1:"TASK_FAILED"==o.state&&(c.slaves[t].failedTask+=1))}}})}),c.statusFilter="",c.searchStatus=function(e){"all"==e?c.statusFilter="":"healthy"==e?c.statusFilter=!0:"unhealthy"==e&&(c.statusFilter=!1),c.changePager()},c.changePager=function(){var e=a("filter")(c.slaves,{hostname:c.hostnameFilter,active:c.statusFilter});c.slaveLength=0,n(function(){c.slaveLength=e.length},1)},c.cancel=function(){o("right").close()},c.toggleRight=function(t){c.tab="config",c.slave=t,c.slave.tasks=[],c.slave.active_count=0,c.slave.failed_count=0,e.loading=!0,l.getComponentList(c.slave.hostname).success(function(t){e.loading=!1,c.comps=t.units||[],c.compPage=1,c.compPageSize=c.initPageSize,c.compLength=c.comps.length,c.compSortKey="name",c.compReverse=!1;for(var i in c.tasks){var r=c.tasks[i];if(r.slave_id==c.slave.id)switch(r.state){case"TASK_RUNNING":c.slave.tasks.push(r),c.slave.active_count++;break;case"TASK_FAILED":c.slave.failed_count++;break;case"TASK_KILLED":}}return c.taskPage=1,c.taskPageSize=c.initPageSize,c.taskLength=c.slave.tasks.length,c.taskSortKey="id",c.taskReverse=!1,o("right").toggle()})},c.isOpenRight=function(){return o("right").isOpen()}}]),angular.module("com.dcos.app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("slave",{url:"/slave",template:"<div ui-view></div>","abstract":!0}),e.state("slave.list",{url:"/list",templateUrl:"controllers/slave/slave.html",controller:"SlaveListController as vm"})}]),angular.module("com.dcos.app").factory("SlaveService",["$http",function(e){return{getSlaveList:function(){return e.get("/mesos/master/state")},getComponentList:function(t){return e.get("/system/health/v1/nodes/"+t+"/units")},getSlaveProject:function(){return e.get("/tasc/api/v1/stat")}}}]),angular.module("com.dcos.app").controller("SystemListController",["$rootScope","$uibModal","$mdSidenav","$timeout","$filter","api","SystemService",function(e,t,i,r,n,o,a){var s=this;s.initPageSize=o.initPageSize,s.components=[],s.allCount=0,s.healthyCount=0,s.unhealthyCount=0,a.getComponentList().success(function(e){s.components=e.units;for(var t=0,i=s.components.length;i>t;t++)0==s.components[t].health&&s.healthyCount++;s.allCount=s.components.length,s.unhealthyCount=s.allCount-s.healthyCount,s.compPage=1,s.compPageSize=s.initPageSize,s.compLength=s.allCount,s.compSortKey="name",s.compReverse=!1}),s.statusFilter="",s.searchStatus=function(e,t){var i="";"all"==e?i="":"healthy"==e?i=0:"unhealthy"==e&&(i=1),t?(s.nodeStatusFilter=i,s.changeNodePage()):(s.statusFilter=i,s.changePager())},s.changePager=function(){var e=n("filter")(s.components,{name:s.compFilter,health:s.statusFilter});s.compLength=0,r(function(){s.compLength=e.length},1)},s.changeNodePage=function(){var e=n("objectFilter")(s.nodes,s.query.key,s.query.value);e=n("filter")(e,{health:s.nodeStatusFilter}),s.nodeLength=0,r(function(){s.nodeLength=e.length},1)},s.toggleRight=function(t,r,n,o){return s.component=t,s.tab="config",s.query={key:"host_ip",value:""},s.nodeAllCount=0,s.nodeHealthyCount=0,s.nodeUnhealthyCount=0,s.nodeSortKey="host_ip",s.nodeReverse=!1,s.nodeStatusFilter="",e.loading=!0,a.getComponentNodeList(s.component.id).success(function(t){e.loading=!1,s.nodes=t.nodes;for(var i=0,r=s.nodes.length;r>i;i++)0==s.nodes[i].health&&s.nodeHealthyCount++;s.nodeAllCount=s.nodes.length,s.nodeUnhealthyCount=s.nodeAllCount-s.nodeHealthyCount,s.nodePage=1,s.nodePageSize=s.initPageSize,s.nodeLength=s.nodeAllCount}),i("right").toggle()},s.cancel=function(){i("right").close()},s.isOpenRight=function(){return i("right").isOpen()},s.filterArr=[{key:"节点",value:"host_ip"},{key:"角色",value:"role"}]}]),angular.module("com.dcos.app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("system",{url:"/system",template:"<div ui-view></div>","abstract":!0}),e.state("system.list",{url:"/list",templateUrl:"controllers/system/system.html",controller:"SystemListController as vm"})}]),angular.module("com.dcos.app").factory("SystemService",["$http",function(e){return{getComponentList:function(){return e.get("/system/health/v1/units")},getComponentNodeList:function(t){return e.get("/system/health/v1/units/"+t+"/nodes")}}}]),angular.module("com.dcos.app").controller("LayoutHeaderController",["$http","$state","$uibModal","$cookies","dialog","LoginService",function(e,t,i,r,n,o){var a=this,s=r.getObject("token");return s?(a.currentUser=s.user.name,a.filters=[],a.logout=function(){o.logout().then(function(e){r.remove("token"),t.go("login")},function(e){})},void(a.editUser=function(){var e=i.open({templateUrl:"controllers/login/edit-password/editPassword.html",controller:"EditPasswordController",controllerAs:"vm",backdrop:"static",size:"md"});e.result.then(function(){n.alert("密码修改成功")})})):void t.go("login")}]),angular.module("com.dcos.app").directive("layoutHeader",function(){return{restrict:"EA",replace:!0,scope:{},templateUrl:"directive/layout-header/header.html",controller:"LayoutHeaderController as vm"}}),angular.module("com.dcos.app").directive("layoutMenu",function(){return{restrict:"EA",replace:!0,scope:{},templateUrl:"directive/layout-menu/menu.html",controller:"LayoutMenuController as vm"}}),angular.module("com.dcos.app").controller("LayoutMenuController",["$scope","$state","$location","$rootScope","$cookies","LoginService",function(e,t,i,r,n,o){var a=this;if(a.location=i,a.token=n.getObject("token"),!a.token)return void t.go("login");a.currentRole=a.token.roles[0].name;var s=a.token.id,l=a.token.user.id;"super"==a.currentRole?o.getAllProjects().success(function(e){a.projects=e.projects,a.projects.unshift({name:"All",id:"*"})}):o.getUserProjects(l,s).success(function(e){a.projects=e.projects}),a.changeProject=function(e,t){if(e!=a.token.project.id)if("super"==a.currentRole){var i=a.token;i.project.name=t,i.project.id=e,n.putObject("token",i),window.location.reload()}else o.getTokens(e,s).then(function(e){var t=e.headers("x-subject-token"),i=e.data.token;i.id=t,n.putObject("token",i),window.location.reload()})},a.highLightMenu=function(){a.isOverviewActive=t.includes("home")||t.includes("default"),a.isSlaveActive=t.includes("slave"),a.isServiceActive=t.includes("service"),a.isLogActive=t.includes("log"),a.isMonitorActive=t.includes("monitor"),a.isSystemActive=t.includes("system"),a.isPackageActive=t.includes("package"),a.isPrivilegeActive=t.includes("privilege")},a.highLightMenu(),e.$on("$stateChangeSuccess",function(){a.highLightMenu()})}]),angular.module("com.dcos.app").controller("AppLayoutController",["$scope","$state","$rootScope","$location","$cookies",function(e,t,i,r,n){var o=this;o.showLogin=function(){return t.includes("login")},e.$on("unauthorized",function(){t.go("login")}),e.$on("$stateChangeSuccess",function(){n.getObject("token")||t.go("login")})}]),angular.module("com.dcos.app").directive("appLayout",function(){return{restrict:"EA",replace:!0,scope:{},templateUrl:"directive/layout/_layout.html",controller:"AppLayoutController as vm",link:function(e,t,i){$(t).siblings(".overlay").show()}}}),angular.module("com.dcos.app").directive("customPager",[function(){return{restrict:"EA",replace:!0,scope:{page:"=",pageSize:"=",itemLength:"="},templateUrl:"directive/pagination/pagination.html",link:function(e,t,i){t=$(t),e.changePagesize=function(){e.page=1,e.totalPage=Math.ceil(e.itemLength/e.pageSize),e.pageArr=[];for(var t=1;t<=e.totalPage;t++)e.pageArr.push(t)},e.totalPage=Math.ceil(e.itemLength/e.pageSize),e.pageArr=[];for(var r=1;r<=e.totalPage;r++)e.pageArr.push(r);t.find(".previous-page").click(function(){e.$apply(function(){1!=e.page&&(e.page-=1)})}),t.find(".next-page").click(function(){e.$apply(function(){e.page!=e.totalPage&&(e.page+=1)})})}}}]),angular.module("com.dcos.app").directive("customSelect",["$document",function(e){return{restrict:"EA",replace:!0,transclude:!0,scope:{selectValue:"=ngModel",changeValue:"&ngChange"},template:'<div class="select-box" ng-click="toggleSelect($event)"><span class="select-text">{{selectText}}</span><span class="select-arrow-down"></span><div class="option-panel" ng-show="showMe" ng-click="$event.stopPropagation()" ng-transclude></div></div>',link:function(t,i,r){t.showMe=!1,t.selectText="",t.toggleSelect=function(e){e.stopPropagation(),t.showMe=!t.showMe},e.on("click",function(){t.showMe=!1,t.$apply()})}}}]).directive("selectOption",function(){return{restrict:"EA",link:function(e,t,i){var r=e.$parent.$parent.selectValue,n=i.value;if(i.key)var o=i.key;else var o=n;r&&r==n?(e.$parent.$parent.selectText=o,t.addClass("active")):r||0!=t.index()||(e.$parent.$parent.selectText=o,t.addClass("active")),t.bind("click",function(i){e.$parent.$parent.selectText!=t.text()&&(e.$parent.$parent.selectText=t.text(),t.addClass("active"),e.$parent.$parent.selectValue=n,e.$apply(),e.$parent.$parent.changeValue&&e.$parent.$parent.changeValue()),e.$parent.$parent.showMe=!1}),t.hover(function(){t.siblings().removeClass("active"),t.addClass("active")})}}}),angular.module("com.dcos.app").directive("customSort",function(){return{restrict:"EA",scope:{sortKey:"=",reverse:"="},link:function(e,t,i){t=$(t),t.on("click",function(){e.sortKey=i.customSort,t.hasClass("sort-asc")||t.hasClass("sort-desc")?t.hasClass("sort-asc")?(t.removeClass("sort-asc").addClass("sort-desc"),e.reverse=!0):t.hasClass("sort-desc")&&(t.removeClass("sort-desc").addClass("sort-asc"),e.reverse=!1):(t.siblings().removeClass("sort-asc").removeClass("sort-desc"),t.addClass("sort-asc"),e.reverse=!1),e.$apply()})}}}),angular.module("com.dcos.app").directive("uiTreeSelectNode",["$http","$q",function(e,t){return{restrict:"E",scope:{model:"=",parentItems:"=",childItems:"="},link:function(e,t){e.isParent=!0,e.groups=e.parentItems,e.groups.length<1&&(e.isEmpty=!0,e.groups=["暂无主机"]),e.loadParentItems=function(t){t.search="",e.isParent=!0,e.groups=e.parentItems,e.$broadcast("uiSelectFocus")},e.loadChildItems=function(t,i,r){r.stopPropagation(),r.preventDefault(),i.search="",e.isParent=!1,e.groups=e.childItems[t],e.$broadcast("uiSelectFocus")}},templateUrl:"directive/ui-tree-select/uiTreeSelectNode.html"}}]).directive("uiTreeSelectLog",["$http","$q",function(e,t){return{restrict:"E",scope:{model:"=",parentItems:"=",childItems:"="},link:function(e,t){e.isParent=!0,e.groups=e.parentItems,e.groups.length<1&&(e.isEmpty=!0,e.groups=["暂无数据"]),e.loadParentItems=function(t){t.search="",e.isParent=!0,e.groups=e.parentItems,e.$broadcast("uiSelectFocus")},e.loadChildItems=function(t,i,r){r.stopPropagation(),r.preventDefault(),i.search="",e.isParent=!1,e.groups=e.childItems[t],e.$broadcast("uiSelectFocus")}},templateUrl:"directive/ui-tree-select/uiTreeSelectLog.html"}}]),angular.module("com.dcos.app").directive("nameDumplicate",function(){return{restrict:"EA",require:"ngModel",scope:{existedArr:"=nameDumplicate"},link:function(e,t,i,r){r.$parsers.push(function(t){var i=e.existedArr.indexOf(t);return-1==i?r.$setValidity("dumplicate",!0):r.$setValidity("dumplicate",!1),t})}}}),angular.module("com.dcos.app").filter("error",["Errors",function(e){return function(t,i){var r=angular.extend({},e,i);return r[t]||t}}]),angular.module("com.dcos.app").filter("objectFilter",function(){return function(e,t,i){var r=[];return angular.forEach(e,function(e,n){-1!=e[t].toLowerCase().indexOf(i.toLowerCase())&&r.push(e)}),r}}),angular.module("com.dcos.app").filter("page",function(){return function(e,t,i){if(!e)return e;if(1>t||0>=i)return[];var r=(t-1)*i,n=t*i;return e.slice(r,n)}}),angular.module("com.dcos.app").filter("tree",["tree",function(e){return function(t,i){return e.enhance(t,i),t}}]),function(){angular.module("angular-advanced-searchbox",[]).directive("nitAdvancedSearchbox",function(){return{restrict:"E",scope:{model:"=ngModel",parameters:"=",parametersLabel:"@",parametersDisplayLimit:"=?",placeholder:"@",searchThrottleTime:"=?"},replace:!0,templateUrl:function(e,t){return t.templateUrl||"angular-advanced-searchbox.html"},controller:["$scope","$attrs","$element","$timeout","$filter",function(e,t,i,r,n){function o(){angular.forEach(e.model,function(t,i){if("query"===i)e.searchQuery=t;else{var r=n("filter")(e.parameters,function(e){return e.key===i})[0];void 0!==r&&e.addSearchParam(r,t,!1)}})}function a(t,i,o){l&&r.cancel(l),c=n("filter")(c,function(e){return e.key!==i}),c.push({command:t,key:i,value:o}),angular.forEach(c,function(t){"delete"===t.command?delete e.model[t.key]:e.model[t.key]=t.value}),c.length=0,e.$emit("advanced-searchbox:modelUpdated",e.model)}function s(e){if(!e)return 0;try{if("number"==typeof e.selectionStart)return"backward"===e.selectionDirection?e.selectionStart:e.selectionEnd;if(document.selection){e.focus();var t=document.selection.createRange(),i=document.selection.createRange().text.length;return t.moveStart("character",-e.value.length),t.text.length-i}}catch(r){}return 0}e.parametersLabel=e.parametersLabel||"Parameter Suggestions",e.parametersDisplayLimit=e.parametersDisplayLimit||8,e.placeholder=e.placeholder||"Search ...",e.searchThrottleTime=e.searchThrottleTime||1e3,e.searchParams=[],e.searchQuery="",e.setSearchFocus=!1;var l,c=[];e.$watch("model",function(t,i){angular.equals(t,i)||(angular.forEach(e.model,function(t,i){if("query"===i&&e.searchQuery!==t)e.searchQuery=t;else{var r=n("filter")(e.parameters,function(e){return e.key===i})[0],o=n("filter")(e.searchParams,function(e){return e.key===i})[0];void 0!==r&&(void 0===o?e.addSearchParam(r,t,!1):o.value!==t&&(o.value=t))}}),angular.forEach(e.searchParams,function(t,i){if(!e.model.hasOwnProperty(t.key)){var r=e.searchParams.map(function(e){return e.key}).indexOf(t.key);e.removeSearchParam(r)}}))},!0),e.searchParamValueChanged=function(e){a("change",e.key,e.value)},e.searchQueryChanged=function(e){a("change","query",e)},e.enterEditMode=function(t,i){if(void 0!==t&&t.stopPropagation(),void 0!==i){var r=e.searchParams[i];r.editMode=!0,e.$emit("advanced-searchbox:enteredEditMode",r)}},e.leaveEditMode=function(t,i){if(void 0!==i){var r=e.searchParams[i];r.editMode=!1,e.$emit("advanced-searchbox:leavedEditMode",r),r.value||e.removeSearchParam(i),e.focus=!1}},e.searchQueryTypeaheadOnSelect=function(t,i,r){e.addSearchParam(t),e.searchQuery="",a("delete","query")},e.searchParamTypeaheadOnSelect=function(t,i){i.value=t,e.searchParamValueChanged(i)},e.isUnsedParameter=function(t,i){return 0===n("filter")(e.searchParams,function(e){return e.key===t.key}).length},e.addSearchParam=function(t,i,n){if(void 0===n&&(n=!0),e.isUnsedParameter(t)){var o=e.searchParams.push({key:t.key,name:t.name,type:t.type||"text",placeholder:t.placeholder,suggestedValues:t.suggestedValues||[],restrictToSuggestedValues:t.restrictToSuggestedValues||!1,value:i||""})-1;a("add",t.key,i),n===!0&&r(function(){e.enterEditMode(void 0,o)},100),e.$emit("advanced-searchbox:addedSearchParam",t)}},e.removeSearchParam=function(t){if(void 0!==t){var i=e.searchParams[t];e.searchParams.splice(t,1),a("delete",i.key),e.$emit("advanced-searchbox:removedSearchParam",i)}},e.removeAll=function(){e.searchParams.length=0,e.searchQuery="",e.model={},e.$emit("advanced-searchbox:removedAllSearchParam")},e.editPrevious=function(t){void 0!==t&&e.leaveEditMode(void 0,t),t>0?e.enterEditMode(void 0,t-1):e.searchParams.length>0&&e.enterEditMode(void 0,e.searchParams.length-1)},e.editNext=function(t){void 0!==t&&(e.leaveEditMode(void 0,t),t<e.searchParams.length-1?e.enterEditMode(void 0,t+1):e.setSearchFocus=!0)},e.keydown=function(t,i){var r=[8,9,13,37,39];if(-1!==r.indexOf(t.which)){var n=s(t.target);8==t.which?0===n&&(t.preventDefault(),e.editPrevious(i)):9==t.which?t.shiftKey?(t.preventDefault(),e.editPrevious(i)):(t.preventDefault(),e.editNext(i)):13==t.which?e.editNext(i):37==t.which?0===n&&e.editPrevious(i):39==t.which&&n===t.target.value.length&&e.editNext(i)}},void 0===e.model?e.model={}:o()}]}}).directive("nitSetFocus",["$timeout","$parse",function(e,t){return{restrict:"A",link:function(i,r,n){var o=t(n.nitSetFocus);i.$watch(o,function(t){t===!0&&e(function(){r[0].focus()})})}}}]).directive("nitAutoSizeInput",["$timeout",function(e){return{restrict:"A",scope:{model:"=ngModel"},link:function(t,i,r){function n(){e(function(){-1!==o.indexOf(i[0].type||"text")&&(s.text(i.val()||i.attr("placeholder")),i.css("width",s.outerWidth()+10))})}var o=["text","search","tel","url","email","password","number"],a=angular.element('<div style="position: fixed; top: -9999px; left: 0px;"></div>'),s=angular.element('<span style="white-space:pre;"></span>'),l="none"===i.css("maxWidth")?i.parent().innerWidth():i.css("maxWidth");i.css("maxWidth",l),angular.forEach(["fontSize","fontFamily","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","boxSizing","borderLeftWidth","borderRightWidth","borderLeftStyle","borderRightStyle","paddingLeft","paddingRight","marginLeft","marginRight"],function(e){s.css(e,i.css(e))}),angular.element("body").append(a.append(s)),n(),t.model?t.$watch("model",function(){n()}):i.on("keypress keyup keydown focus input propertychange change",function(){n()})}}}])}(),angular.module("angular-advanced-searchbox").run(["$templateCache",function(e){e.put("angular-advanced-searchbox.html",'<div class=advancedSearchBox ng-class={active:focus} ng-init="focus = false" ng-click="!focus ? setSearchFocus = true : null"><a ng-href="" ng-show="searchParams.length > 0 || searchQuery.length > 0" ng-click=removeAll() role=button><span class="remove-all-icon glyphicon glyphicon-trash"></span></a><div class="search-wrap" ng-click="focus=!focus" ng-blur="focus=false"><div class=search-parameter ng-repeat="searchParam in searchParams"><a ng-href="" ng-click=removeSearchParam($index) role=button><span class="remove glyphicon glyphicon-trash"></span></a><div class=key data-key={{searchParam.key}} ng-click="enterEditMode($event, $index)">{{searchParam.name}}:</div><div class=value><input name=value type={{searchParam.type}} nit-auto-size-input nit-set-focus=searchParam.editMode ng-keydown="keydown($event, $index)" ng-blur="leaveEditMode($event, $index)" ng-change="searchParam.restrictToSuggestedValues !== true ? searchParamValueChanged(searchParam) : null" ng-model=searchParam.value uib-typeahead="suggestedValue for suggestedValue in searchParam.suggestedValues | filter:$viewValue" typeahead-min-length=0 typeahead-on-select="searchParamTypeaheadOnSelect($item, searchParam)" typeahead-editable="searchParam.restrictToSuggestedValues !== true" typeahead-select-on-exact=true typeahead-select-on-blur="searchParam.restrictToSuggestedValues !== true ? false : true" placeholder="{{searchParam.placeholder}}"></div></div><input name=searchbox readonly class=search-parameter-input nit-auto-size-input nit-set-focus=setSearchFocus ng-keydown=keydown($event) ng-focus="focus = true" ng-blur="focus = false" uib-typeahead="parameter as parameter.name for parameter in parameters | filter:isUnsedParameter | filter:{name:$viewValue} | limitTo:parametersDisplayLimit" typeahead-on-select="searchQueryTypeaheadOnSelect($item, $model, $label)" ng-change=searchQueryChanged(searchQuery) ng-model="searchQuery"></div><div class=search-parameter-suggestions ng-show="parameters && focus"><span class=title>{{parametersLabel}}:</span> <span class=search-parameter ng-repeat="param in parameters | filter:isUnsedParameter | limitTo:parametersDisplayLimit" data-key={{param.key}} ng-mousedown=addSearchParam(param)>{{param.name}}</span></div></div>')}]),angular.module("ngLocale",[],["$provide",function(e){var t={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};e.value("$locale",{DATETIME_FORMATS:{AMPMS:["上午","下午"],DAY:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],MONTH:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],SHORTDAY:["周日","周一","周二","周三","周四","周五","周六"],SHORTMONTH:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"y年M月d日 ah:mm:ss",mediumDate:"yyyy-MM-dd",mediumTime:"ah:mm:ss","short":"yy/M/d ah:mm",shortDate:"yy/M/d",shortTime:"ah:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"¥",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:2,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" 元",posPre:"",posSuf:" 元"}]},id:"zh-cn",pluralCat:function(e,i){return t.OTHER}})}]),function(e,t){"object"==typeof module&&module.exports?module.exports=e.document?t(e):t:e.Highcharts=t(e)}("undefined"!=typeof window?window:this,function(e){function t(t,i){var r="Highcharts error #"+t+": www.highcharts.com/errors/"+t;if(i)throw Error(r);e.console&&console.log(r)}function i(e,t,i){this.options=t,this.elem=e,this.prop=i}function r(){var e,t,i=arguments,r={},n=function(e,t){var i,r;"object"!=typeof e&&(e={});for(r in t)t.hasOwnProperty(r)&&(i=t[r],e[r]=i&&"object"==typeof i&&"[object Array]"!==Object.prototype.toString.call(i)&&"renderTo"!==r&&"number"!=typeof i.nodeType?n(e[r]||{},i):t[r]);return e};for(i[0]===!0&&(r=i[1],i=Array.prototype.slice.call(i,2)),t=i.length,e=0;t>e;e++)r=n(r,i[e]);return r}function n(e,t){return parseInt(e,t||10)}function o(e){return"string"==typeof e}function a(e){return e&&"object"==typeof e}function s(e){return"[object Array]"===Object.prototype.toString.call(e)}function l(e,t){for(var i=e.length;i--;)if(e[i]===t){e.splice(i,1);break}}function c(e){return e!==O&&null!==e}function d(e,t,i){var r,n;if(o(t))c(i)?e.setAttribute(t,i):e&&e.getAttribute&&(n=e.getAttribute(t));else if(c(t)&&a(t))for(r in t)e.setAttribute(r,t[r]);return n}function h(e){return s(e)?e:[e]}function u(e,t,i){return t?setTimeout(e,t,i):void e.call(0,i)}function p(e,t){ke&&!we&&t&&t.opacity!==O&&(t.filter="alpha(opacity="+100*t.opacity+")"),Ve(e.style,t)}function g(e,t,i,r,n){return e=oe.createElement(e),t&&Ve(e,t),n&&p(e,{padding:0,border:"none",margin:0}),i&&p(e,i),r&&r.appendChild(e),e}function f(e,t){var i=function(){};return i.prototype=new e,Ve(i.prototype,t),i}function m(e,t,i){return Array((t||2)+1-String(e).length).join(i||0)+e}function v(e){return 6e4*(G&&G(e)||U||0)}function y(e,t){for(var i,r,n,o,a,s="{",l=!1,c=[];-1!==(s=e.indexOf(s));){if(i=e.slice(0,s),l){for(r=i.split(":"),n=r.shift().split("."),a=n.length,i=t,o=0;a>o;o++)i=i[n[o]];r.length&&(r=r.join(":"),n=/\.([0-9])/,o=z.lang,a=void 0,/f$/.test(r)?(a=(a=r.match(n))?a[1]:-1,null!==i&&(i=ne.numberFormat(i,a,o.decimalPoint,r.indexOf(",")>-1?o.thousandsSep:""))):i=F(r,i))}c.push(i),e=e.slice(s+1),s=(l=!l)?"}":"{"}return c.push(e),c.join("")}function k(e){return ae.pow(10,le(ae.log(e)/ae.LN10))}function b(e,t,i,r,n){var o,a=e,i=Ze(i,1);for(o=e/i,t||(t=[1,2,2.5,5,10],r===!1&&(1===i?t=[1,2,5,10]:.1>=i&&(t=[1/i]))),r=0;r<t.length&&(a=t[r],!(n&&a*i>=e||!n&&o<=(t[r]+(t[r+1]||t[r]))/2));r++);return a*=i}function C(e,t){var i,r,n=e.length;for(r=0;n>r;r++)e[r].safeI=r;for(e.sort(function(e,r){return i=t(e,r),0===i?e.safeI-r.safeI:i}),r=0;n>r;r++)delete e[r].safeI}function x(e){for(var t=e.length,i=e[0];t--;)e[t]<i&&(i=e[t]);return i}function S(e){for(var t=e.length,i=e[0];t--;)e[t]>i&&(i=e[t]);return i}function T(e,t){for(var i in e)e[i]&&e[i]!==t&&e[i].destroy&&e[i].destroy(),delete e[i]}function w(e){j||(j=g(De)),e&&j.appendChild(e),j.innerHTML=""}function P(e,t){return parseFloat(e.toPrecision(t||14))}function N(e,t){t.renderer.globalAnimation=Ze(e,t.animation)}function L(e){return a(e)?r(e):{duration:e?500:0}}function I(){var t=z.global,i=t.useUTC,r=i?"getUTC":"get",n=i?"setUTC":"set";H=t.Date||e.Date,U=i&&t.timezoneOffset,G=i&&t.getTimezoneOffset,B=function(e,t,r,n,o,a){var s;return i?(s=H.UTC.apply(0,arguments),s+=v(s)):s=new H(e,t,Ze(r,1),Ze(n,0),Ze(o,0),Ze(a,0)).getTime(),s},Y=r+"Minutes",W=r+"Hours",X=r+"Day",q=r+"Date",V=r+"Month",K=r+"FullYear",Z=n+"Milliseconds",J=n+"Seconds",Q=n+"Minutes",ee=n+"Hours",te=n+"Date",ie=n+"Month",re=n+"FullYear"}function A(e){return this instanceof A?void this.init(e):new A(e)}function M(){}function E(e,t,i,r){this.axis=e,this.pos=t,this.type=i||"",this.isNew=!0,!i&&!r&&this.addLabel()}function D(e,t,i,r,n){var o=e.chart.inverted;this.axis=e,this.isNegative=i,this.options=t,this.x=r,this.total=null,this.points={},this.stack=n,this.rightCliff=this.leftCliff=0,this.alignOptions={align:t.align||(o?i?"left":"right":"center"),verticalAlign:t.verticalAlign||(o?"middle":i?"bottom":"top"),y:Ze(t.y,o?4:i?14:-6),x:Ze(t.x,o?i?-6:6:0)},this.textAlign=t.textAlign||(o?i?"right":"left":"center")}var O,R,_,j,z,F,$,H,B,U,G,Y,W,X,q,V,K,Z,J,Q,ee,te,ie,re,ne,oe=e.document,ae=Math,se=ae.round,le=ae.floor,ce=ae.ceil,de=ae.max,he=ae.min,ue=ae.abs,pe=ae.cos,ge=ae.sin,fe=ae.PI,me=2*fe/360,ve=e.navigator&&e.navigator.userAgent||"",ye=e.opera,ke=/(msie|trident|edge)/i.test(ve)&&!ye,be=oe&&8===oe.documentMode,Ce=!ke&&/AppleWebKit/.test(ve),xe=/Firefox/.test(ve),Se=/(Mobile|Android|Windows Phone)/.test(ve),Te="http://www.w3.org/2000/svg",we=oe&&oe.createElementNS&&!!oe.createElementNS(Te,"svg").createSVGRect,Pe=xe&&parseInt(ve.split("Firefox/")[1],10)<4,Ne=oe&&!we&&!ke&&!!oe.createElement("canvas").getContext,Le={},Ie=0,Ae=function(){},Me=[],Ee=0,De="div",Oe=/^[0-9]+$/,Re=["plotTop","marginRight","marginBottom","plotLeft"],_e={};ne=e.Highcharts?t(16,!0):{win:e},ne.seriesTypes=_e;var je,ze,Fe,$e,He,Be,Ue,Ge,Ye,We,Xe,qe=[];i.prototype={dSetter:function(){var e,t=this.paths[0],i=this.paths[1],r=[],n=this.now,o=t.length;if(1===n)r=this.toD;else if(o===i.length&&1>n)for(;o--;)e=parseFloat(t[o]),r[o]=isNaN(e)?t[o]:n*parseFloat(i[o]-e)+e;else r=i;this.elem.attr("d",r)},update:function(){var e=this.elem,t=this.prop,i=this.now,r=this.options.step;this[t+"Setter"]?this[t+"Setter"]():e.attr?e.element&&e.attr(t,i):e.style[t]=i+this.unit,r&&r.call(e,i,this)},run:function(e,t,i){var r,n=this,o=function(e){return o.stopped?!1:n.step(e)};this.startTime=+new H,this.start=e,this.end=t,this.unit=i,this.now=this.start,this.pos=0,o.elem=this.elem,o()&&1===qe.push(o)&&(o.timerId=setInterval(function(){for(r=0;r<qe.length;r++)qe[r]()||qe.splice(r--,1);qe.length||clearInterval(o.timerId)},13))},step:function(e){var t,i=+new H,r=this.options;t=this.elem;var n,o=r.complete,a=r.duration,s=r.curAnim;if(t.attr&&!t.element)t=!1;else if(e||i>=a+this.startTime){this.now=this.end,this.pos=1,this.update(),e=s[this.prop]=!0;for(n in s)s[n]!==!0&&(e=!1);e&&o&&o.call(t),t=!1}else this.pos=r.easing((i-this.startTime)/a),this.now=this.start+(this.end-this.start)*this.pos,this.update(),t=!0;return t},initPath:function(e,t,i){var r,t=t||"",n=e.shift,o=t.indexOf("C")>-1,a=o?7:3,t=t.split(" "),i=[].concat(i),s=e.isArea,l=s?2:1,c=function(e){for(r=e.length;r--;)("M"===e[r]||"L"===e[r])&&e.splice(r+1,0,e[r+1],e[r+2],e[r+1],e[r+2])};if(o&&(c(t),c(i)),n<=i.length/a&&t.length===i.length)for(;n--;)i=i.slice(0,a).concat(i),s&&(i=i.concat(i.slice(i.length-a)));if(e.shift=0,t.length)for(e=i.length;t.length<e;)n=t.slice().splice(t.length/l-a,a*l),o&&(n[a-6]=n[a-2],n[a-5]=n[a-1]),[].splice.apply(t,[t.length/l,0].concat(n));return[t,i]}};var Ve=ne.extend=function(e,t){var i;e||(e={});for(i in t)e[i]=t[i];return e},Ke=ne.isNumber=function(e){return"number"==typeof e&&!isNaN(e)},Ze=ne.pick=function(){var e,t,i=arguments,r=i.length;for(e=0;r>e;e++)if(t=i[e],t!==O&&null!==t)return t},Je=ne.wrap=function(e,t,i){var r=e[t];e[t]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(r),i.apply(this,e)}};F=function(e,t,i){if(!Ke(t))return z.lang.invalidDate||"";var r,e=Ze(e,"%Y-%m-%d %H:%M:%S"),n=new H(t-v(t)),o=n[W](),a=n[X](),s=n[q](),l=n[V](),c=n[K](),d=z.lang,h=d.weekdays,u=d.shortWeekdays,n=Ve({a:u?u[a]:h[a].substr(0,3),
A:h[a],d:m(s),e:m(s,2," "),w:a,b:d.shortMonths[l],B:d.months[l],m:m(l+1),y:c.toString().substr(2,2),Y:c,H:m(o),k:o,I:m(o%12||12),l:o%12||12,M:m(n[Y]()),p:12>o?"AM":"PM",P:12>o?"am":"pm",S:m(n.getSeconds()),L:m(se(t%1e3),3)},ne.dateFormats);for(r in n)for(;-1!==e.indexOf("%"+r);)e=e.replace("%"+r,"function"==typeof n[r]?n[r](t):n[r]);return i?e.substr(0,1).toUpperCase()+e.substr(1):e},$={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},ne.numberFormat=function(e,t,i,r){var o,a,e=+e||0,t=+t,s=z.lang,l=(e.toString().split(".")[1]||"").length,c=Math.abs(e);return-1===t?t=Math.min(l,20):Ke(t)||(t=2),o=String(n(c.toFixed(t))),a=o.length>3?o.length%3:0,i=Ze(i,s.decimalPoint),r=Ze(r,s.thousandsSep),e=0>e?"-":"",e+=a?o.substr(0,a)+r:"",e+=o.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+r),t&&(r=Math.abs(c-o+Math.pow(10,-Math.max(t,l)-1)),e+=i+r.toFixed(t).slice(2)),e},Math.easeInOutSine=function(e){return-.5*(Math.cos(Math.PI*e)-1)},je=function(t,i){var r;return"width"===i?Math.min(t.offsetWidth,t.scrollWidth)-je(t,"padding-left")-je(t,"padding-right"):"height"===i?Math.min(t.offsetHeight,t.scrollHeight)-je(t,"padding-top")-je(t,"padding-bottom"):(r=e.getComputedStyle(t,void 0))&&n(r.getPropertyValue(i))},ze=function(e,t){return t.indexOf?t.indexOf(e):[].indexOf.call(t,e)},$e=function(e,t){return[].filter.call(e,t)},Be=function(e,t){for(var i=[],r=0,n=e.length;n>r;r++)i[r]=t.call(e[r],e[r],r,e);return i},He=function(t){var i=oe.documentElement,t=t.getBoundingClientRect();return{top:t.top+(e.pageYOffset||i.scrollTop)-(i.clientTop||0),left:t.left+(e.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}},Xe=function(e){for(var t=qe.length;t--;)qe[t].elem===e&&(qe[t].stopped=!0)},Fe=function(e,t){return Array.prototype.forEach.call(e,t)},Ue=function(t,i,r){function n(i){i.target=i.srcElement||e,r.call(t,i)}var o=t.hcEvents=t.hcEvents||{};t.addEventListener?t.addEventListener(i,r,!1):t.attachEvent&&(t.hcEventsIE||(t.hcEventsIE={}),t.hcEventsIE[r.toString()]=n,t.attachEvent("on"+i,n)),o[i]||(o[i]=[]),o[i].push(r)},Ge=function(e,t,i){function r(t,i){e.removeEventListener?e.removeEventListener(t,i,!1):e.attachEvent&&(i=e.hcEventsIE[i.toString()],e.detachEvent("on"+t,i))}function n(){var i,n,o;if(e.nodeName)for(o in t?(i={},i[t]=!0):i=s,i)if(s[o])for(n=s[o].length;n--;)r(o,s[o][n])}var o,a,s=e.hcEvents;s&&(t?(o=s[t]||[],i?(a=ze(i,o),a>-1&&(o.splice(a,1),s[t]=o),r(t,i)):(n(),s[t]=[])):(n(),e.hcEvents={}))},Ye=function(e,t,i,r){var n;n=e.hcEvents;var o,a,i=i||{};if(oe.createEvent&&(e.dispatchEvent||e.fireEvent))n=oe.createEvent("Events"),n.initEvent(t,!0,!0),n.target=e,Ve(n,i),e.dispatchEvent?e.dispatchEvent(n):e.fireEvent(t,n);else if(n)for(n=n[t]||[],o=n.length,i.preventDefault||(i.preventDefault=function(){i.defaultPrevented=!0}),i.target=e,i.type||(i.type=t),t=0;o>t;t++)a=n[t],a.call(e,i)===!1&&i.preventDefault();r&&!i.defaultPrevented&&r(i)},We=function(e,t,n){var o,s,l,c,d="";a(n)||(o=arguments,n={duration:o[2],easing:o[3],complete:o[4]}),Ke(n.duration)||(n.duration=400),n.easing="function"==typeof n.easing?n.easing:Math[n.easing]||Math.easeInOutSine,n.curAnim=r(t);for(c in t)l=new i(e,n,c),s=null,"d"===c?(l.paths=l.initPath(e,e.d,t.d),l.toD=t.d,o=0,s=1):e.attr?o=e.attr(c):(o=parseFloat(je(e,c))||0,"opacity"!==c&&(d="px")),s||(s=t[c]),s.match&&s.match("px")&&(s=s.replace(/px/g,"")),l.run(o,s,d)},e.jQuery&&(e.jQuery.fn.highcharts=function(){var e=[].slice.call(arguments);return this[0]?e[0]?(new(ne[o(e[0])?e.shift():"Chart"])(this[0],e[0],e[1]),this):Me[d(this[0],"data-highcharts-chart")]:void 0}),oe&&!oe.defaultView&&(je=function(e,t){var i;return i={width:"clientWidth",height:"clientHeight"}[t],e.style[t]?n(e.style[t]):("opacity"===t&&(t="filter"),i?(e.style.zoom=1,Math.max(e[i]-2*je(e,"padding"),0)):(i=e.currentStyle[t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()})],"filter"===t&&(i=i.replace(/alpha\(opacity=([0-9]+)\)/,function(e,t){return t/100})),""===i?1:n(i)))}),Array.prototype.forEach||(Fe=function(e,t){for(var i=0,r=e.length;r>i;i++)if(t.call(e[i],e[i],i,e)===!1)return i}),Array.prototype.indexOf||(ze=function(e,t){var i,r=0;if(t)for(i=t.length;i>r;r++)if(t[r]===e)return r;return-1}),Array.prototype.filter||($e=function(e,t){for(var i=[],r=0,n=e.length;n>r;r++)t(e[r],r)&&i.push(e[r]);return i}),ne.Fx=i,ne.inArray=ze,ne.each=Fe,ne.grep=$e,ne.offset=He,ne.map=Be,ne.addEvent=Ue,ne.removeEvent=Ge,ne.fireEvent=Ye,ne.animate=We,ne.animObject=L,ne.stop=Xe,z={colors:"#7cb5ec,#434348,#90ed7d,#f7a35c,#8085e9,#f15c80,#e4d354,#2b908f,#f45b5b,#91e8e1".split(","),symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),decimalPoint:".",numericSymbols:"k,M,G,T,P,E".split(","),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{useUTC:!0,canvasToolsURL:"http://code.highcharts.com/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/4.2.5/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#333333",fontSize:"18px"},widthAdjust:-44},subtitle:{text:"",align:"center",style:{color:"#555555"},widthAdjust:-44},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:{lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0,lineWidthPlus:1,radiusPlus:2},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){return null===this.y?"":ne.numberFormat(this.y,-1)},style:{color:"contrast",fontSize:"11px",fontWeight:"bold",textShadow:"0 0 6px contrast, 0 0 3px contrast"},verticalAlign:"bottom",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,softThreshold:!0,states:{hover:{lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1e3}},labels:{style:{position:"absolute",color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#909090",borderRadius:0,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{color:"#333333",fontSize:"12px",fontWeight:"bold"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"white",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:we,backgroundColor:"rgba(249, 249, 249, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,snap:Se?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",pointerEvents:"none",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var Qe=z.plotOptions,et=Qe.line;I(),A.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(e){return[n(e[1]),n(e[2]),n(e[3]),parseFloat(e[4],10)]}},{regex:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(e){return[n(e[1],16),n(e[2],16),n(e[3],16),1]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(e){return[n(e[1]),n(e[2]),n(e[3]),1]}}],init:function(e){var t,i,r,n;if((this.input=e)&&e.stops)this.stops=Be(e.stops,function(e){return new A(e[1])});else for(r=this.parsers.length;r--&&!i;)n=this.parsers[r],(t=n.regex.exec(e))&&(i=n.parse(t));this.rgba=i||[]},get:function(e){var t,i=this.input,n=this.rgba;return this.stops?(t=r(i),t.stops=[].concat(t.stops),Fe(this.stops,function(i,r){t.stops[r]=[t.stops[r][0],i.get(e)]})):t=n&&Ke(n[0])?"rgb"===e||!e&&1===n[3]?"rgb("+n[0]+","+n[1]+","+n[2]+")":"a"===e?n[3]:"rgba("+n.join(",")+")":i,t},brighten:function(e){var t,i=this.rgba;if(this.stops)Fe(this.stops,function(t){t.brighten(e)});else if(Ke(e)&&0!==e)for(t=0;3>t;t++)i[t]+=n(255*e),i[t]<0&&(i[t]=0),i[t]>255&&(i[t]=255);return this},setOpacity:function(e){return this.rgba[3]=e,this}},M.prototype={opacity:1,textProps:"direction,fontSize,fontWeight,fontFamily,fontStyle,color,lineHeight,width,textDecoration,textOverflow,textShadow".split(","),init:function(e,t){this.element="span"===t?g(t):oe.createElementNS(Te,t),this.renderer=e},animate:function(e,t,i){return t=Ze(t,this.renderer.globalAnimation,!0),Xe(this),t?(i&&(t.complete=i),We(this,e,t)):this.attr(e,null,i),this},colorGradient:function(e,t,i){var n,o,a,l,d,h,u,p,g,f,m,v,y=this.renderer,k=[];if(e.linearGradient?o="linearGradient":e.radialGradient&&(o="radialGradient"),o){a=e[o],d=y.gradients,u=e.stops,f=i.radialReference,s(a)&&(e[o]=a={x1:a[0],y1:a[1],x2:a[2],y2:a[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===o&&f&&!c(a.gradientUnits)&&(l=a,a=r(a,y.getRadialAttr(f,l),{gradientUnits:"userSpaceOnUse"}));for(m in a)"id"!==m&&k.push(m,a[m]);for(m in u)k.push(u[m]);k=k.join(","),d[k]?f=d[k].attr("id"):(a.id=f="highcharts-"+Ie++,d[k]=h=y.createElement(o).attr(a).add(y.defs),h.radAttr=l,h.stops=[],Fe(u,function(e){0===e[1].indexOf("rgba")?(n=A(e[1]),p=n.get("rgb"),g=n.get("a")):(p=e[1],g=1),e=y.createElement("stop").attr({offset:e[0],"stop-color":p,"stop-opacity":g}).add(h),h.stops.push(e)})),v="url("+y.url+"#"+f+")",i.setAttribute(t,v),i.gradient=k,e.toString=function(){return v}}},applyTextShadow:function(e){var t,i=this.element,r=-1!==e.indexOf("contrast"),o={},a=this.renderer.forExport,s=a||i.style.textShadow!==O&&!ke;r&&(o.textShadow=e=e.replace(/contrast/g,this.renderer.getContrast(i.style.fill))),(Ce||a)&&(o.textRendering="geometricPrecision"),s?this.css(o):(this.fakeTS=!0,this.ySetter=this.xSetter,t=[].slice.call(i.getElementsByTagName("tspan")),Fe(e.split(/\s?,\s?/g),function(e){var r,o,a=i.firstChild,e=e.split(" ");r=e[e.length-1],(o=e[e.length-2])&&Fe(t,function(e,t){var s;0===t&&(e.setAttribute("x",i.getAttribute("x")),t=i.getAttribute("y"),e.setAttribute("y",t||0),null===t&&i.setAttribute("y",0)),s=e.cloneNode(1),d(s,{"class":"highcharts-text-shadow",fill:r,stroke:r,"stroke-opacity":1/de(n(o),3),"stroke-width":o,"stroke-linejoin":"round"}),i.insertBefore(s,a)})}))},attr:function(e,t,i){var r,n,o,a=this.element,s=this;if("string"==typeof e&&t!==O&&(r=e,e={},e[r]=t),"string"==typeof e)s=(this[e+"Getter"]||this._defaultGetter).call(this,e,a);else{for(r in e)t=e[r],o=!1,this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(r)&&(n||(this.symbolAttr(e),n=!0),o=!0),!this.rotation||"x"!==r&&"y"!==r||(this.doTransform=!0),o||(o=this[r+"Setter"]||this._defaultSetter,o.call(this,t,r,a),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(r)&&this.updateShadows(r,t,o));this.doTransform&&(this.updateTransform(),this.doTransform=!1)}return i&&i(),s},updateShadows:function(e,t,i){for(var r=this.shadows,n=r.length;n--;)i.call(r[n],"height"===e?Math.max(t-(r[n].cutHeight||0),0):"d"===e?this.d:t,e,r[n])},addClass:function(e){var t=this.element,i=d(t,"class")||"";return-1===i.indexOf(e)&&d(t,"class",i+" "+e),this},symbolAttr:function(e){var t=this;Fe("x,y,r,start,end,width,height,innerR,anchorX,anchorY".split(","),function(i){t[i]=Ze(e[i],t[i])}),t.attr({d:t.renderer.symbols[t.symbolName](t.x,t.y,t.width,t.height,t)})},clip:function(e){return this.attr("clip-path",e?"url("+this.renderer.url+"#"+e.id+")":"none")},crisp:function(e){var t,i,r={},n=this.strokeWidth||0;i=se(n)%2/2,e.x=le(e.x||this.x||0)+i,e.y=le(e.y||this.y||0)+i,e.width=le((e.width||this.width||0)-2*i),e.height=le((e.height||this.height||0)-2*i),e.strokeWidth=n;for(t in e)this[t]!==e[t]&&(this[t]=r[t]=e[t]);return r},css:function(e){var t,i,r=this.styles,o={},a=this.element,s="";if(t=!r,e&&e.color&&(e.fill=e.color),r)for(i in e)e[i]!==r[i]&&(o[i]=e[i],t=!0);if(t){if(t=this.textWidth=e&&e.width&&"text"===a.nodeName.toLowerCase()&&n(e.width)||this.textWidth,r&&(e=Ve(r,o)),this.styles=e,t&&(Ne||!we&&this.renderer.forExport)&&delete e.width,ke&&!we)p(this.element,e);else{r=function(e,t){return"-"+t.toLowerCase()};for(i in e)s+=i.replace(/([A-Z])/g,r)+":"+e[i]+";";d(a,"style",s)}t&&this.added&&this.renderer.buildText(this)}return this},on:function(e,t){var i=this,r=i.element;return _&&"click"===e?(r.ontouchstart=function(e){i.touchEventFired=H.now(),e.preventDefault(),t.call(r,e)},r.onclick=function(e){(-1===ve.indexOf("Android")||H.now()-(i.touchEventFired||0)>1100)&&t.call(r,e)}):r["on"+e]=t,this},setRadialReference:function(e){var t=this.renderer.gradients[this.element.gradient];return this.element.radialReference=e,t&&t.radAttr&&t.animate(this.renderer.getRadialAttr(e,t.radAttr)),this},translate:function(e,t){return this.attr({translateX:e,translateY:t})},invert:function(){return this.inverted=!0,this.updateTransform(),this},updateTransform:function(){var e=this.translateX||0,t=this.translateY||0,i=this.scaleX,r=this.scaleY,n=this.inverted,o=this.rotation,a=this.element;n&&(e+=this.attr("width"),t+=this.attr("height")),e=["translate("+e+","+t+")"],n?e.push("rotate(90) scale(-1,1)"):o&&e.push("rotate("+o+" "+(a.getAttribute("x")||0)+" "+(a.getAttribute("y")||0)+")"),(c(i)||c(r))&&e.push("scale("+Ze(i,1)+" "+Ze(r,1)+")"),e.length&&a.setAttribute("transform",e.join(" "))},toFront:function(){var e=this.element;return e.parentNode.appendChild(e),this},align:function(e,t,i){var r,n,a,s,c={};return n=this.renderer,a=n.alignedObjects,e?(this.alignOptions=e,this.alignByTranslate=t,(!i||o(i))&&(this.alignTo=r=i||"renderer",l(a,this),a.push(this),i=null)):(e=this.alignOptions,t=this.alignByTranslate,r=this.alignTo),i=Ze(i,n[r],n),r=e.align,n=e.verticalAlign,a=(i.x||0)+(e.x||0),s=(i.y||0)+(e.y||0),"right"!==r&&"center"!==r||(a+=(i.width-(e.width||0))/{right:1,center:2}[r]),c[t?"translateX":"x"]=se(a),"bottom"!==n&&"middle"!==n||(s+=(i.height-(e.height||0))/({bottom:1,middle:2}[n]||1)),c[t?"translateY":"y"]=se(s),this[this.placed?"animate":"attr"](c),this.placed=!0,this.alignAttr=c,this},getBBox:function(e,t){var i,r,n,o,a=this.renderer,s=this.element,l=this.styles;r=this.textStr;var c,d,h,u=s.style,p=a.cache,g=a.cacheKeys;if(n=Ze(t,this.rotation),o=n*me,r!==O&&(h=["",n||0,l&&l.fontSize,s.style.width].join(","),h=""===r||Oe.test(r)?"num:"+r.toString().length+h:r+h),h&&!e&&(i=p[h]),!i){if(s.namespaceURI===Te||a.forExport){try{d=this.fakeTS&&function(e){Fe(s.querySelectorAll(".highcharts-text-shadow"),function(t){t.style.display=e})},xe&&u.textShadow?(c=u.textShadow,u.textShadow=""):d&&d("none"),i=s.getBBox?Ve({},s.getBBox()):{width:s.offsetWidth,height:s.offsetHeight},c?u.textShadow=c:d&&d("")}catch(f){}(!i||i.width<0)&&(i={width:0,height:0})}else i=this.htmlGetBBox();if(a.isSVG&&(a=i.width,r=i.height,ke&&l&&"11px"===l.fontSize&&"16.9"===r.toPrecision(3)&&(i.height=r=14),n&&(i.width=ue(r*ge(o))+ue(a*pe(o)),i.height=ue(r*pe(o))+ue(a*ge(o)))),h){for(;g.length>250;)delete p[g.shift()];p[h]||g.push(h),p[h]=i}}return i},show:function(e){return this.attr({visibility:e?"inherit":"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(e){var t=this;t.animate({opacity:0},{duration:e||150,complete:function(){t.attr({y:-9999})}})},add:function(e){var t,i=this.renderer,r=this.element;return e&&(this.parentGroup=e),this.parentInverted=e&&e.inverted,void 0!==this.textStr&&i.buildText(this),this.added=!0,(!e||e.handleZ||this.zIndex)&&(t=this.zIndexSetter()),t||(e?e.element:i.box).appendChild(r),this.onAdd&&this.onAdd(),this},safeRemoveChild:function(e){var t=e.parentNode;t&&t.removeChild(e)},destroy:function(){var e,t,i=this,r=i.element||{},n=i.shadows,o=i.renderer.isSVG&&"SPAN"===r.nodeName&&i.parentGroup;if(r.onclick=r.onmouseout=r.onmouseover=r.onmousemove=r.point=null,Xe(i),i.clipPath&&(i.clipPath=i.clipPath.destroy()),i.stops){for(t=0;t<i.stops.length;t++)i.stops[t]=i.stops[t].destroy();i.stops=null}for(i.safeRemoveChild(r),n&&Fe(n,function(e){i.safeRemoveChild(e)});o&&o.div&&0===o.div.childNodes.length;)r=o.parentGroup,i.safeRemoveChild(o.div),delete o.div,o=r;i.alignTo&&l(i.renderer.alignedObjects,i);for(e in i)delete i[e];return null},shadow:function(e,t,i){var r,n,o,a,s,l,c=[],h=this.element;if(e){for(a=Ze(e.width,3),s=(e.opacity||.15)/a,l=this.parentInverted?"(-1,-1)":"("+Ze(e.offsetX,1)+", "+Ze(e.offsetY,1)+")",r=1;a>=r;r++)n=h.cloneNode(0),o=2*a+1-2*r,d(n,{isShadow:"true",stroke:e.color||"black","stroke-opacity":s*r,"stroke-width":o,transform:"translate"+l,fill:"none"}),i&&(d(n,"height",de(d(n,"height")-o,0)),n.cutHeight=o),t?t.element.appendChild(n):h.parentNode.insertBefore(n,h),c.push(n);this.shadows=c}return this},xGetter:function(e){return"circle"===this.element.nodeName&&(e={x:"cx",y:"cy"}[e]||e),this._defaultGetter(e)},_defaultGetter:function(e){return e=Ze(this[e],this.element?this.element.getAttribute(e):null,0),/^[\-0-9\.]+$/.test(e)&&(e=parseFloat(e)),e},dSetter:function(e,t,i){e&&e.join&&(e=e.join(" ")),/(NaN| {2}|^$)/.test(e)&&(e="M 0 0"),i.setAttribute(t,e),this[t]=e},dashstyleSetter:function(e){var t,i=this["stroke-width"];if("inherit"===i&&(i=1),e=e&&e.toLowerCase()){for(e=e.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(","),t=e.length;t--;)e[t]=n(e[t])*i;e=e.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",e)}},alignSetter:function(e){this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[e])},opacitySetter:function(e,t,i){this[t]=e,i.setAttribute(t,e)},titleSetter:function(e){var t=this.element.getElementsByTagName("title")[0];t||(t=oe.createElementNS(Te,"title"),this.element.appendChild(t)),t.firstChild&&t.removeChild(t.firstChild),t.appendChild(oe.createTextNode(String(Ze(e),"").replace(/<[^>]*>/g,"")))},textSetter:function(e){e!==this.textStr&&(delete this.bBox,this.textStr=e,this.added&&this.renderer.buildText(this))},fillSetter:function(e,t,i){"string"==typeof e?i.setAttribute(t,e):e&&this.colorGradient(e,t,i)},visibilitySetter:function(e,t,i){"inherit"===e?i.removeAttribute(t):i.setAttribute(t,e)},zIndexSetter:function(e,t){var i,r,o,a=this.renderer,s=this.parentGroup,a=(s||a).element||a.box,l=this.element;i=this.added;var d;if(c(e)&&(l.zIndex=e,e=+e,this[t]===e&&(i=!1),this[t]=e),i){for((e=this.zIndex)&&s&&(s.handleZ=!0),s=a.childNodes,d=0;d<s.length&&!o;d++)i=s[d],r=i.zIndex,i!==l&&(n(r)>e||!c(e)&&c(r))&&(a.insertBefore(l,i),o=!0);o||a.appendChild(l)}return o},_defaultSetter:function(e,t,i){i.setAttribute(t,e)}},M.prototype.yGetter=M.prototype.xGetter,M.prototype.translateXSetter=M.prototype.translateYSetter=M.prototype.rotationSetter=M.prototype.verticalAlignSetter=M.prototype.scaleXSetter=M.prototype.scaleYSetter=function(e,t){this[t]=e,this.doTransform=!0},M.prototype["stroke-widthSetter"]=M.prototype.strokeSetter=function(e,t,i){this[t]=e,this.stroke&&this["stroke-width"]?(this.strokeWidth=this["stroke-width"],M.prototype.fillSetter.call(this,this.stroke,"stroke",i),i.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0):"stroke-width"===t&&0===e&&this.hasStroke&&(i.removeAttribute("stroke"),this.hasStroke=!1)};var tt=function(){this.init.apply(this,arguments)};tt.prototype={Element:M,init:function(t,i,r,n,o,a){var s,n=this.createElement("svg").attr({version:"1.1"}).css(this.getStyle(n));s=n.element,t.appendChild(s),-1===t.innerHTML.indexOf("xmlns")&&d(s,"xmlns",Te),this.isSVG=!0,this.box=s,this.boxWrapper=n,this.alignedObjects=[],this.url=(xe||Ce)&&oe.getElementsByTagName("base").length?e.location.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",this.createElement("desc").add().element.appendChild(oe.createTextNode("Created with Highcharts 4.2.5")),this.defs=this.createElement("defs").add(),this.allowHTML=a,this.forExport=o,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.setSize(i,r,!1);var l;xe&&t.getBoundingClientRect&&(this.subPixelFix=i=function(){p(t,{left:0,top:0}),l=t.getBoundingClientRect(),p(t,{left:ce(l.left)-l.left+"px",top:ce(l.top)-l.top+"px"})},i(),Ue(e,"resize",i))},getStyle:function(e){return this.style=Ve({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},e)},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var t=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),T(this.gradients||{}),this.gradients=null,t&&(this.defs=t.destroy()),this.subPixelFix&&Ge(e,"resize",this.subPixelFix),this.alignedObjects=null},createElement:function(e){var t=new this.Element;return t.init(this,e),t},draw:function(){},getRadialAttr:function(e,t){return{cx:e[0]-e[2]/2+t.cx*e[2],cy:e[1]-e[2]/2+t.cy*e[2],r:t.r*e[2]}},buildText:function(e){for(var t,i,r,o=e.element,a=this,s=a.forExport,l=Ze(e.textStr,"").toString(),c=-1!==l.indexOf("<"),h=o.childNodes,u=d(o,"x"),g=e.styles,f=e.textWidth,m=g&&g.lineHeight,v=g&&g.textShadow,y=g&&"ellipsis"===g.textOverflow,k=h.length,b=f&&!e.added&&this.box,C=function(e){return m?n(m):a.fontMetrics(/(px|em)$/.test(e&&e.style.fontSize)?e.style.fontSize:g&&g.fontSize||a.style.fontSize||12,e).h},x=function(e){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">")};k--;)o.removeChild(h[k]);c||v||y||-1!==l.indexOf(" ")?(t=/<.*style="([^"]+)".*>/,i=/<.*href="(http[^"]+)".*>/,b&&b.appendChild(o),l=c?l.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):[l],l=$e(l,function(e){return""!==e}),Fe(l,function(n,l){var c,h=0,n=n.replace(/^\s+|\s+$/g,"").replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");c=n.split("|||"),Fe(c,function(n){if(""!==n||1===c.length){var m,v={},k=oe.createElementNS(Te,"tspan");if(t.test(n)&&(m=n.match(t)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),d(k,"style",m)),i.test(n)&&!s&&(d(k,"onclick",'location.href="'+n.match(i)[1]+'"'),p(k,{cursor:"pointer"})),n=x(n.replace(/<(.|\n)*?>/g,"")||" ")," "!==n){if(k.appendChild(oe.createTextNode(n)),h?v.dx=0:l&&null!==u&&(v.x=u),d(k,v),o.appendChild(k),!h&&l&&(!we&&s&&p(k,{display:"block"}),d(k,"dy",C(k))),f){for(var b,S,v=n.replace(/([^\^])-/g,"$1- ").split(" "),T=c.length>1||l||v.length>1&&"nowrap"!==g.whiteSpace,w=[],P=C(k),N=1,L=e.rotation,I=n,A=I.length;(T||y)&&(v.length||w.length);)e.rotation=0,b=e.getBBox(!0),S=b.width,!we&&a.forExport&&(S=a.measureSpanWidth(k.firstChild.data,e.styles)),b=S>f,void 0===r&&(r=b),y&&r?(A/=2,""===I||!b&&.5>A?v=[]:(I=n.substring(0,I.length+(b?-1:1)*ce(A)),v=[I+(f>3?"…":"")],k.removeChild(k.firstChild))):b&&1!==v.length?(k.removeChild(k.firstChild),w.unshift(v.pop())):(v=w,w=[],v.length&&(N++,k=oe.createElementNS(Te,"tspan"),d(k,{dy:P,x:u}),m&&d(k,"style",m),o.appendChild(k)),S>f&&(f=S)),v.length&&k.appendChild(oe.createTextNode(v.join(" ").replace(/- /g,"-")));e.rotation=L}h++}}})}),r&&e.attr("title",e.textStr),b&&b.removeChild(o),v&&e.applyTextShadow&&e.applyTextShadow(v)):o.appendChild(oe.createTextNode(x(l)))},getContrast:function(e){return e=A(e).rgba,e[0]+e[1]+e[2]>384?"#000000":"#FFFFFF"},button:function(e,t,i,n,o,a,s,l,c){var d,h,u,p,g,f,m=this.label(e,t,i,c,null,null,null,null,"button"),v=0,e={x1:0,y1:0,x2:0,y2:1},o=r({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:e,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},o);return u=o.style,delete o.style,a=r(o,{stroke:"#68A",fill:{linearGradient:e,stops:[[0,"#FFF"],[1,"#ACF"]]}},a),p=a.style,delete a.style,s=r(o,{stroke:"#68A",fill:{linearGradient:e,stops:[[0,"#9BD"],[1,"#CDF"]]}},s),g=s.style,delete s.style,l=r(o,{style:{color:"#CCC"}},l),f=l.style,delete l.style,Ue(m.element,ke?"mouseover":"mouseenter",function(){3!==v&&m.attr(a).css(p)}),Ue(m.element,ke?"mouseout":"mouseleave",function(){3!==v&&(d=[o,a,s][v],h=[u,p,g][v],m.attr(d).css(h))}),m.setState=function(e){(m.state=v=e)?2===e?m.attr(s).css(g):3===e&&m.attr(l).css(f):m.attr(o).css(u)},m.on("click",function(e){3!==v&&n.call(m,e)}).attr(o).css(Ve({cursor:"default"},u))},crispLine:function(e,t){return e[1]===e[4]&&(e[1]=e[4]=se(e[1])-t%2/2),e[2]===e[5]&&(e[2]=e[5]=se(e[2])+t%2/2),e},path:function(e){var t={fill:"none"};return s(e)?t.d=e:a(e)&&Ve(t,e),this.createElement("path").attr(t)},circle:function(e,t,i){return e=a(e)?e:{x:e,y:t,r:i},t=this.createElement("circle"),t.xSetter=t.ySetter=function(e,t,i){i.setAttribute("c"+t,e)},t.attr(e)},arc:function(e,t,i,r,n,o){return a(e)&&(t=e.y,i=e.r,r=e.innerR,n=e.start,o=e.end,e=e.x),e=this.symbol("arc",e||0,t||0,i||0,i||0,{innerR:r||0,start:n||0,end:o||0}),e.r=i,e},rect:function(e,t,i,r,n,o){var n=a(e)?e.r:n,s=this.createElement("rect"),e=a(e)?e:e===O?{}:{x:e,y:t,width:de(i,0),height:de(r,0)};return o!==O&&(s.strokeWidth=o,e=s.crisp(e)),n&&(e.r=n),s.rSetter=function(e,t,i){d(i,{rx:e,ry:e})},s.attr(e)},setSize:function(e,t,i){var r=this.alignedObjects,n=r.length;for(this.width=e,this.height=t,this.boxWrapper[Ze(i,!0)?"animate":"attr"]({width:e,height:t});n--;)r[n].align()},g:function(e){var t=this.createElement("g");return c(e)?t.attr({"class":"highcharts-"+e}):t},image:function(e,t,i,r,n){var o={preserveAspectRatio:"none"};return arguments.length>1&&Ve(o,{x:t,y:i,width:r,height:n}),o=this.createElement("image").attr(o),o.element.setAttributeNS?o.element.setAttributeNS("http://www.w3.org/1999/xlink","href",e):o.element.setAttribute("hc-svg-href",e),o},symbol:function(e,t,i,r,n,o){var a,s,l,c=this,d=this.symbols[e],d=d&&d(se(t),se(i),r,n,o),h=/^url\((.*?)\)$/;return d?(a=this.path(d),Ve(a,{symbolName:e,x:t,y:i,width:r,height:n}),o&&Ve(a,o)):h.test(e)&&(l=function(e,t){e.element&&(e.attr({width:t[0],height:t[1]}),e.alignByTranslate||e.translate(se((r-t[0])/2),se((n-t[1])/2)))},s=e.match(h)[1],e=Le[s]||o&&o.width&&o.height&&[o.width,o.height],a=this.image(s).attr({x:t,y:i}),a.isImg=!0,e?l(a,e):(a.attr({width:0,height:0}),g("img",{onload:function(){0===this.width&&(p(this,{position:"absolute",top:"-999em"}),oe.body.appendChild(this)),l(a,Le[s]=[this.width,this.height]),this.parentNode&&this.parentNode.removeChild(this),c.imgCount--,!c.imgCount&&Me[c.chartIndex].onload&&Me[c.chartIndex].onload()},src:s}),this.imgCount++)),a},symbols:{circle:function(e,t,i,r){var n=.166*i;return["M",e+i/2,t,"C",e+i+n,t,e+i+n,t+r,e+i/2,t+r,"C",e-n,t+r,e-n,t,e+i/2,t,"Z"]},square:function(e,t,i,r){return["M",e,t,"L",e+i,t,e+i,t+r,e,t+r,"Z"]},triangle:function(e,t,i,r){return["M",e+i/2,t,"L",e+i,t+r,e,t+r,"Z"]},"triangle-down":function(e,t,i,r){return["M",e,t,"L",e+i,t,e+i/2,t+r,"Z"]},diamond:function(e,t,i,r){return["M",e+i/2,t,"L",e+i,t+r/2,e+i/2,t+r,e,t+r/2,"Z"]},arc:function(e,t,i,r,n){var o=n.start,i=n.r||i||r,a=n.end-.001,r=n.innerR,s=n.open,l=pe(o),c=ge(o),d=pe(a),a=ge(a),n=n.end-o<fe?0:1;return["M",e+i*l,t+i*c,"A",i,i,0,n,1,e+i*d,t+i*a,s?"M":"L",e+r*d,t+r*a,"A",r,r,0,n,0,e+r*l,t+r*c,s?"":"Z"]},callout:function(e,t,i,r,n){var o,a=he(n&&n.r||0,i,r),s=a+6,l=n&&n.anchorX,n=n&&n.anchorY;return o=["M",e+a,t,"L",e+i-a,t,"C",e+i,t,e+i,t,e+i,t+a,"L",e+i,t+r-a,"C",e+i,t+r,e+i,t+r,e+i-a,t+r,"L",e+a,t+r,"C",e,t+r,e,t+r,e,t+r-a,"L",e,t+a,"C",e,t,e,t,e+a,t],l&&l>i&&n>t+s&&t+r-s>n?o.splice(13,3,"L",e+i,n-6,e+i+6,n,e+i,n+6,e+i,t+r-a):l&&0>l&&n>t+s&&t+r-s>n?o.splice(33,3,"L",e,n+6,e-6,n,e,n-6,e,t+a):n&&n>r&&l>e+s&&e+i-s>l?o.splice(23,3,"L",l+6,t+r,l,t+r+6,l-6,t+r,e+a,t+r):n&&0>n&&l>e+s&&e+i-s>l&&o.splice(3,3,"L",l-6,t,l,t-6,l+6,t,i-a,t),o}},clipRect:function(e,t,i,r){var n="highcharts-"+Ie++,o=this.createElement("clipPath").attr({id:n}).add(this.defs),e=this.rect(e,t,i,r,0).add(o);return e.id=n,e.clipPath=o,e.count=0,e},text:function(e,t,i,r){var n=Ne||!we&&this.forExport,o={};return!r||!this.allowHTML&&this.forExport?(o.x=Math.round(t||0),i&&(o.y=Math.round(i)),(e||0===e)&&(o.text=e),e=this.createElement("text").attr(o),n&&e.css({position:"absolute"}),r||(e.xSetter=function(e,t,i){var r,n,o=i.getElementsByTagName("tspan"),a=i.getAttribute(t);for(n=0;n<o.length;n++)r=o[n],r.getAttribute(t)===a&&r.setAttribute(t,e);i.setAttribute(t,e)}),e):this.html(e,t,i)},fontMetrics:function(t,i){var r,o,t=t||this.style.fontSize;return!t&&i&&e.getComputedStyle&&(i=i.element||i,t=(r=e.getComputedStyle(i,""))&&r.fontSize),t=/px/.test(t)?n(t):/em/.test(t)?12*parseFloat(t):12,r=24>t?t+3:se(1.2*t),o=se(.8*r),{h:r,b:o,f:t}},rotCorr:function(e,t,i){var r=e;return t&&i&&(r=de(r*pe(t*me),4)),{x:-e/3*ge(t*me),y:r}},label:function(e,t,i,n,o,a,s,l,d){var h,u,p,g,f,m,v,y,k,b,C,x=this,S=x.g(d),T=x.text("",0,0,s).attr({zIndex:1}),w=0,P=3,N=0,L=0,I={};k=function(){var e,t;e=T.element.style,u=(void 0===p||void 0===g||S.styles.textAlign)&&c(T.textStr)&&T.getBBox(),S.width=(p||u.width||0)+2*P+N,S.height=(g||u.height||0)+2*P,v=P+x.fontMetrics(e&&e.fontSize,T).b,y&&(h||(e=L,t=(l?-v:0)+L,S.box=h=n?x.symbol(n,e,t,S.width,S.height,I):x.rect(e,t,S.width,S.height,0,I["stroke-width"]),h.isImg||h.attr("fill","none"),h.add(S)),h.isImg||h.attr(Ve({width:se(S.width),height:se(S.height)},I)),I=null)},b=function(){var e,t=S.styles,t=t&&t.textAlign,i=N+P;e=l?0:v,c(p)&&u&&("center"===t||"right"===t)&&(i+={center:.5,right:1}[t]*(p-u.width)),i===T.x&&e===T.y||(T.attr("x",i),e!==O&&T.attr("y",e)),T.x=i,T.y=e},C=function(e,t){h?h.attr(e,t):I[e]=t},S.onAdd=function(){T.add(S),S.attr({text:e||0===e?e:"",x:t,y:i}),h&&c(o)&&S.attr({anchorX:o,anchorY:a})},S.widthSetter=function(e){p=e},S.heightSetter=function(e){g=e},S.paddingSetter=function(e){c(e)&&e!==P&&(P=S.padding=e,b())},S.paddingLeftSetter=function(e){c(e)&&e!==N&&(N=e,b())},S.alignSetter=function(e){e={left:0,center:.5,right:1}[e],e!==w&&(w=e,u&&S.attr({x:f}))},S.textSetter=function(e){e!==O&&T.textSetter(e),k(),b()},S["stroke-widthSetter"]=function(e,t){e&&(y=!0),L=e%2/2,C(t,e)},S.strokeSetter=S.fillSetter=S.rSetter=function(e,t){"fill"===t&&e&&(y=!0),C(t,e)},S.anchorXSetter=function(e,t){o=e,C(t,se(e)-L-f)},S.anchorYSetter=function(e,t){a=e,C(t,e-m)},S.xSetter=function(e){S.x=e,w&&(e-=w*((p||u.width)+2*P)),f=se(e),S.attr("translateX",f)},S.ySetter=function(e){m=S.y=se(e),S.attr("translateY",m)};var A=S.css;return Ve(S,{css:function(e){if(e){var t={},e=r(e);Fe(S.textProps,function(i){e[i]!==O&&(t[i]=e[i],delete e[i])}),T.css(t)}return A.call(S,e)},getBBox:function(){return{width:u.width+2*P,height:u.height+2*P,x:u.x-P,y:u.y-P}},shadow:function(e){return h&&h.shadow(e),S},destroy:function(){Ge(S.element,"mouseenter"),Ge(S.element,"mouseleave"),T&&(T=T.destroy()),h&&(h=h.destroy()),M.prototype.destroy.call(S),S=x=k=b=C=null}})}},R=tt,Ve(M.prototype,{htmlCss:function(e){var t=this.element;return(t=e&&"SPAN"===t.tagName&&e.width)&&(delete e.width,this.textWidth=t,this.updateTransform()),e&&"ellipsis"===e.textOverflow&&(e.whiteSpace="nowrap",e.overflow="hidden"),this.styles=Ve(this.styles,e),p(this.element,e),this},htmlGetBBox:function(){var e=this.element;return"text"===e.nodeName&&(e.style.position="absolute"),{x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}},htmlUpdateTransform:function(){if(this.added){
var e=this.renderer,t=this.element,i=this.translateX||0,r=this.translateY||0,o=this.x||0,a=this.y||0,s=this.textAlign||"left",l={left:0,center:.5,right:1}[s],d=this.shadows,h=this.styles;if(p(t,{marginLeft:i,marginTop:r}),d&&Fe(d,function(e){p(e,{marginLeft:i+1,marginTop:r+1})}),this.inverted&&Fe(t.childNodes,function(i){e.invertChild(i,t)}),"SPAN"===t.tagName){var d=this.rotation,u=n(this.textWidth),g=h&&h.whiteSpace,f=[d,s,t.innerHTML,this.textWidth,this.textAlign].join(",");f!==this.cTT&&(h=e.fontMetrics(t.style.fontSize).b,c(d)&&this.setSpanRotation(d,l,h),t.offsetWidth>u&&/[ \-]/.test(t.textContent||t.innerText)?(p(t,{width:u+"px",display:"block",whiteSpace:g||"normal"}),this.hasTextWidth=!0):this.hasTextWidth&&(p(t,{width:"",display:"",whiteSpace:g||"nowrap"}),this.hasTextWidth=!1),this.getSpanCorrection(this.hasTextWidth?u:t.offsetWidth,h,l,d,s)),p(t,{left:o+(this.xCorr||0)+"px",top:a+(this.yCorr||0)+"px"}),Ce&&(h=t.offsetHeight),this.cTT=f}}else this.alignOnAdd=!0},setSpanRotation:function(e,t,i){var r={},n=ke?"-ms-transform":Ce?"-webkit-transform":xe?"MozTransform":ye?"-o-transform":"";r[n]=r.transform="rotate("+e+"deg)",r[n+(xe?"Origin":"-origin")]=r.transformOrigin=100*t+"% "+i+"px",p(this.element,r)},getSpanCorrection:function(e,t,i){this.xCorr=-e*i,this.yCorr=-t}}),Ve(tt.prototype,{html:function(e,t,i){var r=this.createElement("span"),n=r.element,o=r.renderer,a=o.isSVG,s=function(e,t){Fe(["opacity","visibility"],function(i){Je(e,i+"Setter",function(e,i,r,n){e.call(this,i,r,n),t[r]=i})})};return r.textSetter=function(e){e!==n.innerHTML&&delete this.bBox,n.innerHTML=this.textStr=e,r.htmlUpdateTransform()},a&&s(r,r.element.style),r.xSetter=r.ySetter=r.alignSetter=r.rotationSetter=function(e,t){"align"===t&&(t="textAlign"),r[t]=e,r.htmlUpdateTransform()},r.attr({text:e,x:se(t),y:se(i)}).css({position:"absolute",fontFamily:this.style.fontFamily,fontSize:this.style.fontSize}),n.style.whiteSpace="nowrap",r.css=r.htmlCss,a&&(r.add=function(e){var t,i=o.box.parentNode,a=[];if(this.parentGroup=e){if(t=e.div,!t){for(;e;)a.push(e),e=e.parentGroup;Fe(a.reverse(),function(e){var r,n=d(e.element,"class");n&&(n={className:n}),t=e.div=e.div||g(De,n,{position:"absolute",left:(e.translateX||0)+"px",top:(e.translateY||0)+"px",opacity:e.opacity},t||i),r=t.style,Ve(e,{translateXSetter:function(t,i){r.left=t+"px",e[i]=t,e.doTransform=!0},translateYSetter:function(t,i){r.top=t+"px",e[i]=t,e.doTransform=!0}}),s(e,r)})}}else t=i;return t.appendChild(n),r.added=!0,r.alignOnAdd&&r.htmlUpdateTransform(),r}),r}});var it;if(!we&&!Ne){it={init:function(e,t){var i=["<",t,' filled="f" stroked="f"'],r=["position: ","absolute",";"],n=t===De;("shape"===t||n)&&r.push("left:0;top:0;width:1px;height:1px;"),r.push("visibility: ",n?"hidden":"visible"),i.push(' style="',r.join(""),'"/>'),t&&(i=n||"span"===t||"img"===t?i.join(""):e.prepVML(i),this.element=g(i)),this.renderer=e},add:function(e){var t=this.renderer,i=this.element,r=t.box,n=e&&e.inverted,r=e?e.element||e:r;return e&&(this.parentGroup=e),n&&t.invertChild(i,r),r.appendChild(i),this.added=!0,this.alignOnAdd&&!this.deferUpdateTransform&&this.updateTransform(),this.onAdd&&this.onAdd(),this},updateTransform:M.prototype.htmlUpdateTransform,setSpanRotation:function(){var e=this.rotation,t=pe(e*me),i=ge(e*me);p(this.element,{filter:e?["progid:DXImageTransform.Microsoft.Matrix(M11=",t,", M12=",-i,", M21=",i,", M22=",t,", sizingMethod='auto expand')"].join(""):"none"})},getSpanCorrection:function(e,t,i,r,n){var o,a=r?pe(r*me):1,s=r?ge(r*me):0,l=Ze(this.elemHeight,this.element.offsetHeight);this.xCorr=0>a&&-e,this.yCorr=0>s&&-l,o=0>a*s,this.xCorr+=s*t*(o?1-i:i),this.yCorr-=a*t*(r?o?i:1-i:1),n&&"left"!==n&&(this.xCorr-=e*i*(0>a?-1:1),r&&(this.yCorr-=l*i*(0>s?-1:1)),p(this.element,{textAlign:n}))},pathToVML:function(e){for(var t=e.length,i=[];t--;)Ke(e[t])?i[t]=se(10*e[t])-5:"Z"===e[t]?i[t]="x":(i[t]=e[t],!e.isArc||"wa"!==e[t]&&"at"!==e[t]||(i[t+5]===i[t+7]&&(i[t+7]+=e[t+7]>e[t+5]?1:-1),i[t+6]===i[t+8]&&(i[t+8]+=e[t+8]>e[t+6]?1:-1)));return i.join(" ")||"x"},clip:function(e){var t,i=this;return e?(t=e.members,l(t,i),t.push(i),i.destroyClip=function(){l(t,i)},e=e.getCSS(i)):(i.destroyClip&&i.destroyClip(),e={clip:be?"inherit":"rect(auto)"}),i.css(e)},css:M.prototype.htmlCss,safeRemoveChild:function(e){e.parentNode&&w(e)},destroy:function(){return this.destroyClip&&this.destroyClip(),M.prototype.destroy.apply(this)},on:function(t,i){return this.element["on"+t]=function(){var t=e.event;t.target=t.srcElement,i(t)},this},cutOffPath:function(e,t){var i,e=e.split(/[ ,]/);return i=e.length,9!==i&&11!==i||(e[i-4]=e[i-2]=n(e[i-2])-10*t),e.join(" ")},shadow:function(e,t,i){var r,o,a,s,l,c,d,h=[],u=this.element,p=this.renderer,f=u.style,m=u.path;if(m&&"string"!=typeof m.value&&(m="x"),l=m,e){for(c=Ze(e.width,3),d=(e.opacity||.15)/c,r=1;3>=r;r++)s=2*c+1-2*r,i&&(l=this.cutOffPath(m.value,s+.5)),a=['<shape isShadow="true" strokeweight="',s,'" filled="false" path="',l,'" coordsize="10 10" style="',u.style.cssText,'" />'],o=g(p.prepVML(a),null,{left:n(f.left)+Ze(e.offsetX,1),top:n(f.top)+Ze(e.offsetY,1)}),i&&(o.cutOff=s+1),a=['<stroke color="',e.color||"black",'" opacity="',d*r,'"/>'],g(p.prepVML(a),null,null,o),t?t.element.appendChild(o):u.parentNode.insertBefore(o,u),h.push(o);this.shadows=h}return this},updateShadows:Ae,setAttr:function(e,t){be?this.element[e]=t:this.element.setAttribute(e,t)},classSetter:function(e){this.element.className=e},dashstyleSetter:function(e,t,i){(i.getElementsByTagName("stroke")[0]||g(this.renderer.prepVML(["<stroke/>"]),null,null,i))[t]=e||"solid",this[t]=e},dSetter:function(e,t,i){var r=this.shadows,e=e||[];if(this.d=e.join&&e.join(" "),i.path=e=this.pathToVML(e),r)for(i=r.length;i--;)r[i].path=r[i].cutOff?this.cutOffPath(e,r[i].cutOff):e;this.setAttr(t,e)},fillSetter:function(e,t,i){var r=i.nodeName;"SPAN"===r?i.style.color=e:"IMG"!==r&&(i.filled="none"!==e,this.setAttr("fillcolor",this.renderer.color(e,i,t,this)))},"fill-opacitySetter":function(e,t,i){g(this.renderer.prepVML(["<",t.split("-")[0],' opacity="',e,'"/>']),null,null,i)},opacitySetter:Ae,rotationSetter:function(e,t,i){i=i.style,this[t]=i[t]=e,i.left=-se(ge(e*me)+1)+"px",i.top=se(pe(e*me))+"px"},strokeSetter:function(e,t,i){this.setAttr("strokecolor",this.renderer.color(e,i,t,this))},"stroke-widthSetter":function(e,t,i){i.stroked=!!e,this[t]=e,Ke(e)&&(e+="px"),this.setAttr("strokeweight",e)},titleSetter:function(e,t){this.setAttr(t,e)},visibilitySetter:function(e,t,i){"inherit"===e&&(e="visible"),this.shadows&&Fe(this.shadows,function(i){i.style[t]=e}),"DIV"===i.nodeName&&(e="hidden"===e?"-999em":0,be||(i.style[t]=e?"visible":"hidden"),t="top"),i.style[t]=e},xSetter:function(e,t,i){this[t]=e,"x"===t?t="left":"y"===t&&(t="top"),this.updateClipping?(this[t]=e,this.updateClipping()):i.style[t]=e},zIndexSetter:function(e,t,i){i.style[t]=e}},it["stroke-opacitySetter"]=it["fill-opacitySetter"],ne.VMLElement=it=f(M,it),it.prototype.ySetter=it.prototype.widthSetter=it.prototype.heightSetter=it.prototype.xSetter;var rt={Element:it,isIE8:ve.indexOf("MSIE 8.0")>-1,init:function(e,t,i,r){var n;if(this.alignedObjects=[],r=this.createElement(De).css(Ve(this.getStyle(r),{position:"relative"})),n=r.element,e.appendChild(r.element),this.isVML=!0,this.box=n,this.boxWrapper=r,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.setSize(t,i,!1),!oe.namespaces.hcv){oe.namespaces.add("hcv","urn:schemas-microsoft-com:vml");try{oe.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}catch(o){oe.styleSheets[0].cssText+="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(e,t,i,r){var n=this.createElement(),o=a(e);return Ve(n,{members:[],count:0,left:(o?e.x:e)+1,top:(o?e.y:t)+1,width:(o?e.width:i)-1,height:(o?e.height:r)-1,getCSS:function(e){var t=e.element,i=t.nodeName,e=e.inverted,r=this.top-("shape"===i?t.offsetTop:0),n=this.left,t=n+this.width,o=r+this.height,r={clip:"rect("+se(e?n:r)+"px,"+se(e?o:t)+"px,"+se(e?t:o)+"px,"+se(e?r:n)+"px)"};return!e&&be&&"DIV"===i&&Ve(r,{width:t+"px",height:o+"px"}),r},updateClipping:function(){Fe(n.members,function(e){e.element&&e.css(n.getCSS(e))})}})},color:function(e,t,i,r){var n,o,a,s=this,l=/^rgba/,c="none";if(e&&e.linearGradient?a="gradient":e&&e.radialGradient&&(a="pattern"),a){var d,h,u,p,f,m,v,y,k=e.linearGradient||e.radialGradient,b="",e=e.stops,C=[],x=function(){o=['<fill colors="'+C.join(",")+'" opacity="',f,'" o:opacity2="',p,'" type="',a,'" ',b,'focus="100%" method="any" />'],g(s.prepVML(o),null,null,t)};if(u=e[0],y=e[e.length-1],u[0]>0&&e.unshift([0,u[1]]),y[0]<1&&e.push([1,y[1]]),Fe(e,function(e,t){l.test(e[1])?(n=A(e[1]),d=n.get("rgb"),h=n.get("a")):(d=e[1],h=1),C.push(100*e[0]+"% "+d),t?(f=h,m=d):(p=h,v=d)}),"fill"===i)if("gradient"===a)i=k.x1||k[0]||0,e=k.y1||k[1]||0,u=k.x2||k[2]||0,k=k.y2||k[3]||0,b='angle="'+(90-180*ae.atan((k-e)/(u-i))/fe)+'"',x();else{var S,c=k.r,T=2*c,w=2*c,P=k.cx,N=k.cy,L=t.radialReference,c=function(){L&&(S=r.getBBox(),P+=(L[0]-S.x)/S.width-.5,N+=(L[1]-S.y)/S.height-.5,T*=L[2]/S.width,w*=L[2]/S.height),b='src="'+z.global.VMLRadialGradientURL+'" size="'+T+","+w+'" origin="0.5,0.5" position="'+P+","+N+'" color2="'+v+'" ',x()};r.added?c():r.onAdd=c,c=m}else c=d}else l.test(e)&&"IMG"!==t.tagName?(n=A(e),r[i+"-opacitySetter"](n.get("a"),i,t),c=n.get("rgb")):(c=t.getElementsByTagName(i),c.length&&(c[0].opacity=1,c[0].type="solid"),c=e);return c},prepVML:function(e){var t=this.isIE8,e=e.join("");return t?(e=e.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),e=-1===e.indexOf('style="')?e.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):e.replace('style="','style="display:inline-block;behavior:url(#default#VML);')):e=e.replace("<","<hcv:"),e},text:tt.prototype.html,path:function(e){var t={coordsize:"10 10"};return s(e)?t.d=e:a(e)&&Ve(t,e),this.createElement("shape").attr(t)},circle:function(e,t,i){var r=this.symbol("circle");return a(e)&&(i=e.r,t=e.y,e=e.x),r.isCircle=!0,r.r=i,r.attr({x:e,y:t})},g:function(e){var t;return e&&(t={className:"highcharts-"+e,"class":"highcharts-"+e}),this.createElement(De).attr(t)},image:function(e,t,i,r,n){var o=this.createElement("img").attr({src:e});return arguments.length>1&&o.attr({x:t,y:i,width:r,height:n}),o},createElement:function(e){return"rect"===e?this.symbol(e):tt.prototype.createElement.call(this,e)},invertChild:function(e,t){var i=this,r=t.style,o="IMG"===e.tagName&&e.style;p(e,{flip:"x",left:n(r.width)-(o?n(o.top):1),top:n(r.height)-(o?n(o.left):1),rotation:-90}),Fe(e.childNodes,function(t){i.invertChild(t,e)})},symbols:{arc:function(e,t,i,r,n){var o=n.start,a=n.end,s=n.r||i||r,i=n.innerR,r=pe(o),l=ge(o),c=pe(a),d=ge(a);return a-o===0?["x"]:(o=["wa",e-s,t-s,e+s,t+s,e+s*r,t+s*l,e+s*c,t+s*d],n.open&&!i&&o.push("e","M",e,t),o.push("at",e-i,t-i,e+i,t+i,e+i*c,t+i*d,e+i*r,t+i*l,"x","e"),o.isArc=!0,o)},circle:function(e,t,i,r,n){return n&&(i=r=2*n.r),n&&n.isCircle&&(e-=i/2,t-=r/2),["wa",e,t,e+i,t+r,e+i,t+r/2,e+i,t+r/2,"e"]},rect:function(e,t,i,r,n){return tt.prototype.symbols[c(n)&&n.r?"callout":"square"].call(0,e,t,i,r,n)}}};ne.VMLRenderer=it=function(){this.init.apply(this,arguments)},it.prototype=r(tt.prototype,rt),R=it}tt.prototype.measureSpanWidth=function(e,t){var i,r=oe.createElement("span");return i=oe.createTextNode(e),r.appendChild(i),p(r,t),this.box.appendChild(r),i=r.offsetWidth,w(r),i};var nt;Ne&&(ne.CanVGRenderer=it=function(){Te="http://www.w3.org/1999/xhtml"},it.prototype.symbols={},nt=function(){function e(){var e,i=t.length;for(e=0;i>e;e++)t[e]();t=[]}var t=[];return{push:function(i,r){if(0===t.length){var n=oe.getElementsByTagName("head")[0],o=oe.createElement("script");o.type="text/javascript",o.src=r,o.onload=e,n.appendChild(o)}t.push(i)}}}(),R=it),E.prototype={addLabel:function(){var e,t=this.axis,i=t.options,n=t.chart,o=t.categories,a=t.names,s=this.pos,l=i.labels,d=t.tickPositions,h=s===d[0],u=s===d[d.length-1],a=o?Ze(o[s],a[s],s):s,o=this.label,d=d.info;t.isDatetimeAxis&&d&&(e=i.dateTimeLabelFormats[d.higherRanks[s]||d.unitName]),this.isFirst=h,this.isLast=u,i=t.labelFormatter.call({axis:t,chart:n,isFirst:h,isLast:u,dateTimeLabelFormat:e,value:t.isLog?P(t.lin2log(a)):a}),c(o)?o&&o.attr({text:i}):(this.labelLength=(this.label=o=c(i)&&l.enabled?n.renderer.text(i,0,0,l.useHTML).css(r(l.style)).add(t.labelGroup):null)&&o.getBBox().width,this.rotation=0)},getLabelSize:function(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0},handleOverflow:function(e){var t,i=this.axis,r=e.x,n=i.chart.chartWidth,o=i.chart.spacing,a=Ze(i.labelLeft,he(i.pos,o[3])),o=Ze(i.labelRight,de(i.pos+i.len,n-o[1])),s=this.label,l=this.rotation,c={left:0,center:.5,right:1}[i.labelAlign],d=s.getBBox().width,h=i.getSlotWidth(),u=h,p=1,g={};l?0>l&&a>r-c*d?t=se(r/pe(l*me)-a):l>0&&r+c*d>o&&(t=se((n-r)/pe(l*me))):(n=r+(1-c)*d,a>r-c*d?u=e.x+u*(1-c)-a:n>o&&(u=o-e.x+u*c,p=-1),u=he(h,u),h>u&&"center"===i.labelAlign&&(e.x+=p*(h-u-c*(h-he(d,u)))),(d>u||i.autoRotation&&s.styles.width)&&(t=u)),t&&(g.width=t,i.options.labels.style.textOverflow||(g.textOverflow="ellipsis"),s.css(g))},getPosition:function(e,t,i,r){var n=this.axis,o=n.chart,a=r&&o.oldChartHeight||o.chartHeight;return{x:e?n.translate(t+i,null,null,r)+n.transB:n.left+n.offset+(n.opposite?(r&&o.oldChartWidth||o.chartWidth)-n.right-n.left:0),y:e?a-n.bottom+n.offset-(n.opposite?n.height:0):a-n.translate(t+i,null,null,r)-n.transB}},getLabelPosition:function(e,t,i,r,n,o,a,s){var l=this.axis,d=l.transA,h=l.reversed,u=l.staggerLines,p=l.tickRotCorr||{x:0,y:0},g=n.y;return c(g)||(g=0===l.side?i.rotation?-8:-i.getBBox().height:2===l.side?p.y+8:pe(i.rotation*me)*(p.y-i.getBBox(!1,0).height/2)),e=e+n.x+p.x-(o&&r?o*d*(h?-1:1):0),t=t+g-(o&&!r?o*d*(h?1:-1):0),u&&(i=a/(s||1)%u,l.opposite&&(i=u-i-1),t+=i*(l.labelOffset/u)),{x:e,y:se(t)}},getMarkPath:function(e,t,i,r,n,o){return o.crispLine(["M",e,t,"L",e+(n?0:-i),t+(n?i:0)],r)},render:function(e,t,i){var r=this.axis,n=r.options,o=r.chart.renderer,a=r.horiz,s=this.type,l=this.label,c=this.pos,d=n.labels,h=this.gridLine,u=s?s+"Grid":"grid",p=s?s+"Tick":"tick",g=n[u+"LineWidth"],f=n[u+"LineColor"],m=n[u+"LineDashStyle"],u=r.tickSize(p),p=n[p+"Color"],v=this.mark,y=d.step,k=!0,b=r.tickmarkOffset,C=this.getPosition(a,c,b,t),x=C.x,C=C.y,S=a&&x===r.pos+r.len||!a&&C===r.pos?-1:1,i=Ze(i,1);this.isActive=!0,g&&(c=r.getPlotLinePath(c+b,g*S,t,!0),h===O&&(h={stroke:f,"stroke-width":g},m&&(h.dashstyle=m),s||(h.zIndex=1),t&&(h.opacity=0),this.gridLine=h=g?o.path(c).attr(h).add(r.gridGroup):null),!t&&h&&c&&h[this.isNew?"attr":"animate"]({d:c,opacity:i})),u&&(r.opposite&&(u[0]=-u[0]),s=this.getMarkPath(x,C,u[0],u[1]*S,a,o),v?v.animate({d:s,opacity:i}):this.mark=o.path(s).attr({stroke:p,"stroke-width":u[1],opacity:i}).add(r.axisGroup)),l&&Ke(x)&&(l.xy=C=this.getLabelPosition(x,C,l,a,d,b,e,y),this.isFirst&&!this.isLast&&!Ze(n.showFirstLabel,1)||this.isLast&&!this.isFirst&&!Ze(n.showLastLabel,1)?k=!1:a&&!r.isRadial&&!d.step&&!d.rotation&&!t&&0!==i&&this.handleOverflow(C),y&&e%y&&(k=!1),k&&Ke(C.y)?(C.opacity=i,l[this.isNew?"attr":"animate"](C),this.isNew=!1):l.attr("y",-9999))},destroy:function(){T(this,this.axis)}},ne.PlotLineOrBand=function(e,t){this.axis=e,t&&(this.options=t,this.id=t.id)},ne.PlotLineOrBand.prototype={render:function(){var e,t=this,i=t.axis,n=i.horiz,o=t.options,a=o.label,s=t.label,l=o.width,d=o.to,h=o.from,u=c(h)&&c(d),p=o.value,g=o.dashStyle,f=t.svgElem,m=[],v=o.color,y=Ze(o.zIndex,0),k=o.events,b={},C=i.chart.renderer,m=i.log2lin;if(i.isLog&&(h=m(h),d=m(d),p=m(p)),l)m=i.getPlotLinePath(p,l),b={stroke:v,"stroke-width":l},g&&(b.dashstyle=g);else{if(!u)return;m=i.getPlotBandPath(h,d,o),v&&(b.fill=v),o.borderWidth&&(b.stroke=o.borderColor,b["stroke-width"]=o.borderWidth)}if(b.zIndex=y,f)m?(f.show(),f.animate({d:m})):(f.hide(),s&&(t.label=s=s.destroy()));else if(m&&m.length&&(t.svgElem=f=C.path(m).attr(b).add(),k))for(e in o=function(e){f.on(e,function(i){k[e].apply(t,[i])})},k)o(e);return a&&c(a.text)&&m&&m.length&&i.width>0&&i.height>0&&!m.flat?(a=r({align:n&&u&&"center",x:n?!u&&4:10,verticalAlign:!n&&u&&"middle",y:n?u?16:10:u?6:-4,rotation:n&&!u&&90},a),this.renderLabel(a,m,u,y)):s&&s.hide(),t},renderLabel:function(e,t,i,r){var n=this.label,o=this.axis.chart.renderer;n||(n={align:e.textAlign||e.align,rotation:e.rotation},n.zIndex=r,this.label=n=o.text(e.text,0,0,e.useHTML).attr(n).css(e.style).add()),r=[t[1],t[4],i?t[6]:t[1]],t=[t[2],t[5],i?t[7]:t[2]],i=x(r),o=x(t),n.align(e,!1,{x:i,y:o,width:S(r)-i,height:S(t)-o}),n.show()},destroy:function(){l(this.axis.plotLinesAndBands,this),delete this.axis,T(this)}};var ot=ne.Axis=function(){this.init.apply(this,arguments)};ot.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#D8D8D8",labels:{enabled:!0,style:{color:"#606060",cursor:"default",fontSize:"11px"},x:0},lineColor:"#C0D0E0",lineWidth:1,minPadding:.01,maxPadding:.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",title:{align:"middle",style:{color:"#707070"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},lineWidth:0,maxPadding:.05,minPadding:.05,startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return ne.numberFormat(this.total,-1)},style:r(Qe.line.dataLabels.style,{color:"#000000"})}},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},init:function(e,t){var i=t.isX;this.chart=e,this.horiz=e.inverted?!i:i,this.coll=(this.isXAxis=i)?"xAxis":"yAxis",this.opposite=t.opposite,this.side=t.side||(this.horiz?this.opposite?0:2:this.opposite?1:3),this.setOptions(t);var r=this.options,n=r.type;this.labelFormatter=r.labels.formatter||this.defaultLabelFormatter,this.userOptions=t,this.minPixelPadding=0,this.reversed=r.reversed,this.visible=r.visible!==!1,this.zoomEnabled=r.zoomEnabled!==!1,this.categories=r.categories||"category"===n,this.names=this.names||[],this.isLog="logarithmic"===n,this.isDatetimeAxis="datetime"===n,this.isLinked=c(r.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len=0,this.minRange=this.userMinRange=r.minRange||r.maxZoom,this.range=r.range,this.offset=r.offset||0,this.stacks={},this.oldStacks={},this.stacksTouched=0,this.min=this.max=null,this.crosshair=Ze(r.crosshair,h(e.options.tooltip.crosshairs)[i?0:1],!1);var o,r=this.options.events;-1===ze(this,e.axes)&&(i&&!this.isColorAxis?e.axes.splice(e.xAxis.length,0,this):e.axes.push(this),e[this.coll].push(this)),this.series=this.series||[],e.inverted&&i&&this.reversed===O&&(this.reversed=!0),this.removePlotLine=this.removePlotBand=this.removePlotBandOrLine;for(o in r)Ue(this,o,r[o]);this.isLog&&(this.val2lin=this.log2lin,this.lin2val=this.lin2log)},setOptions:function(e){this.options=r(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],r(z[this.coll],e))},defaultLabelFormatter:function(){var e,t=this.axis,i=this.value,r=t.categories,n=this.dateTimeLabelFormat,o=z.lang.numericSymbols,a=o&&o.length,s=t.options.labels.format,t=t.isLog?i:t.tickInterval;if(s)e=y(s,this);else if(r)e=i;else if(n)e=F(n,i);else if(a&&t>=1e3)for(;a--&&e===O;)r=Math.pow(1e3,a+1),t>=r&&10*i%r===0&&null!==o[a]&&(e=ne.numberFormat(i/r,-1)+o[a]);return e===O&&(e=ue(i)>=1e4?ne.numberFormat(i,-1):ne.numberFormat(i,-1,O,"")),e},getSeriesExtremes:function(){var e=this,t=e.chart;e.hasVisibleSeries=!1,e.dataMin=e.dataMax=e.threshold=null,e.softThreshold=!e.isXAxis,e.buildStacks&&e.buildStacks(),Fe(e.series,function(i){if(i.visible||!t.options.chart.ignoreHiddenSeries){var r,n=i.options,o=n.threshold;e.hasVisibleSeries=!0,e.isLog&&0>=o&&(o=null),e.isXAxis?(n=i.xData,n.length&&(i=x(n),!Ke(i)&&!(i instanceof H)&&(n=$e(n,function(e){return Ke(e)}),i=x(n)),e.dataMin=he(Ze(e.dataMin,n[0]),i),e.dataMax=de(Ze(e.dataMax,n[0]),S(n)))):(i.getExtremes(),r=i.dataMax,i=i.dataMin,c(i)&&c(r)&&(e.dataMin=he(Ze(e.dataMin,i),i),e.dataMax=de(Ze(e.dataMax,r),r)),c(o)&&(e.threshold=o),n.softThreshold&&!e.isLog||(e.softThreshold=!1))}})},translate:function(e,t,i,r,n,o){var a=this.linkedParent||this,s=1,l=0,c=r?a.oldTransA:a.transA,r=r?a.oldMin:a.min,d=a.minPixelPadding,n=(a.isOrdinal||a.isBroken||a.isLog&&n)&&a.lin2val;return c||(c=a.transA),i&&(s*=-1,l=a.len),a.reversed&&(s*=-1,l-=s*(a.sector||a.len)),t?(e=e*s+l,e-=d,e=e/c+r,n&&(e=a.lin2val(e))):(n&&(e=a.val2lin(e)),"between"===o&&(o=.5),e=s*(e-r)*c+l+s*d+(Ke(o)?c*o*a.pointRange:0)),e},toPixels:function(e,t){return this.translate(e,!1,!this.horiz,null,!0)+(t?0:this.pos)},toValue:function(e,t){return this.translate(e-(t?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(e,t,i,r,n){var o,a,s,l=this.chart,c=this.left,d=this.top,h=i&&l.oldChartHeight||l.chartHeight,u=i&&l.oldChartWidth||l.chartWidth;o=this.transB;var p=function(e,t,i){return(t>e||e>i)&&(r?e=he(de(t,e),i):s=!0),e},n=Ze(n,this.translate(e,null,null,i)),e=i=se(n+o);return o=a=se(h-n-o),Ke(n)?this.horiz?(o=d,a=h-this.bottom,e=i=p(e,c,c+this.width)):(e=c,i=u-this.right,o=a=p(o,d,d+this.height)):s=!0,s&&!r?null:l.renderer.crispLine(["M",e,o,"L",i,a],t||1)},getLinearTickPositions:function(e,t,i){var r,n=P(le(t/e)*e),o=P(ce(i/e)*e),a=[];if(t===i&&Ke(t))return[t];for(t=n;o>=t&&(a.push(t),t=P(t+e),t!==r);)r=t;return a},getMinorTickPositions:function(){var e,t=this.options,i=this.tickPositions,r=this.minorTickInterval,n=[],o=this.pointRangePadding||0;e=this.min-o;var o=this.max+o,a=o-e;if(a&&a/r<this.len/3)if(this.isLog)for(o=i.length,e=1;o>e;e++)n=n.concat(this.getLogTickPositions(r,i[e-1],i[e],!0));else if(this.isDatetimeAxis&&"auto"===t.minorTickInterval)n=n.concat(this.getTimeTicks(this.normalizeTimeTickInterval(r),e,o,t.startOfWeek));else for(i=e+(i[0]-e)%r;o>=i;i+=r)n.push(i);return 0!==n.length&&this.trimTicks(n,t.startOnTick,t.endOnTick),n},adjustForMinRange:function(){var e,t,i,r,n,o,a,s=this.options,l=this.min,d=this.max,h=this.dataMax-this.dataMin>=this.minRange;this.isXAxis&&this.minRange===O&&!this.isLog&&(c(s.min)||c(s.max)?this.minRange=null:(Fe(this.series,function(e){for(n=e.xData,i=o=e.xIncrement?1:n.length-1;i>0;i--)r=n[i]-n[i-1],(t===O||t>r)&&(t=r)}),this.minRange=he(5*t,this.dataMax-this.dataMin))),d-l<this.minRange&&(a=this.minRange,e=(a-d+l)/2,e=[l-e,Ze(s.min,l-e)],h&&(e[2]=this.dataMin),l=S(e),d=[l+a,Ze(s.max,l+a)],h&&(d[2]=this.dataMax),d=x(d),a>d-l&&(e[0]=d-a,e[1]=Ze(s.min,d-a),l=S(e))),this.min=l,this.max=d},getClosest:function(){var e;return Fe(this.series,function(t){var i=t.closestPointRange;!t.noSharedTooltip&&c(i)&&(e=c(e)?he(e,i):i)}),e},setAxisTranslation:function(e){var t,i=this,r=i.max-i.min,n=i.axisPointRange||0,a=0,s=0,l=i.linkedParent,c=!!i.categories,d=i.transA,h=i.isXAxis;(h||c||n)&&(l?(a=l.minPointOffset,s=l.pointRangePadding):(t=i.getClosest(),Fe(i.series,function(e){var r=c?1:h?Ze(e.options.pointRange,t,0):i.axisPointRange||0,e=e.options.pointPlacement;n=de(n,r),i.single||(a=de(a,o(e)?0:r/2),s=de(s,"on"===e?0:r))})),l=i.ordinalSlope&&t?i.ordinalSlope/t:1,i.minPointOffset=a*=l,i.pointRangePadding=s*=l,i.pointRange=he(n,r),h&&(i.closestPointRange=t)),e&&(i.oldTransA=d),i.translationSlope=i.transA=d=i.len/(r+s||1),i.transB=i.horiz?i.left:i.bottom,i.minPixelPadding=d*a},minFromRange:function(){return this.max-this.range},setTickInterval:function(e){var i,r,n,o,a=this,s=a.chart,l=a.options,d=a.isLog,h=a.log2lin,u=a.isDatetimeAxis,p=a.isXAxis,g=a.isLinked,f=l.maxPadding,m=l.minPadding,v=l.tickInterval,y=l.tickPixelInterval,C=a.categories,x=a.threshold,S=a.softThreshold;!u&&!C&&!g&&this.getTickAmount(),n=Ze(a.userMin,l.min),o=Ze(a.userMax,l.max),g?(a.linkedParent=s[a.coll][l.linkedTo],s=a.linkedParent.getExtremes(),a.min=Ze(s.min,s.dataMin),a.max=Ze(s.max,s.dataMax),l.type!==a.linkedParent.options.type&&t(11,1)):(!S&&c(x)&&(a.dataMin>=x?(i=x,m=0):a.dataMax<=x&&(r=x,f=0)),a.min=Ze(n,i,a.dataMin),a.max=Ze(o,r,a.dataMax)),d&&(!e&&he(a.min,Ze(a.dataMin,a.min))<=0&&t(10,1),a.min=P(h(a.min),15),a.max=P(h(a.max),15)),a.range&&c(a.max)&&(a.userMin=a.min=n=de(a.min,a.minFromRange()),a.userMax=o=a.max,a.range=null),Ye(a,"foundExtremes"),a.beforePadding&&a.beforePadding(),a.adjustForMinRange(),C||a.axisPointRange||a.usePercentage||g||!c(a.min)||!c(a.max)||!(h=a.max-a.min)||(!c(n)&&m&&(a.min-=h*m),!c(o)&&f&&(a.max+=h*f)),Ke(l.floor)&&(a.min=de(a.min,l.floor)),Ke(l.ceiling)&&(a.max=he(a.max,l.ceiling)),S&&c(a.dataMin)&&(x=x||0,!c(n)&&a.min<x&&a.dataMin>=x?a.min=x:!c(o)&&a.max>x&&a.dataMax<=x&&(a.max=x)),a.tickInterval=a.min===a.max||void 0===a.min||void 0===a.max?1:g&&!v&&y===a.linkedParent.options.tickPixelInterval?v=a.linkedParent.tickInterval:Ze(v,this.tickAmount?(a.max-a.min)/de(this.tickAmount-1,1):void 0,C?1:(a.max-a.min)*y/de(a.len,y)),p&&!e&&Fe(a.series,function(e){e.processData(a.min!==a.oldMin||a.max!==a.oldMax)}),a.setAxisTranslation(!0),a.beforeSetTickPositions&&a.beforeSetTickPositions(),a.postProcessTickInterval&&(a.tickInterval=a.postProcessTickInterval(a.tickInterval)),a.pointRange&&!v&&(a.tickInterval=de(a.pointRange,a.tickInterval)),e=Ze(l.minTickInterval,a.isDatetimeAxis&&a.closestPointRange),!v&&a.tickInterval<e&&(a.tickInterval=e),u||d||v||(a.tickInterval=b(a.tickInterval,null,k(a.tickInterval),Ze(l.allowDecimals,!(a.tickInterval>.5&&a.tickInterval<5&&a.max>1e3&&a.max<9999)),!!this.tickAmount)),!this.tickAmount&&this.len&&(a.tickInterval=a.unsquish()),this.setTickPositions()},setTickPositions:function(){var e,t,i=this.options,r=i.tickPositions,n=i.tickPositioner,o=i.startOnTick,a=i.endOnTick;this.tickmarkOffset=this.categories&&"between"===i.tickmarkPlacement&&1===this.tickInterval?.5:0,this.minorTickInterval="auto"===i.minorTickInterval&&this.tickInterval?this.tickInterval/5:i.minorTickInterval,this.tickPositions=e=r&&r.slice(),!e&&(e=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,i.units),this.min,this.max,i.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),e.length>this.len&&(e=[e[0],e.pop()]),this.tickPositions=e,n&&(n=n.apply(this,[this.min,this.max])))&&(this.tickPositions=e=n),this.isLinked||(this.trimTicks(e,o,a),this.min===this.max&&c(this.min)&&!this.tickAmount&&(t=!0,this.min-=.5,this.max+=.5),this.single=t,!r&&!n&&this.adjustTickAmount())},trimTicks:function(e,t,i){var r=e[0],n=e[e.length-1],o=this.minPointOffset||0;if(t)this.min=r;else for(;this.min-o>e[0];)e.shift();if(i)this.max=n;else for(;this.max+o<e[e.length-1];)e.pop();0===e.length&&c(r)&&e.push((n+r)/2)},alignToOthers:function(){var e,t={},i=this.options;return this.chart.options.chart.alignTicks!==!1&&i.alignTicks!==!1&&Fe(this.chart[this.coll],function(i){var r=i.options,r=[i.horiz?r.left:r.top,r.width,r.height,r.pane].join(",");i.series.length&&(t[r]?e=!0:t[r]=1)}),e},getTickAmount:function(){var e=this.options,t=e.tickAmount,i=e.tickPixelInterval;!c(e.tickInterval)&&this.len<i&&!this.isRadial&&!this.isLog&&e.startOnTick&&e.endOnTick&&(t=2),!t&&this.alignToOthers()&&(t=ce(this.len/i)+1),4>t&&(this.finalTickAmt=t,t=5),this.tickAmount=t},adjustTickAmount:function(){var e=this.tickInterval,t=this.tickPositions,i=this.tickAmount,r=this.finalTickAmt,n=t&&t.length;if(i>n){for(;t.length<i;)t.push(P(t[t.length-1]+e));this.transA*=(n-1)/(i-1),this.max=t[t.length-1]}else n>i&&(this.tickInterval*=2,this.setTickPositions());if(c(r)){for(e=i=t.length;e--;)(3===r&&e%2===1||2>=r&&e>0&&i-1>e)&&t.splice(e,1);this.finalTickAmt=O}},setScale:function(){var e,t;this.oldMin=this.min,this.oldMax=this.max,this.oldAxisLength=this.len,this.setAxisSize(),t=this.len!==this.oldAxisLength,Fe(this.series,function(t){(t.isDirtyData||t.isDirty||t.xAxis.isDirty)&&(e=!0)}),t||e||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax||this.alignToOthers()?(this.resetStacks&&this.resetStacks(),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,this.isDirty||(this.isDirty=t||this.min!==this.oldMin||this.max!==this.oldMax)):this.cleanStacks&&this.cleanStacks()},setExtremes:function(e,t,i,r,n){var o=this,a=o.chart,i=Ze(i,!0);Fe(o.series,function(e){delete e.kdTree}),n=Ve(n,{min:e,max:t}),Ye(o,"setExtremes",n,function(){o.userMin=e,o.userMax=t,o.eventArgs=n,i&&a.redraw(r)})},zoom:function(e,t){var i=this.dataMin,r=this.dataMax,n=this.options,o=he(i,Ze(n.min,i)),n=de(r,Ze(n.max,r));return this.allowZoomOutside||(c(i)&&o>=e&&(e=o),c(r)&&t>=n&&(t=n)),this.displayBtn=e!==O||t!==O,this.setExtremes(e,t,!1,O,{trigger:"zoom"}),!0},setAxisSize:function(){var e=this.chart,t=this.options,i=t.offsetLeft||0,r=this.horiz,n=Ze(t.width,e.plotWidth-i+(t.offsetRight||0)),o=Ze(t.height,e.plotHeight),a=Ze(t.top,e.plotTop),t=Ze(t.left,e.plotLeft+i),i=/%$/;i.test(o)&&(o=Math.round(parseFloat(o)/100*e.plotHeight)),i.test(a)&&(a=Math.round(parseFloat(a)/100*e.plotHeight+e.plotTop)),this.left=t,this.top=a,this.width=n,this.height=o,this.bottom=e.chartHeight-o-a,this.right=e.chartWidth-n-t,this.len=de(r?n:o,0),this.pos=r?t:a},getExtremes:function(){var e=this.isLog,t=this.lin2log;return{min:e?P(t(this.min)):this.min,max:e?P(t(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(e){var t=this.isLog,i=this.lin2log,r=t?i(this.min):this.min,t=t?i(this.max):this.max;return null===e?e=0>t?t:r:r>e?e=r:e>t&&(e=t),this.translate(e,0,1,0,1)},autoLabelAlign:function(e){return e=(Ze(e,0)-90*this.side+720)%360,e>15&&165>e?"right":e>195&&345>e?"left":"center"},tickSize:function(e){var t=this.options,i=t[e+"Length"],r=Ze(t[e+"Width"],"tick"===e&&this.isXAxis?1:0);return r&&i?("inside"===t[e+"Position"]&&(i=-i),[i,r]):void 0},labelMetrics:function(){return this.chart.renderer.fontMetrics(this.options.labels.style.fontSize,this.ticks[0]&&this.ticks[0].label)},unsquish:function(){var e,t,i,r=this.options.labels,n=this.horiz,o=this.tickInterval,a=o,s=this.len/(((this.categories?1:0)+this.max-this.min)/o),l=r.rotation,d=this.labelMetrics(),h=Number.MAX_VALUE,u=function(e){return e/=s||1,e=e>1?ce(e):1,e*o};return n?(i=!r.staggerLines&&!r.step&&(c(l)?[l]:s<Ze(r.autoRotationLimit,80)&&r.autoRotation))&&Fe(i,function(i){var r;(i===l||i&&i>=-90&&90>=i)&&(t=u(ue(d.h/ge(me*i))),r=t+ue(i/360),h>r&&(h=r,e=i,a=t))}):r.step||(a=u(d.h)),this.autoRotation=i,this.labelRotation=Ze(e,l),a},getSlotWidth:function(){var e=this.chart,t=this.horiz,i=this.options.labels,r=Math.max(this.tickPositions.length-(this.categories?0:1),1),n=e.margin[3];return t&&(i.step||0)<2&&!i.rotation&&(this.staggerLines||1)*e.plotWidth/r||!t&&(n&&n-e.spacing[3]||.33*e.chartWidth)},renderUnsquish:function(){var e,t,i,n=this.chart,a=n.renderer,s=this.tickPositions,l=this.ticks,c=this.options.labels,d=this.horiz,h=this.getSlotWidth(),u=de(1,se(h-2*(c.padding||5))),p={},g=this.labelMetrics(),f=c.style.textOverflow,m=0;if(o(c.rotation)||(p.rotation=c.rotation||0),this.autoRotation)Fe(s,function(e){(e=l[e])&&e.labelLength>m&&(m=e.labelLength)}),m>u&&m>g.h?p.rotation=this.labelRotation:this.labelRotation=0;else if(h&&(e={width:u+"px"},!f))for(e.textOverflow="clip",t=s.length;!d&&t--;)i=s[t],
(u=l[i].label)&&("ellipsis"===u.styles.textOverflow?u.css({textOverflow:"clip"}):l[i].labelLength>h&&u.css({width:h+"px"}),u.getBBox().height>this.len/s.length-(g.h-g.f)&&(u.specCss={textOverflow:"ellipsis"}));p.rotation&&(e={width:(m>.5*n.chartHeight?.33*n.chartHeight:n.chartHeight)+"px"},!f)&&(e.textOverflow="ellipsis"),(this.labelAlign=c.align||this.autoLabelAlign(this.labelRotation))&&(p.align=this.labelAlign),Fe(s,function(t){var i=(t=l[t])&&t.label;i&&(i.attr(p),e&&i.css(r(e,i.specCss)),delete i.specCss,t.rotation=p.rotation)}),this.tickRotCorr=a.rotCorr(g.b,this.labelRotation||0,0!==this.side)},hasData:function(){return this.hasVisibleSeries||c(this.min)&&c(this.max)&&!!this.tickPositions},getOffset:function(){var e,t,i,r,n=this,o=n.chart,a=o.renderer,s=n.options,l=n.tickPositions,d=n.ticks,h=n.horiz,u=n.side,p=o.inverted?[1,0,3,2][u]:u,g=0,f=0,m=s.title,v=s.labels,y=0,k=n.opposite,b=o.axisOffset,o=o.clipOffset,C=[-1,1,1,-1][u],x=n.axisParent,S=this.tickSize("tick");if(e=n.hasData(),n.showAxis=t=e||Ze(s.showEmpty,!0),n.staggerLines=n.horiz&&v.staggerLines,n.axisGroup||(n.gridGroup=a.g("grid").attr({zIndex:s.gridZIndex||1}).add(x),n.axisGroup=a.g("axis").attr({zIndex:s.zIndex||2}).add(x),n.labelGroup=a.g("axis-labels").attr({zIndex:v.zIndex||7}).addClass("highcharts-"+n.coll.toLowerCase()+"-labels").add(x)),e||n.isLinked)Fe(l,function(e){d[e]?d[e].addLabel():d[e]=new E(n,e)}),n.renderUnsquish(),v.reserveSpace!==!1&&(0===u||2===u||{1:"left",3:"right"}[u]===n.labelAlign||"center"===n.labelAlign)&&Fe(l,function(e){y=de(d[e].getLabelSize(),y)}),n.staggerLines&&(y*=n.staggerLines,n.labelOffset=y*(n.opposite?-1:1));else for(r in d)d[r].destroy(),delete d[r];m&&m.text&&m.enabled!==!1&&(n.axisTitle||((r=m.textAlign)||(r=(h?{low:"left",middle:"center",high:"right"}:{low:k?"right":"left",middle:"center",high:k?"left":"right"})[m.align]),n.axisTitle=a.text(m.text,0,0,m.useHTML).attr({zIndex:7,rotation:m.rotation||0,align:r}).addClass("highcharts-"+this.coll.toLowerCase()+"-title").css(m.style).add(n.axisGroup),n.axisTitle.isNew=!0),t&&(g=n.axisTitle.getBBox()[h?"height":"width"],i=m.offset,f=c(i)?0:Ze(m.margin,h?5:10)),n.axisTitle[t?"show":"hide"](!0)),n.offset=C*Ze(s.offset,b[u]),n.tickRotCorr=n.tickRotCorr||{x:0,y:0},a=0===u?-n.labelMetrics().h:2===u?n.tickRotCorr.y:0,f=Math.abs(y)+f,y&&(f-=a,f+=C*(h?Ze(v.y,n.tickRotCorr.y+8*C):v.x)),n.axisTitleMargin=Ze(i,f),b[u]=de(b[u],n.axisTitleMargin+g+C*n.offset,f,e&&l.length&&S?S[0]:0),s=s.offset?0:2*le(s.lineWidth/2),o[p]=de(o[p],s)},getLinePath:function(e){var t=this.chart,i=this.opposite,r=this.offset,n=this.horiz,o=this.left+(i?this.width:0)+r,r=t.chartHeight-this.bottom-(i?this.height:0)+r;return i&&(e*=-1),t.renderer.crispLine(["M",n?this.left:o,n?r:this.top,"L",n?t.chartWidth-this.right:o,n?r:t.chartHeight-this.bottom],e)},getTitlePosition:function(){var e=this.horiz,t=this.left,i=this.top,r=this.len,o=this.options.title,a=e?t:i,s=this.opposite,l=this.offset,c=o.x||0,d=o.y||0,h=n(o.style.fontSize||12),r={low:a+(e?0:r),middle:a+r/2,high:a+(e?r:0)}[o.align],t=(e?i+this.height:t)+(e?1:-1)*(s?-1:1)*this.axisTitleMargin+(2===this.side?h:0);return{x:e?r+c:t+(s?this.width:0)+l+c,y:e?t+d-(s?this.height:0)+l:r+d}},render:function(){var e,t,i,r=this,n=r.chart,o=n.renderer,a=r.options,s=r.isLog,l=r.lin2log,c=r.isLinked,d=r.tickPositions,h=r.axisTitle,p=r.ticks,g=r.minorTicks,f=r.alternateBands,m=a.stackLabels,v=a.alternateGridColor,y=r.tickmarkOffset,k=a.lineWidth,b=n.hasRendered&&Ke(r.oldMin),C=r.showAxis,x=L(o.globalAnimation);r.labelEdge.length=0,r.overlap=!1,Fe([p,g,f],function(e){for(var t in e)e[t].isActive=!1}),(r.hasData()||c)&&(r.minorTickInterval&&!r.categories&&Fe(r.getMinorTickPositions(),function(e){g[e]||(g[e]=new E(r,e,"minor")),b&&g[e].isNew&&g[e].render(null,!0),g[e].render(null,!1,1)}),d.length&&(Fe(d,function(e,t){(!c||e>=r.min&&e<=r.max)&&(p[e]||(p[e]=new E(r,e)),b&&p[e].isNew&&p[e].render(t,!0,.1),p[e].render(t))}),y&&(0===r.min||r.single))&&(p[-1]||(p[-1]=new E(r,-1,null,!0)),p[-1].render(-1)),v&&Fe(d,function(e,o){i=d[o+1]!==O?d[o+1]+y:r.max-y,o%2===0&&e<r.max&&i<=r.max+(n.polar?-y:y)&&(f[e]||(f[e]=new ne.PlotLineOrBand(r)),t=e+y,f[e].options={from:s?l(t):t,to:s?l(i):i,color:v},f[e].render(),f[e].isActive=!0)}),r._addedPlotLB||(Fe((a.plotLines||[]).concat(a.plotBands||[]),function(e){r.addPlotBandOrLine(e)}),r._addedPlotLB=!0)),Fe([p,g,f],function(e){var t,i,r=[],o=x.duration;for(t in e)e[t].isActive||(e[t].render(t,!1,0),e[t].isActive=!1,r.push(t));u(function(){for(i=r.length;i--;)e[r[i]]&&!e[r[i]].isActive&&(e[r[i]].destroy(),delete e[r[i]])},e!==f&&n.hasRendered&&o?o:0)}),k&&(e=r.getLinePath(k),r.axisLine?r.axisLine.animate({d:e}):r.axisLine=o.path(e).attr({stroke:a.lineColor,"stroke-width":k,zIndex:7}).add(r.axisGroup),r.axisLine[C?"show":"hide"](!0)),h&&C&&(h[h.isNew?"attr":"animate"](r.getTitlePosition()),h.isNew=!1),m&&m.enabled&&r.renderStackTotals(),r.isDirty=!1},redraw:function(){this.visible&&(this.render(),Fe(this.plotLinesAndBands,function(e){e.render()})),Fe(this.series,function(e){e.isDirty=!0})},destroy:function(e){var t,i=this,r=i.stacks,n=i.plotLinesAndBands;e||Ge(i);for(t in r)T(r[t]),r[t]=null;for(Fe([i.ticks,i.minorTicks,i.alternateBands],function(e){T(e)}),e=n.length;e--;)n[e].destroy();Fe("stackTotalGroup,axisLine,axisTitle,axisGroup,cross,gridGroup,labelGroup".split(","),function(e){i[e]&&(i[e]=i[e].destroy())}),this.cross&&this.cross.destroy()},drawCrosshair:function(e,t){var i,r,n,o=this.crosshair;this.crosshair&&(c(t)||!Ze(o.snap,!0))!==!1?(Ze(o.snap,!0)?c(t)&&(i=this.isXAxis?t.plotX:this.len-t.plotY):i=this.horiz?e.chartX-this.pos:this.len-e.chartY+this.pos,i=this.isRadial?this.getPlotLinePath(this.isXAxis?t.x:Ze(t.stackY,t.y))||null:this.getPlotLinePath(null,null,null,null,i)||null,null===i?this.hideCrosshair():(r=this.categories&&!this.isRadial,n=Ze(o.width,r?this.transA:1),this.cross?this.cross.attr({d:i,visibility:"visible","stroke-width":n}):(r={"pointer-events":"none","stroke-width":n,stroke:o.color||(r?"rgba(155,200,255,0.2)":"#C0C0C0"),zIndex:Ze(o.zIndex,2)},o.dashStyle&&(r.dashstyle=o.dashStyle),this.cross=this.chart.renderer.path(i).attr(r).add()))):this.hideCrosshair()},hideCrosshair:function(){this.cross&&this.cross.hide()}},Ve(ot.prototype,{getPlotBandPath:function(e,t){var i=this.getPlotLinePath(t,null,null,!0),r=this.getPlotLinePath(e,null,null,!0);return r&&i?(r.flat=r.toString()===i.toString(),r.push(i[4],i[5],i[1],i[2])):r=null,r},addPlotBand:function(e){return this.addPlotBandOrLine(e,"plotBands")},addPlotLine:function(e){return this.addPlotBandOrLine(e,"plotLines")},addPlotBandOrLine:function(e,t){var i=new ne.PlotLineOrBand(this,e).render(),r=this.userOptions;return i&&(t&&(r[t]=r[t]||[],r[t].push(e)),this.plotLinesAndBands.push(i)),i},removePlotBandOrLine:function(e){for(var t=this.plotLinesAndBands,i=this.options,r=this.userOptions,n=t.length;n--;)t[n].id===e&&t[n].destroy();Fe([i.plotLines||[],r.plotLines||[],i.plotBands||[],r.plotBands||[]],function(t){for(n=t.length;n--;)t[n].id===e&&l(t,t[n])})}}),ot.prototype.getTimeTicks=function(e,t,i,r){var n,o=[],a={},s=z.global.useUTC,l=new H(t-v(t)),d=e.unitRange,h=e.count;if(c(t)){l[Z](d>=$.second?0:h*le(l.getMilliseconds()/h)),d>=$.second&&l[J](d>=$.minute?0:h*le(l.getSeconds()/h)),d>=$.minute&&l[Q](d>=$.hour?0:h*le(l[Y]()/h)),d>=$.hour&&l[ee](d>=$.day?0:h*le(l[W]()/h)),d>=$.day&&l[te](d>=$.month?1:h*le(l[q]()/h)),d>=$.month&&(l[ie](d>=$.year?0:h*le(l[V]()/h)),n=l[K]()),d>=$.year&&(n-=n%h,l[re](n)),d===$.week&&l[te](l[q]()-l[X]()+Ze(r,1)),t=1,(U||G)&&(l=l.getTime(),l=new H(l+v(l))),n=l[K]();for(var r=l.getTime(),u=l[V](),p=l[q](),g=!s||!!G,f=($.day+(s?v(l):6e4*l.getTimezoneOffset()))%$.day;i>r;)o.push(r),d===$.year?r=B(n+t*h,0):d===$.month?r=B(n,u+t*h):!g||d!==$.day&&d!==$.week?r+=d*h:r=B(n,u,p+t*h*(d===$.day?1:7)),t++;o.push(r),Fe($e(o,function(e){return d<=$.hour&&e%$.day===f}),function(e){a[e]="day"})}return o.info=Ve(e,{higherRanks:a,totalRange:d*h}),o},ot.prototype.normalizeTimeTickInterval=function(e,t){var i,r=t||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],n=r[r.length-1],o=$[n[0]],a=n[1];for(i=0;i<r.length&&(n=r[i],o=$[n[0]],a=n[1],!(r[i+1]&&e<=(o*a[a.length-1]+$[r[i+1][0]])/2));i++);return o===$.year&&5*o>e&&(a=[1,2,5]),r=b(e/o,a,"year"===n[0]?de(k(e/o),1):1),{unitRange:o,count:r,unitName:n[0]}},ot.prototype.getLogTickPositions=function(e,t,i,r){var n=this.options,o=this.len,a=this.lin2log,s=this.log2lin,l=[];if(r||(this._minorAutoInterval=null),e>=.5)e=se(e),l=this.getLinearTickPositions(e,t,i);else if(e>=.08)for(var c,d,h,u,p,o=le(t),n=e>.3?[1,2,4]:e>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];i+1>o&&!p;o++)for(d=n.length,c=0;d>c&&!p;c++)h=s(a(o)*n[c]),h>t&&(!r||i>=u)&&u!==O&&l.push(u),u>i&&(p=!0),u=h;else t=a(t),i=a(i),e=n[r?"minorTickInterval":"tickInterval"],e=Ze("auto"===e?null:e,this._minorAutoInterval,(i-t)*(n.tickPixelInterval/(r?5:1))/((r?o/this.tickPositions.length:o)||1)),e=b(e,null,k(e)),l=Be(this.getLinearTickPositions(e,t,i),s),r||(this._minorAutoInterval=e/5);return r||(this.tickInterval=e),l},ot.prototype.log2lin=function(e){return ae.log(e)/ae.LN10},ot.prototype.lin2log=function(e){return ae.pow(10,e)};var at=ne.Tooltip=function(){this.init.apply(this,arguments)};at.prototype={init:function(e,t){var i=t.borderWidth,r=t.style,o=n(r.padding);this.chart=e,this.options=t,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.label=e.renderer.label("",0,0,t.shape||"callout",null,null,t.useHTML,null,"tooltip").attr({padding:o,fill:t.backgroundColor,"stroke-width":i,r:t.borderRadius,zIndex:8}).css(r).css({padding:0}).add().attr({y:-9999}),Ne||this.label.shadow(t.shadow),this.shared=t.shared},destroy:function(){this.label&&(this.label=this.label.destroy()),clearTimeout(this.hideTimer),clearTimeout(this.tooltipTimeout)},move:function(e,t,i,r){var n=this,o=n.now,a=n.options.animation!==!1&&!n.isHidden&&(ue(e-o.x)>1||ue(t-o.y)>1),s=n.followPointer||n.len>1;Ve(o,{x:a?(2*o.x+e)/3:e,y:a?(o.y+t)/2:t,anchorX:s?O:a?(2*o.anchorX+i)/3:i,anchorY:s?O:a?(o.anchorY+r)/2:r}),n.label.attr(o),a&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){n&&n.move(e,t,i,r)},32))},hide:function(e){var t=this;clearTimeout(this.hideTimer),e=Ze(e,this.options.hideDelay,500),this.isHidden||(this.hideTimer=u(function(){t.label[e?"fadeOut":"hide"](),t.isHidden=!0},e))},getAnchor:function(e,t){var i,r,n,o=this.chart,a=o.inverted,s=o.plotTop,l=o.plotLeft,c=0,d=0,e=h(e);return i=e[0].tooltipPos,this.followPointer&&t&&(t.chartX===O&&(t=o.pointer.normalize(t)),i=[t.chartX-o.plotLeft,t.chartY-s]),i||(Fe(e,function(e){r=e.series.yAxis,n=e.series.xAxis,c+=e.plotX+(!a&&n?n.left-l:0),d+=(e.plotLow?(e.plotLow+e.plotHigh)/2:e.plotY)+(!a&&r?r.top-s:0)}),c/=e.length,d/=e.length,i=[a?o.plotWidth-d:c,this.shared&&!a&&e.length>1&&t?t.chartY-s:a?o.plotHeight-c:d]),Be(i,se)},getPosition:function(e,t,i){var r,n=this.chart,o=this.distance,a={},s=i.h||0,l=["y",n.chartHeight,t,i.plotY+n.plotTop,n.plotTop,n.plotTop+n.plotHeight],c=["x",n.chartWidth,e,i.plotX+n.plotLeft,n.plotLeft,n.plotLeft+n.plotWidth],d=!this.followPointer&&Ze(i.ttBelow,!n.inverted==!!i.negative),h=function(e,t,i,r,n,l){var c=r-o>i,h=t>r+o+i,u=r-o-i;if(r+=o,d&&h)a[e]=r;else if(!d&&c)a[e]=u;else if(c)a[e]=he(l-i,0>u-s?u:u-s);else{if(!h)return!1;a[e]=de(n,r+s+i>t?r:r+s)}},u=function(e,t,i,r){var n;return o>r||r>t-o?n=!1:a[e]=i/2>r?1:r>t-i/2?t-i-2:r-i/2,n},p=function(e){var t=l;l=c,c=t,r=e},g=function(){h.apply(0,l)!==!1?u.apply(0,c)===!1&&!r&&(p(!0),g()):r?a.x=a.y=0:(p(!0),g())};return(n.inverted||this.len>1)&&p(),g(),a},defaultFormatter:function(e){var t,i=this.points||h(this);return t=[e.tooltipFooterHeaderFormatter(i[0])],t=t.concat(e.bodyFormatter(i)),t.push(e.tooltipFooterHeaderFormatter(i[0],!0)),t.join("")},refresh:function(e,t){var i,r,n,o,a=this.chart,s=this.label,l=this.options,c={},d=[];o=l.formatter||this.defaultFormatter;var u,c=a.hoverPoints,p=this.shared;clearTimeout(this.hideTimer),this.followPointer=h(e)[0].series.tooltipOptions.followPointer,n=this.getAnchor(e,t),i=n[0],r=n[1],!p||e.series&&e.series.noSharedTooltip?c=e.getLabelConfig():(a.hoverPoints=e,c&&Fe(c,function(e){e.setState()}),Fe(e,function(e){e.setState("hover"),d.push(e.getLabelConfig())}),c={x:e[0].category,y:e[0].y},c.points=d,this.len=d.length,e=e[0]),o=o.call(c,this),c=e.series,this.distance=Ze(c.tooltipOptions.distance,16),o===!1?this.hide():(this.isHidden&&(Xe(s),s.attr("opacity",1).show()),s.attr({text:o}),u=l.borderColor||e.color||c.color||"#606060",s.attr({stroke:u}),this.updatePosition({plotX:i,plotY:r,negative:e.negative,ttBelow:e.ttBelow,h:n[2]||0}),this.isHidden=!1),Ye(a,"tooltipRefresh",{text:o,x:i+a.plotLeft,y:r+a.plotTop,borderColor:u})},updatePosition:function(e){var t=this.chart,i=this.label,i=(this.options.positioner||this.getPosition).call(this,i.width,i.height,e);this.move(se(i.x),se(i.y||0),e.plotX+t.plotLeft,e.plotY+t.plotTop)},getXDateFormat:function(e,t,i){var r,n,o,t=t.dateTimeLabelFormats,a=i&&i.closestPointRange,s={millisecond:15,second:12,minute:9,hour:6,day:3},l="millisecond";if(a){o=F("%m-%d %H:%M:%S.%L",e.x);for(n in $){if(a===$.week&&+F("%w",e.x)===i.options.startOfWeek&&"00:00:00.000"===o.substr(6)){n="week";break}if($[n]>a){n=l;break}if(s[n]&&o.substr(s[n])!=="01-01 00:00:00.000".substr(s[n]))break;"week"!==n&&(l=n)}n&&(r=t[n])}else r=t.day;return r||t.year},tooltipFooterHeaderFormatter:function(e,t){var i=t?"footer":"header",r=e.series,n=r.tooltipOptions,o=n.xDateFormat,a=r.xAxis,s=a&&"datetime"===a.options.type&&Ke(e.key),i=n[i+"Format"];return s&&!o&&(o=this.getXDateFormat(e,n,a)),s&&o&&(i=i.replace("{point.key}","{point.key:"+o+"}")),y(i,{point:e,series:r})},bodyFormatter:function(e){return Be(e,function(e){var t=e.series.tooltipOptions;return(t.pointFormatter||e.point.tooltipFormatter).call(e.point,t.pointFormat)})}};var st;_=oe&&oe.documentElement.ontouchstart!==O;var lt=ne.Pointer=function(e,t){this.init(e,t)};if(lt.prototype={init:function(e,t){var i,r=t.chart,n=r.events,o=Ne?"":r.zoomType,r=e.inverted;this.options=t,this.chart=e,this.zoomX=i=/x/.test(o),this.zoomY=o=/y/.test(o),this.zoomHor=i&&!r||o&&r,this.zoomVert=o&&!r||i&&r,this.hasZoom=i||o,this.runChartClick=n&&!!n.click,this.pinchDown=[],this.lastValidTouch={},ne.Tooltip&&t.tooltip.enabled&&(e.tooltip=new at(e,t.tooltip),this.followTouchMove=Ze(t.tooltip.followTouchMove,!0)),this.setDOMEvents()},normalize:function(t,i){var r,n,t=t||e.event;return t.target||(t.target=t.srcElement),n=t.touches?t.touches.length?t.touches.item(0):t.changedTouches[0]:t,i||(this.chartPosition=i=He(this.chart.container)),n.pageX===O?(r=de(t.x,t.clientX-i.left),n=t.y):(r=n.pageX-i.left,n=n.pageY-i.top),Ve(t,{chartX:se(r),chartY:se(n)})},getCoordinates:function(e){var t={xAxis:[],yAxis:[]};return Fe(this.chart.axes,function(i){t[i.isXAxis?"xAxis":"yAxis"].push({axis:i,value:i.toValue(e[i.horiz?"chartX":"chartY"])})}),t},runPointActions:function(e){var t,i,r,n,o=this.chart,a=o.series,s=o.tooltip,l=s?s.shared:!1,c=o.hoverPoint,d=o.hoverSeries,h=[Number.MAX_VALUE,Number.MAX_VALUE],u=[],p=[];if(!l&&!d)for(t=0;t<a.length;t++)!a[t].directTouch&&a[t].options.stickyTracking||(a=[]);if(d&&(l?d.noSharedTooltip:d.directTouch)&&c?p=[c]:(Fe(a,function(t){i=t.noSharedTooltip&&l,r=!l&&t.directTouch,t.visible&&!i&&!r&&Ze(t.options.enableMouseTracking,!0)&&(n=t.searchPoint(e,!i&&1===t.kdDimensions))&&u.push(n)}),Fe(u,function(e){e&&Fe(["dist","distX"],function(t,i){if(Ke(e[t])){var r=e[t]===h[i]&&e.series.group.zIndex>=p[i].series.group.zIndex;(e[t]<h[i]||r)&&(h[i]=e[t],p[i]=e)}})})),l)for(t=u.length;t--;)(u[t].clientX!==p[1].clientX||u[t].series.noSharedTooltip)&&u.splice(t,1);p[0]&&(p[0]!==this.prevKDPoint||s&&s.isHidden)?l&&!p[0].series.noSharedTooltip?(u.length&&s&&s.refresh(u,e),Fe(u,function(t){t.onMouseOver(e,t!==(d&&d.directTouch&&c||p[0]))}),this.prevKDPoint=p[1]):(s&&s.refresh(p[0],e),d&&d.directTouch||p[0].onMouseOver(e),this.prevKDPoint=p[0]):(a=d&&d.tooltipOptions.followPointer,s&&a&&!s.isHidden&&(a=s.getAnchor([{}],e),s.updatePosition({plotX:a[0],plotY:a[1]}))),this._onDocumentMouseMove||(this._onDocumentMouseMove=function(e){Me[st]&&Me[st].pointer.onDocumentMouseMove(e)},Ue(oe,"mousemove",this._onDocumentMouseMove)),Fe(l?u:[Ze(c,p[1])],function(t){Fe(o.axes,function(i){(!t||t.series[i.coll]===i)&&i.drawCrosshair(e,t)})})},reset:function(e,t){var i=this.chart,r=i.hoverSeries,n=i.hoverPoint,o=i.hoverPoints,a=i.tooltip,s=a&&a.shared?o:n;e&&s&&Fe(h(s),function(t){t.series.isCartesian&&void 0===t.plotX&&(e=!1)}),e?a&&s&&(a.refresh(s),n&&(n.setState(n.state,!0),Fe(i.axes,function(e){Ze(e.crosshair&&e.crosshair.snap,!0)?e.drawCrosshair(null,n):e.hideCrosshair()}))):(n&&n.onMouseOut(),o&&Fe(o,function(e){e.setState()}),r&&r.onMouseOut(),a&&a.hide(t),this._onDocumentMouseMove&&(Ge(oe,"mousemove",this._onDocumentMouseMove),this._onDocumentMouseMove=null),Fe(i.axes,function(e){e.hideCrosshair()}),this.hoverX=i.hoverPoints=i.hoverPoint=null)},scaleGroups:function(e,t){var i,r=this.chart;Fe(r.series,function(n){i=e||n.getPlotBox(),n.xAxis&&n.xAxis.zoomEnabled&&(n.group.attr(i),n.markerGroup&&(n.markerGroup.attr(i),n.markerGroup.clip(t?r.clipRect:null)),n.dataLabelsGroup&&n.dataLabelsGroup.attr(i))}),r.clipRect.attr(t||r.clipBox)},dragStart:function(e){var t=this.chart;t.mouseIsDown=e.type,t.cancelClick=!1,t.mouseDownX=this.mouseDownX=e.chartX,t.mouseDownY=this.mouseDownY=e.chartY},drag:function(e){var t,i=this.chart,r=i.options.chart,n=e.chartX,o=e.chartY,a=this.zoomHor,s=this.zoomVert,l=i.plotLeft,c=i.plotTop,d=i.plotWidth,h=i.plotHeight,u=this.selectionMarker,p=this.mouseDownX,g=this.mouseDownY,f=r.panKey&&e[r.panKey+"Key"];u&&u.touch||(l>n?n=l:n>l+d&&(n=l+d),c>o?o=c:o>c+h&&(o=c+h),this.hasDragged=Math.sqrt(Math.pow(p-n,2)+Math.pow(g-o,2)),this.hasDragged>10&&(t=i.isInsidePlot(p-l,g-c),i.hasCartesianSeries&&(this.zoomX||this.zoomY)&&t&&!f&&!u&&(this.selectionMarker=u=i.renderer.rect(l,c,a?1:d,s?1:h,0).attr({fill:r.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add()),u&&a&&(n-=p,u.attr({width:ue(n),x:(n>0?0:n)+p})),u&&s&&(n=o-g,u.attr({height:ue(n),y:(n>0?0:n)+g})),t&&!u&&r.panning&&i.pan(e,r.panning)))},drop:function(e){var t=this,i=this.chart,r=this.hasPinched;if(this.selectionMarker){var n,o={originalEvent:e,xAxis:[],yAxis:[]},a=this.selectionMarker,s=a.attr?a.attr("x"):a.x,l=a.attr?a.attr("y"):a.y,d=a.attr?a.attr("width"):a.width,h=a.attr?a.attr("height"):a.height;(this.hasDragged||r)&&(Fe(i.axes,function(i){if(i.zoomEnabled&&c(i.min)&&(r||t[{xAxis:"zoomX",yAxis:"zoomY"}[i.coll]])){var a=i.horiz,u="touchend"===e.type?i.minPixelPadding:0,p=i.toValue((a?s:l)+u),a=i.toValue((a?s+d:l+h)-u);o[i.coll].push({axis:i,min:he(p,a),max:de(p,a)}),n=!0}}),n&&Ye(i,"selection",o,function(e){i.zoom(Ve(e,r?{animation:!1}:null))})),this.selectionMarker=this.selectionMarker.destroy(),r&&this.scaleGroups()}i&&(p(i.container,{cursor:i._cursor}),i.cancelClick=this.hasDragged>10,i.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},onContainerMouseDown:function(e){e=this.normalize(e),e.preventDefault&&e.preventDefault(),this.dragStart(e)},onDocumentMouseUp:function(e){Me[st]&&Me[st].pointer.drop(e)},onDocumentMouseMove:function(e){var t=this.chart,i=this.chartPosition,e=this.normalize(e,i);i&&!this.inClass(e.target,"highcharts-tracker")&&!t.isInsidePlot(e.chartX-t.plotLeft,e.chartY-t.plotTop)&&this.reset()},onContainerMouseLeave:function(e){var t=Me[st];t&&(e.relatedTarget||e.toElement)&&(t.pointer.reset(),t.pointer.chartPosition=null)},onContainerMouseMove:function(e){var t=this.chart;c(st)&&Me[st]&&Me[st].mouseIsDown||(st=t.index),e=this.normalize(e),e.returnValue=!1,"mousedown"===t.mouseIsDown&&this.drag(e),(this.inClass(e.target,"highcharts-tracker")||t.isInsidePlot(e.chartX-t.plotLeft,e.chartY-t.plotTop))&&!t.openMenu&&this.runPointActions(e)},inClass:function(e,t){for(var i;e;){if(i=d(e,"class")){if(-1!==i.indexOf(t))return!0;if(-1!==i.indexOf("highcharts-container"))return!1}e=e.parentNode}},onTrackerMouseOut:function(e){var t=this.chart.hoverSeries,e=e.relatedTarget||e.toElement;!t||!e||t.options.stickyTracking||this.inClass(e,"highcharts-tooltip")||this.inClass(e,"highcharts-series-"+t.index)||t.onMouseOut()},onContainerClick:function(e){var t=this.chart,i=t.hoverPoint,r=t.plotLeft,n=t.plotTop,e=this.normalize(e);t.cancelClick||(i&&this.inClass(e.target,"highcharts-tracker")?(Ye(i.series,"click",Ve(e,{point:i})),t.hoverPoint&&i.firePointEvent("click",e)):(Ve(e,this.getCoordinates(e)),t.isInsidePlot(e.chartX-r,e.chartY-n)&&Ye(t,"click",e)))},setDOMEvents:function(){var e=this,t=e.chart.container;t.onmousedown=function(t){e.onContainerMouseDown(t)},t.onmousemove=function(t){e.onContainerMouseMove(t)},t.onclick=function(t){e.onContainerClick(t)},Ue(t,"mouseleave",e.onContainerMouseLeave),1===Ee&&Ue(oe,"mouseup",e.onDocumentMouseUp),_&&(t.ontouchstart=function(t){e.onContainerTouchStart(t)},t.ontouchmove=function(t){e.onContainerTouchMove(t)},1===Ee&&Ue(oe,"touchend",e.onDocumentTouchEnd))},destroy:function(){var e;Ge(this.chart.container,"mouseleave",this.onContainerMouseLeave),Ee||(Ge(oe,"mouseup",this.onDocumentMouseUp),Ge(oe,"touchend",this.onDocumentTouchEnd)),clearInterval(this.tooltipTimeout);for(e in this)this[e]=null}},Ve(ne.Pointer.prototype,{pinchTranslate:function(e,t,i,r,n,o){(this.zoomHor||this.pinchHor)&&this.pinchTranslateDirection(!0,e,t,i,r,n,o),(this.zoomVert||this.pinchVert)&&this.pinchTranslateDirection(!1,e,t,i,r,n,o)},pinchTranslateDirection:function(e,t,i,r,n,o,a,s){var l,c,d,h=this.chart,u=e?"x":"y",p=e?"X":"Y",g="chart"+p,f=e?"width":"height",m=h["plot"+(e?"Left":"Top")],v=s||1,y=h.inverted,k=h.bounds[e?"h":"v"],b=1===t.length,C=t[0][g],x=i[0][g],S=!b&&t[1][g],T=!b&&i[1][g],i=function(){!b&&ue(C-S)>20&&(v=s||ue(x-T)/ue(C-S)),c=(m-x)/v+C,l=h["plot"+(e?"Width":"Height")]/v};i(),t=c,t<k.min?(t=k.min,d=!0):t+l>k.max&&(t=k.max-l,d=!0),d?(x-=.8*(x-a[u][0]),b||(T-=.8*(T-a[u][1])),i()):a[u]=[x,T],y||(o[u]=c-m,o[f]=l),o=y?1/v:v,n[f]=l,n[u]=t,r[y?e?"scaleY":"scaleX":"scale"+p]=v,r["translate"+p]=o*m+(x-o*C)},pinch:function(e){var t=this,i=t.chart,r=t.pinchDown,n=e.touches,o=n.length,a=t.lastValidTouch,s=t.hasZoom,l=t.selectionMarker,c={},d=1===o&&(t.inClass(e.target,"highcharts-tracker")&&i.runTrackerClick||t.runChartClick),h={};o>1&&(t.initiated=!0),s&&t.initiated&&!d&&e.preventDefault(),Be(n,function(e){return t.normalize(e)}),"touchstart"===e.type?(Fe(n,function(e,t){r[t]={chartX:e.chartX,chartY:e.chartY}}),a.x=[r[0].chartX,r[1]&&r[1].chartX],a.y=[r[0].chartY,r[1]&&r[1].chartY],Fe(i.axes,function(e){if(e.zoomEnabled){var t=i.bounds[e.horiz?"h":"v"],r=e.minPixelPadding,n=e.toPixels(Ze(e.options.min,e.dataMin)),o=e.toPixels(Ze(e.options.max,e.dataMax)),a=he(n,o),n=de(n,o);t.min=he(e.pos,a-r),t.max=de(e.pos+e.len,n+r)}}),t.res=!0):r.length&&(l||(t.selectionMarker=l=Ve({destroy:Ae,touch:!0},i.plotBox)),t.pinchTranslate(r,n,c,l,h,a),t.hasPinched=s,t.scaleGroups(c,h),!s&&t.followTouchMove&&1===o?this.runPointActions(t.normalize(e)):t.res&&(t.res=!1,this.reset(!1,0)))},touch:function(e,t){var i,r=this.chart;st=r.index,1===e.touches.length?(e=this.normalize(e),r.isInsidePlot(e.chartX-r.plotLeft,e.chartY-r.plotTop)&&!r.openMenu?(t&&this.runPointActions(e),"touchmove"===e.type&&(r=this.pinchDown,i=r[0]?Math.sqrt(Math.pow(r[0].chartX-e.chartX,2)+Math.pow(r[0].chartY-e.chartY,2))>=4:!1),Ze(i,!0)&&this.pinch(e)):t&&this.reset()):2===e.touches.length&&this.pinch(e)},onContainerTouchStart:function(e){this.touch(e,!0)},onContainerTouchMove:function(e){this.touch(e)},onDocumentTouchEnd:function(e){Me[st]&&Me[st].pointer.drop(e)}}),e.PointerEvent||e.MSPointerEvent){var ct={},dt=!!e.PointerEvent,ht=function(){var e,t=[];t.item=function(e){return this[e]};for(e in ct)ct.hasOwnProperty(e)&&t.push({pageX:ct[e].pageX,pageY:ct[e].pageY,target:ct[e].target});return t},ut=function(e,t,i,r){"touch"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_TOUCH||!Me[st]||(r(e),r=Me[st].pointer,r[t]({type:i,target:e.currentTarget,preventDefault:Ae,touches:ht()}))};Ve(lt.prototype,{onContainerPointerDown:function(e){ut(e,"onContainerTouchStart","touchstart",function(e){ct[e.pointerId]={pageX:e.pageX,pageY:e.pageY,target:e.currentTarget}})},onContainerPointerMove:function(e){ut(e,"onContainerTouchMove","touchmove",function(e){ct[e.pointerId]={pageX:e.pageX,pageY:e.pageY},ct[e.pointerId].target||(ct[e.pointerId].target=e.currentTarget)})},onDocumentPointerUp:function(e){ut(e,"onDocumentTouchEnd","touchend",function(e){delete ct[e.pointerId]})},batchMSEvents:function(e){e(this.chart.container,dt?"pointerdown":"MSPointerDown",this.onContainerPointerDown),e(this.chart.container,dt?"pointermove":"MSPointerMove",this.onContainerPointerMove),e(oe,dt?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}}),Je(lt.prototype,"init",function(e,t,i){e.call(this,t,i),this.hasZoom&&p(t.container,{"-ms-touch-action":"none","touch-action":"none"})}),Je(lt.prototype,"setDOMEvents",function(e){e.apply(this),(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(Ue)}),Je(lt.prototype,"destroy",function(e){this.batchMSEvents(Ge),e.call(this)})}var pt=ne.Legend=function(e,t){this.init(e,t)};pt.prototype={init:function(e,t){var i=this,n=t.itemStyle,o=t.itemMarginTop||0;this.options=t,t.enabled&&(i.itemStyle=n,i.itemHiddenStyle=r(n,t.itemHiddenStyle),i.itemMarginTop=o,i.padding=n=Ze(t.padding,8),i.initialItemX=n,i.initialItemY=n-5,i.maxItemWidth=0,i.chart=e,i.itemHeight=0,i.symbolWidth=Ze(t.symbolWidth,16),i.pages=[],i.render(),Ue(i.chart,"endResize",function(){i.positionCheckboxes()}))},colorizeItem:function(e,t){var i,r=this.options,n=e.legendItem,o=e.legendLine,a=e.legendSymbol,s=this.itemHiddenStyle.color,r=t?r.itemStyle.color:s,l=t?e.legendColor||e.color||"#CCC":s,s=e.options&&e.options.marker,c={fill:l};if(n&&n.css({fill:r,color:r}),o&&o.attr({stroke:l}),a){if(s&&a.isMarker)for(i in c.stroke=l,s=e.convertAttribs(s))n=s[i],n!==O&&(c[i]=n);a.attr(c)}},positionItem:function(e){var t=this.options,i=t.symbolPadding,t=!t.rtl,r=e._legendItemPos,n=r[0],r=r[1],o=e.checkbox;(e=e.legendGroup)&&e.element&&e.translate(t?n:this.legendWidth-n-2*i-4,r),o&&(o.x=n,o.y=r)},destroyItem:function(e){var t=e.checkbox;Fe(["legendItem","legendLine","legendSymbol","legendGroup"],function(t){e[t]&&(e[t]=e[t].destroy())}),t&&w(e.checkbox)},destroy:function(){var e=this.group,t=this.box;t&&(this.box=t.destroy()),e&&(this.group=e.destroy())},positionCheckboxes:function(e){var t,i=this.group.alignAttr,r=this.clipHeight||this.legendHeight,n=this.titleHeight;i&&(t=i.translateY,Fe(this.allItems,function(o){var a,s=o.checkbox;s&&(a=t+n+s.y+(e||0)+3,p(s,{left:i.translateX+o.checkboxOffset+s.x-20+"px",top:a+"px",display:a>t-6&&t+r-6>a?"":"none"}))}))},renderTitle:function(){var e=this.padding,t=this.options.title,i=0;t.text&&(this.title||(this.title=this.chart.renderer.label(t.text,e-3,e-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(t.style).add(this.group)),e=this.title.getBBox(),i=e.height,this.offsetWidth=e.width,this.contentGroup.attr({translateY:i})),this.titleHeight=i},setText:function(e){var t=this.options;e.legendItem.attr({text:t.labelFormat?y(t.labelFormat,e):t.labelFormatter.call(e)})},renderItem:function(e){var t=this.chart,i=t.renderer,n=this.options,o="horizontal"===n.layout,a=this.symbolWidth,s=n.symbolPadding,l=this.itemStyle,c=this.itemHiddenStyle,d=this.padding,h=o?Ze(n.itemDistance,20):0,u=!n.rtl,p=n.width,g=n.itemMarginBottom||0,f=this.itemMarginTop,m=this.initialItemX,v=e.legendItem,y=e.series&&e.series.drawLegendSymbol?e.series:e,k=y.options,k=this.createCheckboxForItem&&k&&k.showCheckbox,b=n.useHTML;v||(e.legendGroup=i.g("legend-item").attr({zIndex:1}).add(this.scrollGroup),e.legendItem=v=i.text("",u?a+s:-s,this.baseline||0,b).css(r(e.visible?l:c)).attr({align:u?"left":"right",zIndex:2}).add(e.legendGroup),this.baseline||(this.fontMetrics=i.fontMetrics(l.fontSize,v),this.baseline=this.fontMetrics.f+3+f,v.attr("y",this.baseline)),y.drawLegendSymbol(this,e),this.setItemEvents&&this.setItemEvents(e,v,b,l,c),k&&this.createCheckboxForItem(e)),this.colorizeItem(e,e.visible),this.setText(e),i=v.getBBox(),a=e.checkboxOffset=n.itemWidth||e.legendItemWidth||a+s+i.width+h+(k?20:0),this.itemHeight=s=se(e.legendItemHeight||i.height),o&&this.itemX-m+a>(p||t.chartWidth-2*d-m-n.x)&&(this.itemX=m,this.itemY+=f+this.lastLineHeight+g,this.lastLineHeight=0),this.maxItemWidth=de(this.maxItemWidth,a),this.lastItemY=f+this.itemY+g,this.lastLineHeight=de(s,this.lastLineHeight),e._legendItemPos=[this.itemX,this.itemY],o?this.itemX+=a:(this.itemY+=f+s+g,this.lastLineHeight=s),this.offsetWidth=p||de((o?this.itemX-m-h:a)+d,this.offsetWidth)},getAllItems:function(){var e=[];return Fe(this.chart.series,function(t){var i=t.options;Ze(i.showInLegend,c(i.linkedTo)?!1:O,!0)&&(e=e.concat(t.legendItems||("point"===i.legendType?t.data:t)))}),e},adjustMargins:function(e,t){var i=this.chart,r=this.options,n=r.align.charAt(0)+r.verticalAlign.charAt(0)+r.layout.charAt(0);this.display&&!r.floating&&Fe([/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(o,a){o.test(n)&&!c(e[a])&&(i[Re[a]]=de(i[Re[a]],i.legend[(a+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][a]*r[a%2?"x":"y"]+Ze(r.margin,12)+t[a]))})},render:function(){var e,t,i,r,n=this,o=n.chart,a=o.renderer,s=n.group,l=n.box,c=n.options,d=n.padding,h=c.borderWidth,u=c.backgroundColor;n.itemX=n.initialItemX,n.itemY=n.initialItemY,n.offsetWidth=0,n.lastItemY=0,s||(n.group=s=a.g("legend").attr({zIndex:7}).add(),n.contentGroup=a.g().attr({zIndex:1}).add(s),n.scrollGroup=a.g().add(n.contentGroup)),n.renderTitle(),e=n.getAllItems(),C(e,function(e,t){return(e.options&&e.options.legendIndex||0)-(t.options&&t.options.legendIndex||0)}),c.reversed&&e.reverse(),n.allItems=e,n.display=t=!!e.length,n.lastLineHeight=0,Fe(e,function(e){n.renderItem(e)}),i=(c.width||n.offsetWidth)+d,r=n.lastItemY+n.lastLineHeight+n.titleHeight,r=n.handleOverflow(r),r+=d,(h||u)&&(l?i>0&&r>0&&(l[l.isNew?"attr":"animate"](l.crisp({width:i,height:r})),l.isNew=!1):(n.box=l=a.rect(0,0,i,r,c.borderRadius,h||0).attr({stroke:c.borderColor,"stroke-width":h||0,fill:u||"none"}).add(s).shadow(c.shadow),l.isNew=!0),l[t?"show":"hide"]()),n.legendWidth=i,n.legendHeight=r,Fe(e,function(e){n.positionItem(e)}),t&&s.align(Ve({width:i,height:r},c),!0,"spacingBox"),o.isResizing||this.positionCheckboxes()},handleOverflow:function(e){var t,i,r=this,n=this.chart,o=n.renderer,a=this.options,s=a.y,s=n.spacingBox.height+("top"===a.verticalAlign?-s:s)-this.padding,l=a.maxHeight,c=this.clipRect,d=a.navigation,h=Ze(d.animation,!0),u=d.arrowSize||12,p=this.nav,g=this.pages,f=this.padding,m=this.allItems,v=function(e){c.attr({height:e}),r.contentGroup.div&&(r.contentGroup.div.style.clip="rect("+f+"px,9999px,"+(f+e)+"px,0)")};return"horizontal"===a.layout&&(s/=2),l&&(s=he(s,l)),g.length=0,e>s&&d.enabled!==!1?(this.clipHeight=t=de(s-20-this.titleHeight-f,0),this.currentPage=Ze(this.currentPage,1),this.fullHeight=e,Fe(m,function(e,r){var n=e._legendItemPos[1],o=se(e.legendItem.getBBox().height),a=g.length;(!a||n-g[a-1]>t&&(i||n)!==g[a-1])&&(g.push(i||n),a++),r===m.length-1&&n+o-g[a-1]>t&&g.push(n),n!==i&&(i=n)}),c||(c=r.clipRect=o.clipRect(0,f,9999,0),r.contentGroup.clip(c)),v(t),p||(this.nav=p=o.g().attr({zIndex:1}).add(this.group),this.up=o.symbol("triangle",0,0,u,u).on("click",function(){r.scroll(-1,h)}).add(p),this.pager=o.text("",15,10).css(d.style).add(p),this.down=o.symbol("triangle-down",0,0,u,u).on("click",function(){r.scroll(1,h)}).add(p)),r.scroll(0),e=s):p&&(v(n.chartHeight),p.hide(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),e},scroll:function(e,t){var i=this.pages,r=i.length,n=this.currentPage+e,o=this.clipHeight,a=this.options.navigation,s=a.activeColor,a=a.inactiveColor,l=this.pager,c=this.padding;n>r&&(n=r),n>0&&(t!==O&&N(t,this.chart),this.nav.attr({translateX:c,translateY:o+this.padding+7+this.titleHeight,visibility:"visible"
}),this.up.attr({fill:1===n?a:s}).css({cursor:1===n?"default":"pointer"}),l.attr({text:n+"/"+r}),this.down.attr({x:18+this.pager.getBBox().width,fill:n===r?a:s}).css({cursor:n===r?"default":"pointer"}),i=-i[n-1]+this.initialItemY,this.scrollGroup.animate({translateY:i}),this.currentPage=n,this.positionCheckboxes(i))}},it=ne.LegendSymbolMixin={drawRectangle:function(e,t){var i=e.options.symbolHeight||e.fontMetrics.f;t.legendSymbol=this.chart.renderer.rect(0,e.baseline-i+1,e.symbolWidth,i,e.options.symbolRadius||0).attr({zIndex:3}).add(t.legendGroup)},drawLineMarker:function(e){var t,i=this.options,r=i.marker,n=e.symbolWidth,o=this.chart.renderer,a=this.legendGroup,e=e.baseline-se(.3*e.fontMetrics.b);i.lineWidth&&(t={"stroke-width":i.lineWidth},i.dashStyle&&(t.dashstyle=i.dashStyle),this.legendLine=o.path(["M",0,e,"L",n,e]).attr(t).add(a)),r&&r.enabled!==!1&&(i=r.radius,this.legendSymbol=r=o.symbol(this.symbol,n/2-i,e-i,2*i,2*i,r).add(a),r.isMarker=!0)}},(/Trident\/7\.0/.test(ve)||xe)&&Je(pt.prototype,"positionItem",function(e,t){var i=this,r=function(){t._legendItemPos&&e.call(i,t)};r(),setTimeout(r)});var gt=ne.Chart=function(){this.getArgs.apply(this,arguments)};ne.chart=function(e,t,i){return new gt(e,t,i)},gt.prototype={callbacks:[],getArgs:function(){var e=[].slice.call(arguments);(o(e[0])||e[0].nodeName)&&(this.renderTo=e.shift()),this.init(e[0],e[1])},init:function(e,t){var i,n=e.series;e.series=null,i=r(z,e),i.series=e.series=n,this.userOptions=e,n=i.chart,this.margin=this.splashArray("margin",n),this.spacing=this.splashArray("spacing",n);var o=n.events;this.bounds={h:{},v:{}},this.callback=t,this.isResizing=0,this.options=i,this.axes=[],this.series=[],this.hasCartesianSeries=n.showAxes;var a,s=this;if(s.index=Me.length,Me.push(s),Ee++,n.reflow!==!1&&Ue(s,"load",function(){s.initReflow()}),o)for(a in o)Ue(s,a,o[a]);s.xAxis=[],s.yAxis=[],s.animation=Ne?!1:Ze(n.animation,!0),s.pointCount=s.colorCounter=s.symbolCounter=0,s.firstRender()},initSeries:function(e){var i=this.options.chart;return(i=_e[e.type||i.type||i.defaultSeriesType])||t(17,!0),i=new i,i.init(this,e),i},isInsidePlot:function(e,t,i){var r=i?t:e,e=i?e:t;return r>=0&&r<=this.plotWidth&&e>=0&&e<=this.plotHeight},redraw:function(e){var t,i,r=this.axes,n=this.series,o=this.pointer,a=this.legend,s=this.isDirtyLegend,l=this.hasCartesianSeries,c=this.isDirtyBox,d=n.length,h=d,u=this.renderer,p=u.isHidden(),g=[];for(N(e,this),p&&this.cloneRenderTo(),this.layOutTitles();h--;)if(e=n[h],e.options.stacking&&(t=!0,e.isDirty)){i=!0;break}if(i)for(h=d;h--;)e=n[h],e.options.stacking&&(e.isDirty=!0);Fe(n,function(e){e.isDirty&&"point"===e.options.legendType&&(e.updateTotals&&e.updateTotals(),s=!0),e.isDirtyData&&Ye(e,"updatedData")}),s&&a.options.enabled&&(a.render(),this.isDirtyLegend=!1),t&&this.getStacks(),l&&!this.isResizing&&(this.maxTicks=null,Fe(r,function(e){e.setScale()})),this.getMargins(),l&&(Fe(r,function(e){e.isDirty&&(c=!0)}),Fe(r,function(e){var i=e.min+","+e.max;e.extKey!==i&&(e.extKey=i,g.push(function(){Ye(e,"afterSetExtremes",Ve(e.eventArgs,e.getExtremes())),delete e.eventArgs})),(c||t)&&e.redraw()})),c&&this.drawChartBox(),Fe(n,function(e){e.isDirty&&e.visible&&(!e.isCartesian||e.xAxis)&&e.redraw()}),o&&o.reset(!0),u.draw(),Ye(this,"redraw"),p&&this.cloneRenderTo(!0),Fe(g,function(e){e.call()})},get:function(e){var t,i,r=this.axes,n=this.series;for(t=0;t<r.length;t++)if(r[t].options.id===e)return r[t];for(t=0;t<n.length;t++)if(n[t].options.id===e)return n[t];for(t=0;t<n.length;t++)for(i=n[t].points||[],r=0;r<i.length;r++)if(i[r].id===e)return i[r];return null},getAxes:function(){var e=this,t=this.options,i=t.xAxis=h(t.xAxis||{}),t=t.yAxis=h(t.yAxis||{});Fe(i,function(e,t){e.index=t,e.isX=!0}),Fe(t,function(e,t){e.index=t}),i=i.concat(t),Fe(i,function(t){new ot(e,t)})},getSelectedPoints:function(){var e=[];return Fe(this.series,function(t){e=e.concat($e(t.points||[],function(e){return e.selected}))}),e},getSelectedSeries:function(){return $e(this.series,function(e){return e.selected})},setTitle:function(e,t,i){var n,o,a=this,s=a.options;o=s.title=r(s.title,e),n=s.subtitle=r(s.subtitle,t),s=n,Fe([["title",e,o],["subtitle",t,s]],function(e){var t=e[0],i=a[t],r=e[1],e=e[2];i&&r&&(a[t]=i=i.destroy()),e&&e.text&&!i&&(a[t]=a.renderer.text(e.text,0,0,e.useHTML).attr({align:e.align,"class":"highcharts-"+t,zIndex:e.zIndex||4}).css(e.style).add())}),a.layOutTitles(i)},layOutTitles:function(e){var t=0,i=this.title,r=this.subtitle,n=this.options,o=n.title,n=n.subtitle,a=this.renderer,s=this.spacingBox;!i||(i.css({width:(o.width||s.width+o.widthAdjust)+"px"}).align(Ve({y:a.fontMetrics(o.style.fontSize,i).b-3},o),!1,s),o.floating||o.verticalAlign)||(t=i.getBBox().height),r&&(r.css({width:(n.width||s.width+n.widthAdjust)+"px"}).align(Ve({y:t+(o.margin-13)+a.fontMetrics(n.style.fontSize,i).b},n),!1,s),!n.floating&&!n.verticalAlign&&(t=ce(t+r.getBBox().height))),i=this.titleOffset!==t,this.titleOffset=t,!this.isDirtyBox&&i&&(this.isDirtyBox=i,this.hasRendered&&Ze(e,!0)&&this.isDirtyBox&&this.redraw())},getChartSize:function(){var e=this.options.chart,t=e.width,e=e.height,i=this.renderToClone||this.renderTo;c(t)||(this.containerWidth=je(i,"width")),c(e)||(this.containerHeight=je(i,"height")),this.chartWidth=de(0,t||this.containerWidth||600),this.chartHeight=de(0,Ze(e,this.containerHeight>19?this.containerHeight:400))},cloneRenderTo:function(e){var t=this.renderToClone,i=this.container;e?t&&(this.renderTo.appendChild(i),w(t),delete this.renderToClone):(i&&i.parentNode===this.renderTo&&this.renderTo.removeChild(i),this.renderToClone=t=this.renderTo.cloneNode(0),p(t,{position:"absolute",top:"-9999px",display:"block"}),t.style.setProperty&&t.style.setProperty("display","block","important"),oe.body.appendChild(t),i&&t.appendChild(i))},getContainer:function(){var e,i,r,a=this.options,s=a.chart;e=this.renderTo;var l="highcharts-"+Ie++;e||(this.renderTo=e=s.renderTo),o(e)&&(this.renderTo=e=oe.getElementById(e)),e||t(13,!0),i=n(d(e,"data-highcharts-chart")),Ke(i)&&Me[i]&&Me[i].hasRendered&&Me[i].destroy(),d(e,"data-highcharts-chart",this.index),e.innerHTML="",!s.skipClone&&!e.offsetWidth&&this.cloneRenderTo(),this.getChartSize(),i=this.chartWidth,r=this.chartHeight,this.container=e=g(De,{className:"highcharts-container"+(s.className?" "+s.className:""),id:l},Ve({position:"relative",overflow:"hidden",width:i+"px",height:r+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},s.style),this.renderToClone||e),this._cursor=e.style.cursor,this.renderer=new(ne[s.renderer]||R)(e,i,r,s.style,s.forExport,a.exporting&&a.exporting.allowHTML),Ne&&this.renderer.create(this,e,i,r),this.renderer.chartIndex=this.index},getMargins:function(e){var t=this.spacing,i=this.margin,r=this.titleOffset;this.resetMargins(),r&&!c(i[0])&&(this.plotTop=de(this.plotTop,r+this.options.title.margin+t[0])),this.legend.adjustMargins(i,t),this.extraBottomMargin&&(this.marginBottom+=this.extraBottomMargin),this.extraTopMargin&&(this.plotTop+=this.extraTopMargin),e||this.getAxisMargins()},getAxisMargins:function(){var e=this,t=e.axisOffset=[0,0,0,0],i=e.margin;e.hasCartesianSeries&&Fe(e.axes,function(e){e.visible&&e.getOffset()}),Fe(Re,function(r,n){c(i[n])||(e[r]+=t[n])}),e.setChartSize()},reflow:function(t){var i=this,r=i.options.chart,n=i.renderTo,o=r.width||je(n,"width"),a=r.height||je(n,"height"),r=t?t.target:e;i.hasUserSize||i.isPrinting||!o||!a||r!==e&&r!==oe||(o===i.containerWidth&&a===i.containerHeight||(clearTimeout(i.reflowTimeout),i.reflowTimeout=u(function(){i.container&&(i.setSize(o,a,!1),i.hasUserSize=null)},t?100:0)),i.containerWidth=o,i.containerHeight=a)},initReflow:function(){var t=this,i=function(e){t.reflow(e)};Ue(e,"resize",i),Ue(t,"destroy",function(){Ge(e,"resize",i)})},setSize:function(e,t,i){var r,n,o=this,a=o.renderer;o.isResizing+=1,N(i,o),o.oldChartHeight=o.chartHeight,o.oldChartWidth=o.chartWidth,c(e)&&(o.chartWidth=r=de(0,se(e)),o.hasUserSize=!!r),c(t)&&(o.chartHeight=n=de(0,se(t))),e=a.globalAnimation,(e?We:p)(o.container,{width:r+"px",height:n+"px"},e),o.setChartSize(!0),a.setSize(r,n,i),o.maxTicks=null,Fe(o.axes,function(e){e.isDirty=!0,e.setScale()}),Fe(o.series,function(e){e.isDirty=!0}),o.isDirtyLegend=!0,o.isDirtyBox=!0,o.layOutTitles(),o.getMargins(),o.redraw(i),o.oldChartHeight=null,Ye(o,"resize"),u(function(){o&&Ye(o,"endResize",null,function(){o.isResizing-=1})},L(e).duration)},setChartSize:function(e){var t,i,r,n,o=this.inverted,a=this.renderer,s=this.chartWidth,l=this.chartHeight,c=this.options.chart,d=this.spacing,h=this.clipOffset;this.plotLeft=t=se(this.plotLeft),this.plotTop=i=se(this.plotTop),this.plotWidth=r=de(0,se(s-t-this.marginRight)),this.plotHeight=n=de(0,se(l-i-this.marginBottom)),this.plotSizeX=o?n:r,this.plotSizeY=o?r:n,this.plotBorderWidth=c.plotBorderWidth||0,this.spacingBox=a.spacingBox={x:d[3],y:d[0],width:s-d[3]-d[1],height:l-d[0]-d[2]},this.plotBox=a.plotBox={x:t,y:i,width:r,height:n},s=2*le(this.plotBorderWidth/2),o=ce(de(s,h[3])/2),a=ce(de(s,h[0])/2),this.clipBox={x:o,y:a,width:le(this.plotSizeX-de(s,h[1])/2-o),height:de(0,le(this.plotSizeY-de(s,h[2])/2-a))},e||Fe(this.axes,function(e){e.setAxisSize(),e.setAxisTranslation()})},resetMargins:function(){var e=this;Fe(Re,function(t,i){e[t]=Ze(e.margin[i],e.spacing[i])}),e.axisOffset=[0,0,0,0],e.clipOffset=[0,0,0,0]},drawChartBox:function(){var e,t=this.options.chart,i=this.renderer,r=this.chartWidth,n=this.chartHeight,o=this.chartBackground,a=this.plotBackground,s=this.plotBorder,l=this.plotBGImage,c=t.borderWidth||0,d=t.backgroundColor,h=t.plotBackgroundColor,u=t.plotBackgroundImage,p=t.plotBorderWidth||0,g=this.plotLeft,f=this.plotTop,m=this.plotWidth,v=this.plotHeight,y=this.plotBox,k=this.clipRect,b=this.clipBox;e=c+(t.shadow?8:0),(c||d)&&(o?o.animate(o.crisp({width:r-e,height:n-e})):(o={fill:d||"none"},c&&(o.stroke=t.borderColor,o["stroke-width"]=c),this.chartBackground=i.rect(e/2,e/2,r-e,n-e,t.borderRadius,c).attr(o).addClass("highcharts-background").add().shadow(t.shadow))),h&&(a?a.animate(y):this.plotBackground=i.rect(g,f,m,v,0).attr({fill:h}).add().shadow(t.plotShadow)),u&&(l?l.animate(y):this.plotBGImage=i.image(u,g,f,m,v).add()),k?k.animate({width:b.width,height:b.height}):this.clipRect=i.clipRect(b),p&&(s?(s.strokeWidth=-p,s.animate(s.crisp({x:g,y:f,width:m,height:v}))):this.plotBorder=i.rect(g,f,m,v,0,-p).attr({stroke:t.plotBorderColor,"stroke-width":p,fill:"none",zIndex:1}).add()),this.isDirtyBox=!1},propFromSeries:function(){var e,t,i,r=this,n=r.options.chart,o=r.options.series;Fe(["inverted","angular","polar"],function(a){for(e=_e[n.type||n.defaultSeriesType],i=r[a]||n[a]||e&&e.prototype[a],t=o&&o.length;!i&&t--;)(e=_e[o[t].type])&&e.prototype[a]&&(i=!0);r[a]=i})},linkSeries:function(){var e=this,t=e.series;Fe(t,function(e){e.linkedSeries.length=0}),Fe(t,function(t){var i=t.options.linkedTo;o(i)&&(i=":previous"===i?e.series[t.index-1]:e.get(i))&&(i.linkedSeries.push(t),t.linkedParent=i,t.visible=Ze(t.options.visible,i.options.visible,t.visible))})},renderSeries:function(){Fe(this.series,function(e){e.translate(),e.render()})},renderLabels:function(){var e=this,t=e.options.labels;t.items&&Fe(t.items,function(i){var r=Ve(t.style,i.style),o=n(r.left)+e.plotLeft,a=n(r.top)+e.plotTop+12;delete r.left,delete r.top,e.renderer.text(i.html,o,a).attr({zIndex:2}).css(r).add()})},render:function(){var e,t,i,r,n=this.axes,o=this.renderer,a=this.options;this.setTitle(),this.legend=new pt(this,a.legend),this.getStacks&&this.getStacks(),this.getMargins(!0),this.setChartSize(),e=this.plotWidth,t=this.plotHeight-=21,Fe(n,function(e){e.setScale()}),this.getAxisMargins(),i=e/this.plotWidth>1.1,r=t/this.plotHeight>1.05,(i||r)&&(this.maxTicks=null,Fe(n,function(e){(e.horiz&&i||!e.horiz&&r)&&e.setTickInterval(!0)}),this.getMargins()),this.drawChartBox(),this.hasCartesianSeries&&Fe(n,function(e){e.visible&&e.render()}),this.seriesGroup||(this.seriesGroup=o.g("series-group").attr({zIndex:3}).add()),this.renderSeries(),this.renderLabels(),this.showCredits(a.credits),this.hasRendered=!0},showCredits:function(t){t.enabled&&!this.credits&&(this.credits=this.renderer.text(t.text,0,0).on("click",function(){t.href&&(e.location.href=t.href)}).attr({align:t.position.align,zIndex:8}).css(t.style).add().align(t.position))},destroy:function(){var e,t=this,i=t.axes,r=t.series,n=t.container,o=n&&n.parentNode;for(Ye(t,"destroy"),Me[t.index]=O,Ee--,t.renderTo.removeAttribute("data-highcharts-chart"),Ge(t),e=i.length;e--;)i[e]=i[e].destroy();for(e=r.length;e--;)r[e]=r[e].destroy();Fe("title,subtitle,chartBackground,plotBackground,plotBGImage,plotBorder,seriesGroup,clipRect,credits,pointer,scroller,rangeSelector,legend,resetZoomButton,tooltip,renderer".split(","),function(e){var i=t[e];i&&i.destroy&&(t[e]=i.destroy())}),n&&(n.innerHTML="",Ge(n),o&&w(n));for(e in t)delete t[e]},isReadyToRender:function(){var t=this;return!we&&e==e.top&&"complete"!==oe.readyState||Ne&&!e.canvg?(Ne?nt.push(function(){t.firstRender()},t.options.global.canvasToolsURL):oe.attachEvent("onreadystatechange",function(){oe.detachEvent("onreadystatechange",t.firstRender),"complete"===oe.readyState&&t.firstRender()}),!1):!0},firstRender:function(){var e=this,t=e.options;e.isReadyToRender()&&(e.getContainer(),Ye(e,"init"),e.resetMargins(),e.setChartSize(),e.propFromSeries(),e.getAxes(),Fe(t.series||[],function(t){e.initSeries(t)}),e.linkSeries(),Ye(e,"beforeRender"),ne.Pointer&&(e.pointer=new lt(e,t)),e.render(),e.renderer.draw(),!e.renderer.imgCount&&e.onload&&e.onload(),e.cloneRenderTo(!0))},onload:function(){var e=this;Fe([this.callback].concat(this.callbacks),function(t){t&&void 0!==e.index&&t.apply(e,[e])}),Ye(e,"load"),this.onload=null},splashArray:function(e,t){var i=t[e],i=a(i)?i:[i,i,i,i];return[Ze(t[e+"Top"],i[0]),Ze(t[e+"Right"],i[1]),Ze(t[e+"Bottom"],i[2]),Ze(t[e+"Left"],i[3])]}};var rt=ne.CenteredSeriesMixin={getCenter:function(){var e,t,i=this.options,r=this.chart,n=2*(i.slicedOffset||0),o=r.plotWidth-2*n,r=r.plotHeight-2*n,a=i.center,a=[Ze(a[0],"50%"),Ze(a[1],"50%"),i.size||"100%",i.innerSize||0],s=he(o,r);for(e=0;4>e;++e)t=a[e],i=2>e||2===e&&/%$/.test(t),a[e]=(/%$/.test(t)?[o,r,s,a[2]][e]*parseFloat(t)/100:parseFloat(t))+(i?n:0);return a[3]>a[2]&&(a[3]=a[2]),a}},ft=function(){};ft.prototype={init:function(e,t,i){return this.series=e,this.color=e.color,this.applyOptions(t,i),this.pointAttr={},e.options.colorByPoint&&(t=e.options.colors||e.chart.options.colors,this.color=this.color||t[e.colorCounter++],e.colorCounter===t.length)&&(e.colorCounter=0),e.chart.pointCount++,this},applyOptions:function(e,t){var i=this.series,r=i.options.pointValKey||i.pointValKey,e=ft.prototype.optionsToObject.call(this,e);return Ve(this,e),this.options=this.options?Ve(this.options,e):e,r&&(this.y=this[r]),this.isNull=null===this.x||null===this.y,void 0===this.x&&i&&(this.x=void 0===t?i.autoIncrement():t),this},optionsToObject:function(e){var t={},i=this.series,r=i.options.keys,n=r||i.pointArrayMap||["y"],o=n.length,a=0,l=0;if(Ke(e)||null===e)t[n[0]]=e;else if(s(e))for(!r&&e.length>o&&(i=typeof e[0],"string"===i?t.name=e[0]:"number"===i&&(t.x=e[0]),a++);o>l;)r&&void 0===e[a]||(t[n[l]]=e[a]),a++,l++;else"object"==typeof e&&(t=e,e.dataLabels&&(i._hasPointLabels=!0),e.marker&&(i._hasPointMarkers=!0));return t},destroy:function(){var e,t=this.series.chart,i=t.hoverPoints;t.pointCount--,i&&(this.setState(),l(i,this),!i.length)&&(t.hoverPoints=null),this===t.hoverPoint&&this.onMouseOut(),(this.graphic||this.dataLabel)&&(Ge(this),this.destroyElements()),this.legendItem&&t.legend.destroyItem(this);for(e in this)this[e]=null},destroyElements:function(){for(var e,t=["graphic","dataLabel","dataLabelUpper","connector","shadowGroup"],i=6;i--;)e=t[i],this[e]&&(this[e]=this[e].destroy())},getLabelConfig:function(){return{x:this.category,y:this.y,color:this.color,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(e){var t=this.series,i=t.tooltipOptions,r=Ze(i.valueDecimals,""),n=i.valuePrefix||"",o=i.valueSuffix||"";return Fe(t.pointArrayMap||["y"],function(t){t="{point."+t,(n||o)&&(e=e.replace(t+"}",n+t+"}"+o)),e=e.replace(t+"}",t+":,."+r+"f}")}),y(e,{point:this,series:this.series})},firePointEvent:function(e,t,i){var r=this,n=this.series.options;(n.point.events[e]||r.options&&r.options.events&&r.options.events[e])&&this.importEvents(),"click"===e&&n.allowPointSelect&&(i=function(e){r.select&&r.select(null,e.ctrlKey||e.metaKey||e.shiftKey)}),Ye(this,e,t,i)},visible:!0};var mt=ne.Series=function(){};mt.prototype={isCartesian:!0,type:"line",pointClass:ft,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},directTouch:!1,axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],init:function(e,t){var i,r,n=this,o=e.series,a=function(e,t){return Ze(e.options.index,e._i)-Ze(t.options.index,t._i)};n.chart=e,n.options=t=n.setOptions(t),n.linkedSeries=[],n.bindAxes(),Ve(n,{name:t.name,state:"",pointAttr:{},visible:t.visible!==!1,selected:t.selected===!0}),Ne&&(t.animation=!1),r=t.events;for(i in r)Ue(n,i,r[i]);(r&&r.click||t.point&&t.point.events&&t.point.events.click||t.allowPointSelect)&&(e.runTrackerClick=!0),n.getColor(),n.getSymbol(),Fe(n.parallelArrays,function(e){n[e+"Data"]=[]}),n.setData(t.data,!1),n.isCartesian&&(e.hasCartesianSeries=!0),o.push(n),n._i=o.length-1,C(o,a),this.yAxis&&C(this.yAxis.series,a),Fe(o,function(e,t){e.index=t,e.name=e.name||"Series "+(t+1)})},bindAxes:function(){var e,i=this,r=i.options,n=i.chart;Fe(i.axisTypes||[],function(o){Fe(n[o],function(t){e=t.options,(r[o]===e.index||r[o]!==O&&r[o]===e.id||r[o]===O&&0===e.index)&&(t.series.push(i),i[o]=t,t.isDirty=!0)}),!i[o]&&i.optionalAxis!==o&&t(18,!0)})},updateParallelArrays:function(e,t){var i=e.series,r=arguments,n=Ke(t)?function(r){var n="y"===r&&i.toYData?i.toYData(e):e[r];i[r+"Data"][t]=n}:function(e){Array.prototype[t].apply(i[e+"Data"],Array.prototype.slice.call(r,2))};Fe(i.parallelArrays,n)},autoIncrement:function(){var e,t=this.options,i=this.xIncrement,r=t.pointIntervalUnit,i=Ze(i,t.pointStart,0);return this.pointInterval=e=Ze(this.pointInterval,t.pointInterval,1),r&&(t=new H(i),"day"===r?t=+t[te](t[q]()+e):"month"===r?t=+t[ie](t[V]()+e):"year"===r&&(t=+t[re](t[K]()+e)),e=t-i),this.xIncrement=i+e,i},setOptions:function(e){var t=this.chart,i=t.options.plotOptions,t=t.userOptions||{},n=t.plotOptions||{},o=i[this.type];return this.userOptions=e,i=r(o,i.series,e),this.tooltipOptions=r(z.tooltip,z.plotOptions[this.type].tooltip,t.tooltip,n.series&&n.series.tooltip,n[this.type]&&n[this.type].tooltip,e.tooltip),null===o.marker&&delete i.marker,this.zoneAxis=i.zoneAxis,e=this.zones=(i.zones||[]).slice(),!i.negativeColor&&!i.negativeFillColor||i.zones||e.push({value:i[this.zoneAxis+"Threshold"]||i.threshold||0,color:i.negativeColor,fillColor:i.negativeFillColor}),e.length&&c(e[e.length-1].value)&&e.push({color:this.color,fillColor:this.fillColor}),i},getCyclic:function(e,t,i){var r=this.userOptions,n="_"+e+"Index",o=e+"Counter";t||(c(r[n])?t=r[n]:(r[n]=t=this.chart[o]%i.length,this.chart[o]+=1),t=i[t]),this[e]=t},getColor:function(){this.options.colorByPoint?this.options.color=null:this.getCyclic("color",this.options.color||Qe[this.type].color,this.chart.options.colors)},getSymbol:function(){var e=this.options.marker;this.getCyclic("symbol",e.symbol,this.chart.options.symbols),/^url/.test(this.symbol)&&(e.radius=0)},drawLegendSymbol:it.drawLineMarker,setData:function(e,i,r,n){var a,l=this,d=l.points,h=d&&d.length||0,u=l.options,p=l.chart,g=null,f=l.xAxis,m=f&&!!f.categories,v=u.turboThreshold,y=this.xData,k=this.yData,b=(a=l.pointArrayMap)&&a.length,e=e||[];if(a=e.length,i=Ze(i,!0),n!==!1&&a&&h===a&&!l.cropped&&!l.hasGroupedData&&l.visible)Fe(e,function(e,t){d[t].update&&e!==u.data[t]&&d[t].update(e,!1,null,!1)});else{if(l.xIncrement=null,l.colorCounter=0,Fe(this.parallelArrays,function(e){l[e+"Data"].length=0}),v&&a>v){for(r=0;null===g&&a>r;)g=e[r],r++;if(Ke(g)){for(m=Ze(u.pointStart,0),g=Ze(u.pointInterval,1),r=0;a>r;r++)y[r]=m,k[r]=e[r],m+=g;l.xIncrement=m}else if(s(g))if(b)for(r=0;a>r;r++)g=e[r],y[r]=g[0],k[r]=g.slice(1,b+1);else for(r=0;a>r;r++)g=e[r],y[r]=g[0],k[r]=g[1];else t(12)}else for(r=0;a>r;r++)e[r]!==O&&(g={series:l},l.pointClass.prototype.applyOptions.apply(g,[e[r]]),l.updateParallelArrays(g,r),m&&c(g.name))&&(f.names[g.x]=g.name);for(o(k[0])&&t(14,!0),l.data=[],l.options.data=l.userOptions.data=e,r=h;r--;)d[r]&&d[r].destroy&&d[r].destroy();f&&(f.minRange=f.userMinRange),l.isDirty=l.isDirtyData=p.isDirtyBox=!0,r=!1}"point"===u.legendType&&(this.processData(),this.generatePoints()),i&&p.redraw(r)},processData:function(e){var i,r=this.xData,n=this.yData,o=r.length;i=0;var a,s,l,c=this.xAxis,d=this.options;l=d.cropThreshold;var h,u,p=this.getExtremesFromAll||d.getExtremesFromAll,g=this.isCartesian,d=c&&c.val2lin,f=c&&c.isLog;if(g&&!this.isDirty&&!c.isDirty&&!this.yAxis.isDirty&&!e)return!1;for(c&&(e=c.getExtremes(),h=e.min,u=e.max),g&&this.sorted&&!p&&(!l||o>l||this.forceCrop)&&(r[o-1]<h||r[0]>u?(r=[],n=[]):(r[0]<h||r[o-1]>u)&&(i=this.cropData(this.xData,this.yData,h,u),r=i.xData,n=i.yData,i=i.start,a=!0)),l=r.length||1;--l;)o=f?d(r[l])-d(r[l-1]):r[l]-r[l-1],o>0&&(s===O||s>o)?s=o:0>o&&this.requireSorting&&t(15);this.cropped=a,this.cropStart=i,this.processedXData=r,this.processedYData=n,this.closestPointRange=s},cropData:function(e,t,i,r){var n,o=e.length,a=0,s=o,l=Ze(this.cropShoulder,1);for(n=0;o>n;n++)if(e[n]>=i){a=de(0,n-l);break}for(i=n;o>i;i++)if(e[i]>r){s=i+l;break}return{xData:e.slice(a,s),yData:t.slice(a,s),start:a,end:s}},generatePoints:function(){var e,t,i,r,n=this.options.data,o=this.data,a=this.processedXData,s=this.processedYData,l=this.pointClass,c=a.length,d=this.cropStart||0,u=this.hasGroupedData,p=[];for(o||u||(o=[],o.length=n.length,o=this.data=o),r=0;c>r;r++)t=d+r,u?(p[r]=(new l).init(this,[a[r]].concat(h(s[r]))),p[r].dataGroup=this.groupMap[r]):(o[t]?i=o[t]:n[t]!==O&&(o[t]=i=(new l).init(this,n[t],a[r])),p[r]=i),p[r].index=t;if(o&&(c!==(e=o.length)||u))for(r=0;e>r;r++)r===d&&!u&&(r+=c),o[r]&&(o[r].destroyElements(),o[r].plotX=O);this.data=o,this.points=p},getExtremes:function(e){var t,i=this.yAxis,r=this.processedXData,n=[],o=0;t=this.xAxis.getExtremes();var a,s,l,c,d=t.min,h=t.max,e=e||this.stackedYData||this.processedYData||[];for(t=e.length,c=0;t>c;c++)if(s=r[c],l=e[c],a=null!==l&&l!==O&&(!i.isLog||l.length||l>0),s=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(r[c+1]||s)>=d&&(r[c-1]||s)<=h,a&&s)if(a=l.length)for(;a--;)null!==l[a]&&(n[o++]=l[a]);else n[o++]=l;this.dataMin=x(n),this.dataMax=S(n)},translate:function(){this.processedXData||this.processData(),this.generatePoints();for(var e,i,r,n,o=this.options,a=o.stacking,s=this.xAxis,l=s.categories,d=this.yAxis,h=this.points,u=h.length,p=!!this.modifyValue,g=o.pointPlacement,f="between"===g||Ke(g),m=o.threshold,v=o.startFromThreshold?m:0,y=Number.MAX_VALUE,o=0;u>o;o++){var k=h[o],b=k.x,C=k.y;i=k.low;var x=a&&d.stacks[(this.negStacks&&(v?0:m)>C?"-":"")+this.stackKey];d.isLog&&null!==C&&0>=C&&(k.y=C=null,t(10)),k.plotX=e=P(he(de(-1e5,s.translate(b,0,0,0,1,g,"flags"===this.type)),1e5)),a&&this.visible&&!k.isNull&&x&&x[b]&&(n=this.getStackIndicator(n,b,this.index),x=x[b],C=x.points[n.key],i=C[0],C=C[1],i===v&&(i=Ze(m,d.min)),d.isLog&&0>=i&&(i=null),k.total=k.stackTotal=x.total,k.percentage=x.total&&k.y/x.total*100,k.stackY=C,x.setOffset(this.pointXOffset||0,this.barW||0)),k.yBottom=c(i)?d.translate(i,0,1,0,1):null,p&&(C=this.modifyValue(C,k)),k.plotY=i="number"==typeof C&&C!==1/0?he(de(-1e5,d.translate(C,0,1,0,1)),1e5):O,k.isInside=i!==O&&i>=0&&i<=d.len&&e>=0&&e<=s.len,k.clientX=f?s.translate(b,0,0,0,1):e,k.negative=k.y<(m||0),k.category=l&&l[k.x]!==O?l[k.x]:k.x,k.isNull||(void 0!==r&&(y=he(y,ue(e-r))),r=e)}this.closestPointRangePx=y},getValidPoints:function(e,t){var i=this.chart;return $e(e||this.points||[],function(e){return t&&!i.isInsidePlot(e.plotX,e.plotY,i.inverted)?!1:!e.isNull})},setClip:function(e){var t=this.chart,i=this.options,r=t.renderer,n=t.inverted,o=this.clipBox,a=o||t.clipBox,s=this.sharedClipKey||["_sharedClip",e&&e.duration,e&&e.easing,a.height,i.xAxis,i.yAxis].join(","),l=t[s],c=t[s+"m"];l||(e&&(a.width=0,t[s+"m"]=c=r.clipRect(-99,n?-t.plotLeft:-t.plotTop,99,n?t.chartWidth:t.chartHeight)),t[s]=l=r.clipRect(a)),e&&(l.count+=1),i.clip!==!1&&(this.group.clip(e||o?l:t.clipRect),this.markerGroup.clip(c),this.sharedClipKey=s),e||(l.count-=1,l.count<=0&&s&&t[s]&&(o||(t[s]=t[s].destroy()),t[s+"m"]&&(t[s+"m"]=t[s+"m"].destroy())))},animate:function(e){var t,i=this.chart,r=this.options.animation;r&&!a(r)&&(r=Qe[this.type].animation),e?this.setClip(r):(t=this.sharedClipKey,(e=i[t])&&e.animate({width:i.plotSizeX},r),i[t+"m"]&&i[t+"m"].animate({width:i.plotSizeX+99},r),this.animate=null)},afterAnimate:function(){this.setClip(),Ye(this,"afterAnimate")},drawPoints:function(){var e,t,i,r,n,o,a,s,l,c,d,h,u=this.points,p=this.chart,g=this.options.marker,f=this.pointAttr[""],m=this.markerGroup,v=Ze(g.enabled,this.xAxis.isRadial,this.closestPointRangePx>2*g.radius);if(g.enabled!==!1||this._hasPointMarkers)for(r=u.length;r--;)n=u[r],t=le(n.plotX),i=n.plotY,l=n.graphic,c=n.marker||{},d=!!n.marker,e=v&&c.enabled===O||c.enabled,h=n.isInside,e&&Ke(i)&&null!==n.y?(e=n.pointAttr[n.selected?"select":""]||f,o=e.r,a=Ze(c.symbol,this.symbol),s=0===a.indexOf("url"),l?l[h?"show":"hide"](!0).attr(e).animate(Ve({x:t-o,y:i-o},l.symbolName?{width:2*o,height:2*o}:{})):h&&(o>0||s)&&(n.graphic=p.renderer.symbol(a,t-o,i-o,2*o,2*o,d?c:g).attr(e).add(m))):l&&(n.graphic=l.destroy())},convertAttribs:function(e,t,i,r){var n,o,a=this.pointAttrToOptions,s={},e=e||{},t=t||{},i=i||{},r=r||{};for(n in a)o=a[n],s[n]=Ze(e[o],t[n],i[n],r[n]);return s},getAttribs:function(){var e,t,i,r=this,n=r.options,o=Qe[r.type].marker?n.marker:n,a=o.states,s=a.hover,l=r.color,d=r.options.negativeColor,h={stroke:l,fill:l},u=r.points||[],p=[],g=r.pointAttrToOptions;e=r.hasPointSpecificOptions;var f=o.lineColor,m=o.fillColor;t=n.turboThreshold;var v,y,k=r.zones,b=r.zoneAxis||"y";if(n.marker?(s.radius=s.radius||o.radius+s.radiusPlus,s.lineWidth=s.lineWidth||o.lineWidth+s.lineWidthPlus):(s.color=s.color||A(s.color||l).brighten(s.brightness).get(),s.negativeColor=s.negativeColor||A(s.negativeColor||d).brighten(s.brightness).get()),p[""]=r.convertAttribs(o,h),Fe(["hover","select"],function(e){p[e]=r.convertAttribs(a[e],p[""])}),r.pointAttr=p,l=u.length,!t||t>l||e)for(;l--;){if(t=u[l],(o=t.options&&t.options.marker||t.options)&&o.enabled===!1&&(o.radius=0),h=null,k.length){for(e=0,h=k[e];t[b]>=h.value;)h=k[++e];t.color=t.fillColor=h=Ze(h.color,r.color)}if(e=n.colorByPoint||t.color,t.options)for(y in g)c(o[g[y]])&&(e=!0);e?(o=o||{},i=[],a=o.states||{},e=a.hover=a.hover||{},n.marker&&(!t.negative||e.fillColor||s.fillColor)||(e[r.pointAttrToOptions.fill]=e.color||!t.options.color&&s[t.negative&&d?"negativeColor":"color"]||A(t.color).brighten(e.brightness||s.brightness).get()),v={color:t.color},m||(v.fillColor=t.color),f||(v.lineColor=t.color),o.hasOwnProperty("color")&&!o.color&&delete o.color,h&&!s.fillColor&&(e.fillColor=h),i[""]=r.convertAttribs(Ve(v,o),p[""]),i.hover=r.convertAttribs(a.hover,p.hover,i[""]),i.select=r.convertAttribs(a.select,p.select,i[""])):i=p,t.pointAttr=i}},destroy:function(){var e,t,i,r,n=this,o=n.chart,a=/AppleWebKit\/533/.test(ve),s=n.data||[];for(Ye(n,"destroy"),Ge(n),Fe(n.axisTypes||[],function(e){(r=n[e])&&(l(r.series,n),r.isDirty=r.forceRedraw=!0)}),n.legendItem&&n.chart.legend.destroyItem(n),e=s.length;e--;)(t=s[e])&&t.destroy&&t.destroy();n.points=null,clearTimeout(n.animationTimeout);for(i in n)n[i]instanceof M&&!n[i].survive&&(e=a&&"group"===i?"hide":"destroy",n[i][e]());o.hoverSeries===n&&(o.hoverSeries=null),l(o.series,n);for(i in n)delete n[i]},getGraphPath:function(e,t,i){var r,n,o=this,a=o.options,s=a.step,l=[],e=e||o.points;return(r=e.reversed)&&e.reverse(),(s={right:1,center:2}[s]||s&&3)&&r&&(s=4-s),a.connectNulls&&!t&&!i&&(e=this.getValidPoints(e)),Fe(e,function(r,d){var h=r.plotX,u=r.plotY,p=e[d-1];(r.leftCliff||p&&p.rightCliff)&&!i&&(n=!0),r.isNull&&!c(t)&&d>0?n=!a.connectNulls:r.isNull&&!t?n=!0:(0===d||n?p=["M",r.plotX,r.plotY]:o.getPointSpline?p=o.getPointSpline(e,r,d):s?(p=1===s?["L",p.plotX,u]:2===s?["L",(p.plotX+h)/2,p.plotY,"L",(p.plotX+h)/2,u]:["L",h,p.plotY],p.push("L",h,u)):p=["L",h,u],l.push.apply(l,p),n=!1)}),o.graphPath=l},drawGraph:function(){var e=this,t=this.options,i=[["graph",t.lineColor||this.color,t.dashStyle]],r=t.lineWidth,n="square"!==t.linecap,o=(this.gappedPath||this.getGraphPath).call(this),a=this.fillGraph&&this.color||"none";Fe(this.zones,function(r,n){i.push(["zoneGraph"+n,r.color||e.color,r.dashStyle||t.dashStyle])}),Fe(i,function(i,s){var l=i[0],c=e[l];c?c.animate({d:o}):(r||a)&&o.length&&(c={stroke:i[1],"stroke-width":r,fill:a,zIndex:1},i[2]?c.dashstyle=i[2]:n&&(c["stroke-linecap"]=c["stroke-linejoin"]="round"),e[l]=e.chart.renderer.path(o).attr(c).add(e.group).shadow(2>s&&t.shadow))})},applyZones:function(){var e,t,i,r,n,o,a,s=this,l=this.chart,c=l.renderer,d=this.zones,h=this.clips||[],u=this.graph,p=this.area,g=de(l.chartWidth,l.chartHeight),f=this[(this.zoneAxis||"y")+"Axis"],m=f.reversed,v=l.inverted,y=f.horiz,k=!1;d.length&&(u||p)&&f.min!==O&&(u&&u.hide(),p&&p.hide(),r=f.getExtremes(),Fe(d,function(d,b){e=m?y?l.plotWidth:0:y?0:f.toPixels(r.min),e=he(de(Ze(t,e),0),g),t=he(de(se(f.toPixels(Ze(d.value,r.max),!0)),0),g),k&&(e=t=f.toPixels(r.max)),n=Math.abs(e-t),o=he(e,t),a=de(e,t),f.isXAxis?(i={x:v?a:o,y:0,width:n,height:g},y||(i.x=l.plotHeight-i.x)):(i={x:0,y:v?a:o,width:g,height:n},y&&(i.y=l.plotWidth-i.y)),l.inverted&&c.isVML&&(i=f.isXAxis?{x:0,y:m?o:a,height:i.width,width:l.chartWidth}:{x:i.y-l.plotLeft-l.spacingBox.x,y:0,width:i.height,height:l.chartHeight}),h[b]?h[b].animate(i):(h[b]=c.clipRect(i),u&&s["zoneGraph"+b].clip(h[b]),p&&s["zoneArea"+b].clip(h[b])),k=d.value>r.max}),this.clips=h)},invertGroups:function(){function e(){var e={width:t.yAxis.len,height:t.xAxis.len};Fe(["group","markerGroup"],function(i){t[i]&&t[i].attr(e).invert()})}var t=this,i=t.chart;t.xAxis&&(Ue(i,"resize",e),Ue(t,"destroy",function(){Ge(i,"resize",e)}),e(),t.invertGroups=e)},plotGroup:function(e,t,i,r,n){var o=this[e],a=!o;return a&&(this[e]=o=this.chart.renderer.g(t).attr({zIndex:r||.1}).add(n),o.addClass("highcharts-series-"+this.index)),o.attr({visibility:i})[a?"attr":"animate"](this.getPlotBox()),o},getPlotBox:function(){var e=this.chart,t=this.xAxis,i=this.yAxis;return e.inverted&&(t=i,i=this.xAxis),{translateX:t?t.left:e.plotLeft,translateY:i?i.top:e.plotTop,scaleX:1,scaleY:1}},render:function(){var e,t=this,i=t.chart,r=t.options,n=!!t.animate&&i.renderer.isSVG&&L(r.animation).duration,o=t.visible?"inherit":"hidden",a=r.zIndex,s=t.hasRendered,l=i.seriesGroup;e=t.plotGroup("group","series",o,a,l),t.markerGroup=t.plotGroup("markerGroup","markers",o,a,l),n&&t.animate(!0),t.getAttribs(),e.inverted=t.isCartesian?i.inverted:!1,t.drawGraph&&(t.drawGraph(),t.applyZones()),Fe(t.points,function(e){e.redraw&&e.redraw()}),t.drawDataLabels&&t.drawDataLabels(),t.visible&&t.drawPoints(),t.drawTracker&&t.options.enableMouseTracking!==!1&&t.drawTracker(),i.inverted&&t.invertGroups(),r.clip!==!1&&!t.sharedClipKey&&!s&&e.clip(i.clipRect),n&&t.animate(),s||(t.animationTimeout=u(function(){t.afterAnimate()},n)),t.isDirty=t.isDirtyData=!1,t.hasRendered=!0},redraw:function(){var e=this.chart,t=this.isDirty||this.isDirtyData,i=this.group,r=this.xAxis,n=this.yAxis;i&&(e.inverted&&i.attr({width:e.plotWidth,height:e.plotHeight}),i.animate({translateX:Ze(r&&r.left,e.plotLeft),translateY:Ze(n&&n.top,e.plotTop)})),this.translate(),this.render(),t&&delete this.kdTree},kdDimensions:1,kdAxisArray:["clientX","plotY"],searchPoint:function(e,t){var i=this.xAxis,r=this.yAxis,n=this.chart.inverted;return this.searchKDTree({clientX:n?i.len-e.chartY+i.pos:e.chartX-i.pos,plotY:n?r.len-e.chartX+r.pos:e.chartY-r.pos
},t)},buildKDTree:function(){function e(i,r,n){var o,a;return(a=i&&i.length)?(o=t.kdAxisArray[r%n],i.sort(function(e,t){return e[o]-t[o]}),a=Math.floor(a/2),{point:i[a],left:e(i.slice(0,a),r+1,n),right:e(i.slice(a+1),r+1,n)}):void 0}var t=this,i=t.kdDimensions;delete t.kdTree,u(function(){t.kdTree=e(t.getValidPoints(null,!t.directTouch),i,i)},t.options.kdNow?0:1)},searchKDTree:function(e,t){function i(e,t,s,l){var d,h,u=t.point,p=r.kdAxisArray[s%l],g=u;return h=c(e[n])&&c(u[n])?Math.pow(e[n]-u[n],2):null,d=c(e[o])&&c(u[o])?Math.pow(e[o]-u[o],2):null,d=(h||0)+(d||0),u.dist=c(d)?Math.sqrt(d):Number.MAX_VALUE,u.distX=c(h)?Math.sqrt(h):Number.MAX_VALUE,p=e[p]-u[p],d=0>p?"left":"right",h=0>p?"right":"left",t[d]&&(d=i(e,t[d],s+1,l),g=d[a]<g[a]?d:u),t[h]&&Math.sqrt(p*p)<g[a]&&(e=i(e,t[h],s+1,l),g=e[a]<g[a]?e:g),g}var r=this,n=this.kdAxisArray[0],o=this.kdAxisArray[1],a=t?"distX":"dist";return this.kdTree||this.buildKDTree(),this.kdTree?i(e,this.kdTree,this.kdDimensions,this.kdDimensions):void 0}},D.prototype={destroy:function(){T(this,this.axis)},render:function(e){var t=this.options,i=t.format,i=i?y(i,this):t.formatter.call(this);this.label?this.label.attr({text:i,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(i,null,null,t.useHTML).css(t.style).attr({align:this.textAlign,rotation:t.rotation,visibility:"hidden"}).add(e)},setOffset:function(e,t){var i=this.axis,r=i.chart,n=r.inverted,o=i.reversed,o=this.isNegative&&!o||!this.isNegative&&o,a=i.translate(i.usePercentage?100:this.total,0,0,0,1),i=i.translate(0),i=ue(a-i),s=r.xAxis[0].translate(this.x)+e,l=r.plotHeight,o={x:n?o?a:a-i:s,y:n?l-s-t:o?l-a-i:l-a,width:n?i:t,height:n?t:i};(n=this.label)&&(n.align(this.alignOptions,null,o),o=n.alignAttr,n[this.options.crop===!1||r.isInsidePlot(o.x,o.y)?"show":"hide"](!0))}},gt.prototype.getStacks=function(){var e=this;Fe(e.yAxis,function(e){e.stacks&&e.hasVisibleSeries&&(e.oldStacks=e.stacks)}),Fe(e.series,function(t){!t.options.stacking||t.visible!==!0&&e.options.chart.ignoreHiddenSeries!==!1||(t.stackKey=t.type+Ze(t.options.stack,""))})},ot.prototype.buildStacks=function(){var e,t,i=this.series,r=Ze(this.options.reversedStacks,!0),n=i.length;if(!this.isXAxis){for(this.usePercentage=!1,t=n;t--;)i[r?t:n-t-1].setStackedPoints();for(t=n;t--;)e=i[r?t:n-t-1],e.setStackCliffs&&e.setStackCliffs();if(this.usePercentage)for(t=0;n>t;t++)i[t].setPercentStacks()}},ot.prototype.renderStackTotals=function(){var e,t,i=this.chart,r=i.renderer,n=this.stacks,o=this.stackTotalGroup;o||(this.stackTotalGroup=o=r.g("stack-labels").attr({visibility:"visible",zIndex:6}).add()),o.translate(i.plotLeft,i.plotTop);for(e in n)for(t in i=n[e])i[t].render(o)},ot.prototype.resetStacks=function(){var e,t,i=this.stacks;if(!this.isXAxis)for(e in i)for(t in i[e])i[e][t].touched<this.stacksTouched?(i[e][t].destroy(),delete i[e][t]):(i[e][t].total=null,i[e][t].cum=0)},ot.prototype.cleanStacks=function(){var e,t,i;if(!this.isXAxis){this.oldStacks&&(e=this.stacks=this.oldStacks);for(t in e)for(i in e[t])e[t][i].cum=e[t][i].total}},mt.prototype.setStackedPoints=function(){if(this.options.stacking&&(this.visible===!0||this.chart.options.chart.ignoreHiddenSeries===!1)){var e,t,i,r,n,o,a,s=this.processedXData,l=this.processedYData,c=[],d=l.length,h=this.options,u=h.threshold,p=h.startFromThreshold?u:0,g=h.stack,h=h.stacking,f=this.stackKey,m="-"+f,v=this.negStacks,y=this.yAxis,k=y.stacks,b=y.oldStacks;for(y.stacksTouched+=1,n=0;d>n;n++)o=s[n],a=l[n],e=this.getStackIndicator(e,o,this.index),r=e.key,i=(t=v&&(p?0:u)>a)?m:f,k[i]||(k[i]={}),k[i][o]||(b[i]&&b[i][o]?(k[i][o]=b[i][o],k[i][o].total=null):k[i][o]=new D(y,y.options.stackLabels,t,o,g)),i=k[i][o],null!==a&&(i.points[r]=i.points[this.index]=[Ze(i.cum,p)],i.touched=y.stacksTouched,e.index>0&&this.singleStacks===!1&&(i.points[r][0]=i.points[this.index+","+o+",0"][0])),"percent"===h?(t=t?f:m,v&&k[t]&&k[t][o]?(t=k[t][o],i.total=t.total=de(t.total,i.total)+ue(a)||0):i.total=P(i.total+(ue(a)||0))):i.total=P(i.total+(a||0)),i.cum=Ze(i.cum,p)+(a||0),null!==a&&(i.points[r].push(i.cum),c[n]=i.cum);"percent"===h&&(y.usePercentage=!0),this.stackedYData=c,y.oldStacks={}}},mt.prototype.setPercentStacks=function(){var e,t=this,i=t.stackKey,r=t.yAxis.stacks,n=t.processedXData;Fe([i,"-"+i],function(i){for(var o,a,s,l=n.length;l--;)a=n[l],e=t.getStackIndicator(e,a,t.index),o=(s=r[i]&&r[i][a])&&s.points[e.key],(a=o)&&(s=s.total?100/s.total:0,a[0]=P(a[0]*s),a[1]=P(a[1]*s),t.stackedYData[l]=a[1])})},mt.prototype.getStackIndicator=function(e,t,i){return c(e)&&e.x===t?e.index++:e={x:t,index:0},e.key=[i,t,e.index].join(","),e},Ve(gt.prototype,{addSeries:function(e,t,i){var r,n=this;return e&&(t=Ze(t,!0),Ye(n,"addSeries",{options:e},function(){r=n.initSeries(e),n.isDirtyLegend=!0,n.linkSeries(),t&&n.redraw(i)})),r},addAxis:function(e,t,i,n){var o=t?"xAxis":"yAxis",a=this.options,e=r(e,{index:this[o].length,isX:t});new ot(this,e),a[o]=h(a[o]||{}),a[o].push(e),Ze(i,!0)&&this.redraw(n)},showLoading:function(e){var t=this,i=t.options,r=t.loadingDiv,n=i.loading,o=function(){r&&p(r,{left:t.plotLeft+"px",top:t.plotTop+"px",width:t.plotWidth+"px",height:t.plotHeight+"px"})};r||(t.loadingDiv=r=g(De,{className:"highcharts-loading"},Ve(n.style,{zIndex:10,display:"none"}),t.container),t.loadingSpan=g("span",null,n.labelStyle,r),Ue(t,"redraw",o)),t.loadingSpan.innerHTML=e||i.lang.loading,t.loadingShown||(p(r,{opacity:0,display:""}),We(r,{opacity:n.style.opacity},{duration:n.showDuration||0}),t.loadingShown=!0),o()},hideLoading:function(){var e=this.options,t=this.loadingDiv;t&&We(t,{opacity:0},{duration:e.loading.hideDuration||100,complete:function(){p(t,{display:"none"})}}),this.loadingShown=!1}}),Ve(ft.prototype,{update:function(e,t,i,r){function n(){l.applyOptions(e),null===l.y&&d&&(l.graphic=d.destroy()),a(e)&&!s(e)&&(l.redraw=function(){d&&d.element&&e&&e.marker&&e.marker.symbol&&(l.graphic=d.destroy()),e&&e.dataLabels&&l.dataLabel&&(l.dataLabel=l.dataLabel.destroy()),l.redraw=null}),o=l.index,c.updateParallelArrays(l,o),p&&l.name&&(p[l.x]=l.name),u.data[o]=a(u.data[o])&&!s(u.data[o])?l.options:e,c.isDirty=c.isDirtyData=!0,!c.fixedBox&&c.hasCartesianSeries&&(h.isDirtyBox=!0),"point"===u.legendType&&(h.isDirtyLegend=!0),t&&h.redraw(i)}var o,l=this,c=l.series,d=l.graphic,h=c.chart,u=c.options,p=c.xAxis&&c.xAxis.names,t=Ze(t,!0);r===!1?n():l.firePointEvent("update",{options:e},n)},remove:function(e,t){this.series.removePoint(ze(this,this.series.data),e,t)}}),Ve(mt.prototype,{addPoint:function(e,t,i,r){var n,o=this,a=o.options,s=o.data,l=o.graph,c=o.area,d=o.chart,h=o.xAxis&&o.xAxis.names,u=l&&l.shift||0,p=["graph","area"],l=a.data,g=o.xData;if(N(r,d),i){for(r=o.zones.length;r--;)p.push("zoneGraph"+r,"zoneArea"+r);Fe(p,function(e){o[e]&&(o[e].shift=u+(a.step?2:1))})}if(c&&(c.isArea=!0),t=Ze(t,!0),c={series:o},o.pointClass.prototype.applyOptions.apply(c,[e]),p=c.x,r=g.length,o.requireSorting&&p<g[r-1])for(n=!0;r&&g[r-1]>p;)r--;o.updateParallelArrays(c,"splice",r,0,0),o.updateParallelArrays(c,r),h&&c.name&&(h[p]=c.name),l.splice(r,0,e),n&&(o.data.splice(r,0,null),o.processData()),"point"===a.legendType&&o.generatePoints(),i&&(s[0]&&s[0].remove?s[0].remove(!1):(s.shift(),o.updateParallelArrays(c,"shift"),l.shift())),o.isDirty=!0,o.isDirtyData=!0,t&&(o.getAttribs(),d.redraw())},removePoint:function(e,t,i){var r=this,n=r.data,o=n[e],a=r.points,s=r.chart,l=function(){a&&a.length===n.length&&a.splice(e,1),n.splice(e,1),r.options.data.splice(e,1),r.updateParallelArrays(o||{series:r},"splice",e,1),o&&o.destroy(),r.isDirty=!0,r.isDirtyData=!0,t&&s.redraw()};N(i,s),t=Ze(t,!0),o?o.firePointEvent("remove",null,l):l()},remove:function(e,t){var i=this,r=i.chart;Ye(i,"remove",null,function(){i.destroy(),r.isDirtyLegend=r.isDirtyBox=!0,r.linkSeries(),Ze(e,!0)&&r.redraw(t)})},update:function(e,t){var i,n=this,o=this.chart,a=this.userOptions,s=this.type,l=_e[s].prototype,c=["group","markerGroup","dataLabelsGroup"];(e.type&&e.type!==s||void 0!==e.zIndex)&&(c.length=0),Fe(c,function(e){c[e]=n[e],delete n[e]}),e=r(a,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},e),this.remove(!1);for(i in l)this[i]=O;Ve(this,_e[e.type||s].prototype),Fe(c,function(e){n[e]=c[e]}),this.init(o,e),o.linkSeries(),Ze(t,!0)&&o.redraw(!1)}}),Ve(ot.prototype,{update:function(e,t){var i=this.chart,e=i.options[this.coll][this.options.index]=r(this.userOptions,e);this.destroy(!0),this._addedPlotLB=this.chart._labelPanes=O,this.init(i,Ve(e,{events:O})),i.isDirtyBox=!0,Ze(t,!0)&&i.redraw()},remove:function(e){for(var t=this.chart,i=this.coll,r=this.series,n=r.length;n--;)r[n]&&r[n].remove(!1);l(t.axes,this),l(t[i],this),t.options[i].splice(this.options.index,1),Fe(t[i],function(e,t){e.options.index=t}),this.destroy(),t.isDirtyBox=!0,Ze(e,!0)&&t.redraw()},setTitle:function(e,t){this.update({title:e},t)},setCategories:function(e,t){this.update({categories:e},t)}});var vt=f(mt);_e.line=vt,Qe.area=r(et,{softThreshold:!1,threshold:0});var yt=f(mt,{type:"area",singleStacks:!1,getStackPoints:function(){var e,t,i,r=[],n=[],o=this.xAxis,a=this.yAxis,s=a.stacks[this.stackKey],l={},c=this.points,d=this.index,h=a.series,u=h.length,p=Ze(a.options.reversedStacks,!0)?1:-1;if(this.options.stacking){for(t=0;t<c.length;t++)l[c[t].x]=c[t];for(i in s)null!==s[i].total&&n.push(i);n.sort(function(e,t){return e-t}),e=Be(h,function(){return this.visible}),Fe(n,function(i,c){var h,g,f=0;if(l[i]&&!l[i].isNull)r.push(l[i]),Fe([-1,1],function(r){var o=1===r?"rightNull":"leftNull",a=0,f=s[n[c+r]];if(f)for(t=d;t>=0&&u>t;)h=f.points[t],h||(t===d?l[i][o]=!0:e[t]&&(g=s[i].points[t])&&(a-=g[1]-g[0])),t+=p;l[i][1===r?"rightCliff":"leftCliff"]=a});else{for(t=d;t>=0&&u>t;){if(h=s[i].points[t]){f=h[1];break}t+=p}f=a.toPixels(f,!0),r.push({isNull:!0,plotX:o.toPixels(i,!0),plotY:f,yBottom:f})}})}return r},getGraphPath:function(e){var t,i,r,n,o=mt.prototype.getGraphPath,a=this.options,s=a.stacking,l=this.yAxis,c=[],d=[],h=this.index,u=l.stacks[this.stackKey],p=a.threshold,g=l.getThreshold(a.threshold),a=a.connectNulls||"percent"===s,f=function(t,i,n){var o,a,f=e[t],t=s&&u[f.x].points[h],m=f[n+"Null"]||0,n=f[n+"Cliff"]||0,f=!0;n||m?(o=(m?t[0]:t[1])+n,a=t[0]+n,f=!!m):!s&&e[i]&&e[i].isNull&&(o=a=p),void 0!==o&&(d.push({plotX:r,plotY:null===o?g:l.getThreshold(o),isNull:f}),c.push({plotX:r,plotY:null===a?g:l.getThreshold(a)}))},e=e||this.points;for(s&&(e=this.getStackPoints()),t=0;t<e.length;t++)i=e[t].isNull,r=Ze(e[t].rectPlotX,e[t].plotX),n=Ze(e[t].yBottom,g),(!i||a)&&(a||f(t,t-1,"left"),i&&!s&&a||(d.push(e[t]),c.push({x:t,plotX:r,plotY:n})),a||f(t,t+1,"right"));return t=o.call(this,d,!0,!0),c.reversed=!0,i=o.call(this,c,!0,!0),i.length&&(i[0]="L"),t=t.concat(i),o=o.call(this,d,!1,a),this.areaPath=t,o},drawGraph:function(){this.areaPath=[],mt.prototype.drawGraph.apply(this);var e=this,t=this.areaPath,i=this.options,r=[["area",this.color,i.fillColor]];Fe(this.zones,function(t,n){r.push(["zoneArea"+n,t.color||e.color,t.fillColor||i.fillColor])}),Fe(r,function(r){var n=r[0],o=e[n];o?o.animate({d:t}):(o={fill:r[2]||r[1],zIndex:0},r[2]||(o["fill-opacity"]=Ze(i.fillOpacity,.75)),e[n]=e.chart.renderer.path(t).attr(o).add(e.group))})},drawLegendSymbol:it.drawRectangle});return _e.area=yt,Qe.spline=r(et),vt=f(mt,{type:"spline",getPointSpline:function(e,t,i){var r,n,o,a,s=t.plotX,l=t.plotY,c=e[i-1],i=e[i+1];if(c&&!c.isNull&&i&&!i.isNull){e=c.plotY,o=i.plotX;var i=i.plotY,d=0;r=(1.5*s+c.plotX)/2.5,n=(1.5*l+e)/2.5,o=(1.5*s+o)/2.5,a=(1.5*l+i)/2.5,o!==r&&(d=(a-n)*(o-s)/(o-r)+l-a),n+=d,a+=d,n>e&&n>l?(n=de(e,l),a=2*l-n):e>n&&l>n&&(n=he(e,l),a=2*l-n),a>i&&a>l?(a=de(i,l),n=2*l-a):i>a&&l>a&&(a=he(i,l),n=2*l-a),t.rightContX=o,t.rightContY=a}return t=["C",Ze(c.rightContX,c.plotX),Ze(c.rightContY,c.plotY),Ze(r,s),Ze(n,l),s,l],c.rightContX=c.rightContY=null,t}}),_e.spline=vt,Qe.areaspline=r(Qe.area),yt=yt.prototype,vt=f(vt,{type:"areaspline",getStackPoints:yt.getStackPoints,getGraphPath:yt.getGraphPath,setStackCliffs:yt.setStackCliffs,drawGraph:yt.drawGraph,drawLegendSymbol:it.drawRectangle}),_e.areaspline=vt,Qe.column=r(et,{borderColor:"#FFFFFF",borderRadius:0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:.1,shadow:!1,halo:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0}),vt=f(mt,{type:"column",pointAttrToOptions:{stroke:"borderColor",fill:"color",r:"borderRadius"},cropShoulder:0,directTouch:!0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){mt.prototype.init.apply(this,arguments);var e=this,t=e.chart;t.hasRendered&&Fe(t.series,function(t){t.type===e.type&&(t.isDirty=!0)})},getColumnMetrics:function(){var e,t=this,i=t.options,r=t.xAxis,n=t.yAxis,o=r.reversed,a={},s=0;i.grouping===!1?s=1:Fe(t.chart.series,function(i){var r,o=i.options,l=i.yAxis;i.type===t.type&&i.visible&&n.len===l.len&&n.pos===l.pos&&(o.stacking?(e=i.stackKey,a[e]===O&&(a[e]=s++),r=a[e]):o.grouping!==!1&&(r=s++),i.columnIndex=r)});var l=he(ue(r.transA)*(r.ordinalSlope||i.pointRange||r.closestPointRange||r.tickInterval||1),r.len),c=l*i.groupPadding,d=(l-2*c)/s,i=he(i.maxPointWidth||r.len,Ze(i.pointWidth,d*(1-2*i.pointPadding)));return t.columnMetrics={width:i,offset:(d-i)/2+(c+((t.columnIndex||0)+(o?1:0))*d-l/2)*(o?-1:1)},t.columnMetrics},crispCol:function(e,t,i,r){var n=this.chart,o=this.borderWidth,a=-(o%2?.5:0),o=o%2?.5:1;return n.inverted&&n.renderer.isVML&&(o+=1),i=Math.round(e+i)+a,e=Math.round(e)+a,i-=e,r=Math.round(t+r)+o,a=ue(t)<=.5&&r>.5,t=Math.round(t)+o,r-=t,a&&r&&(t-=1,r+=1),{x:e,y:t,width:i,height:r}},translate:function(){var e=this,t=e.chart,i=e.options,r=e.borderWidth=Ze(i.borderWidth,e.closestPointRange*e.xAxis.transA<2?0:1),n=e.yAxis,o=e.translatedThreshold=n.getThreshold(i.threshold),a=Ze(i.minPointLength,5),s=e.getColumnMetrics(),l=s.width,c=e.barW=de(l,1+2*r),d=e.pointXOffset=s.offset;t.inverted&&(o-=.5),i.pointPadding&&(c=ce(c)),mt.prototype.translate.apply(e),Fe(e.points,function(i){var r,s=he(Ze(i.yBottom,o),9e4),h=999+ue(s),h=he(de(-h,i.plotY),n.len+h),u=i.plotX+d,p=c,g=he(h,s),f=de(h,s)-g;ue(f)<a&&a&&(f=a,r=!n.reversed&&!i.negative||n.reversed&&i.negative,g=ue(g-o)>a?s-a:o-(r?a:0)),i.barX=u,i.pointWidth=l,i.tooltipPos=t.inverted?[n.len+n.pos-t.plotLeft-h,e.xAxis.len-u-p/2,f]:[u+p/2,h+n.pos-t.plotTop,f],i.shapeType="rect",i.shapeArgs=e.crispCol(u,g,p,f)})},getSymbol:Ae,drawLegendSymbol:it.drawRectangle,drawGraph:Ae,drawPoints:function(){var e,t,i=this,n=this.chart,o=i.options,a=n.renderer,s=o.animationLimit||250;Fe(i.points,function(l){var d,h=l.graphic;Ke(l.plotY)&&null!==l.y?(e=l.shapeArgs,d=c(i.borderWidth)?{"stroke-width":i.borderWidth}:{},t=l.pointAttr[l.selected?"select":""]||i.pointAttr[""],h?(Xe(h),h.attr(d).attr(t)[n.pointCount<s?"animate":"attr"](r(e))):l.graphic=a[l.shapeType](e).attr(d).attr(t).add(l.group||i.group).shadow(o.shadow,null,o.stacking&&!o.borderRadius)):h&&(l.graphic=h.destroy())})},animate:function(e){var t=this,i=this.yAxis,r=t.options,n=this.chart.inverted,o={};we&&(e?(o.scaleY=.001,e=he(i.pos+i.len,de(i.pos,i.toPixels(r.threshold))),n?o.translateX=e-i.len:o.translateY=e,t.group.attr(o)):(o[n?"translateX":"translateY"]=i.pos,t.group.animate(o,Ve(L(t.options.animation),{step:function(e,i){t.group.attr({scaleY:de(.001,i.pos)})}})),t.animate=null))},remove:function(){var e=this,t=e.chart;t.hasRendered&&Fe(t.series,function(t){t.type===e.type&&(t.isDirty=!0)}),mt.prototype.remove.apply(e,arguments)}}),_e.column=vt,Qe.bar=r(Qe.column),yt=f(vt,{type:"bar",inverted:!0}),_e.bar=yt,Qe.scatter=r(et,{lineWidth:0,marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">●</span> <span style="font-size: 10px;"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}),yt=f(mt,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,kdDimensions:2,drawGraph:function(){this.options.lineWidth&&mt.prototype.drawGraph.call(this)}}),_e.scatter=yt,Qe.pie=r(et,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return null===this.y?void 0:this.point.name},x:0},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}}),et={type:"pie",isCartesian:!1,pointClass:f(ft,{init:function(){ft.prototype.init.apply(this,arguments);var e,t=this;return t.name=Ze(t.name,"Slice"),e=function(e){t.slice("select"===e.type)},Ue(t,"select",e),Ue(t,"unselect",e),t},setVisible:function(e,t){var i=this,r=i.series,n=r.chart,o=r.options.ignoreHiddenPoint,t=Ze(t,o);e!==i.visible&&(i.visible=i.options.visible=e=e===O?!i.visible:e,r.options.data[ze(i,r.data)]=i.options,Fe(["graphic","dataLabel","connector","shadowGroup"],function(t){i[t]&&i[t][e?"show":"hide"](!0)}),i.legendItem&&n.legend.colorizeItem(i,e),!e&&"hover"===i.state&&i.setState(""),o&&(r.isDirty=!0),t&&n.redraw())},slice:function(e,t,i){var r=this.series;N(i,r.chart),Ze(t,!0),this.sliced=this.options.sliced=e=c(e)?e:!this.sliced,r.options.data[ze(this,r.data)]=this.options,e=e?this.slicedTranslation:{translateX:0,translateY:0},this.graphic.animate(e),this.shadowGroup&&this.shadowGroup.animate(e)},haloPath:function(e){var t=this.shapeArgs,i=this.series.chart;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(i.plotLeft+t.x,i.plotTop+t.y,t.r+e,t.r+e,{innerR:this.shapeArgs.r,start:t.start,end:t.end})}}),requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},animate:function(e){var t=this,i=t.points,r=t.startAngleRad;e||(Fe(i,function(e){var i=e.graphic,n=e.shapeArgs;i&&(i.attr({r:e.startR||t.center[3]/2,start:r,end:r}),i.animate({r:n.r,start:n.start,end:n.end},t.options.animation))}),t.animate=null)},updateTotals:function(){var e,t,i=0,r=this.points,n=r.length,o=this.options.ignoreHiddenPoint;for(e=0;n>e;e++)t=r[e],i+=o&&!t.visible?0:t.y;for(this.total=i,e=0;n>e;e++)t=r[e],t.percentage=i>0&&(t.visible||!o)?t.y/i*100:0,t.total=i},generatePoints:function(){mt.prototype.generatePoints.call(this),this.updateTotals()},translate:function(e){this.generatePoints();var t,i,r,n,o,a=0,s=this.options,l=s.slicedOffset,c=l+s.borderWidth,d=s.startAngle||0,h=this.startAngleRad=fe/180*(d-90),d=(this.endAngleRad=fe/180*(Ze(s.endAngle,d+360)-90))-h,u=this.points,p=s.dataLabels.distance,s=s.ignoreHiddenPoint,g=u.length;for(e||(this.center=e=this.getCenter()),this.getX=function(t,i){return r=ae.asin(he((t-e[1])/(e[2]/2+p),1)),e[0]+(i?-1:1)*pe(r)*(e[2]/2+p)},n=0;g>n;n++)o=u[n],t=h+a*d,s&&!o.visible||(a+=o.percentage/100),i=h+a*d,o.shapeType="arc",o.shapeArgs={x:e[0],y:e[1],r:e[2]/2,innerR:e[3]/2,start:se(1e3*t)/1e3,end:se(1e3*i)/1e3},r=(i+t)/2,r>1.5*fe?r-=2*fe:-fe/2>r&&(r+=2*fe),o.slicedTranslation={translateX:se(pe(r)*l),translateY:se(ge(r)*l)},t=pe(r)*e[2]/2,i=ge(r)*e[2]/2,o.tooltipPos=[e[0]+.7*t,e[1]+.7*i],o.half=-fe/2>r||r>fe/2?1:0,o.angle=r,c=he(c,p/2),o.labelPos=[e[0]+t+pe(r)*p,e[1]+i+ge(r)*p,e[0]+t+pe(r)*c,e[1]+i+ge(r)*c,e[0]+t,e[1]+i,0>p?"center":o.half?"right":"left",r]},drawGraph:null,drawPoints:function(){var e,t,i,r,n,o,a=this,s=a.chart.renderer,l=a.options.shadow;l&&!a.shadowGroup&&(a.shadowGroup=s.g("shadow").add(a.group)),Fe(a.points,function(c){null!==c.y&&(t=c.graphic,n=c.shapeArgs,i=c.shadowGroup,r=c.pointAttr[c.selected?"select":""],r.stroke||(r.stroke=r.fill),l&&!i&&(i=c.shadowGroup=s.g("shadow").add(a.shadowGroup)),e=c.sliced?c.slicedTranslation:{translateX:0,translateY:0},i&&i.attr(e),t?t.setRadialReference(a.center).attr(r).animate(Ve(n,e)):(o={"stroke-linejoin":"round"},c.visible||(o.visibility="hidden"),c.graphic=t=s[c.shapeType](n).setRadialReference(a.center).attr(r).attr(o).attr(e).add(a.group).shadow(l,i)))})},searchPoint:Ae,sortByAngle:function(e,t){e.sort(function(e,i){return void 0!==e.angle&&(i.angle-e.angle)*t})},drawLegendSymbol:it.drawRectangle,getCenter:rt.getCenter,getSymbol:Ae},et=f(mt,et),_e.pie=et,mt.prototype.drawDataLabels=function(){var e,t,i,n,o=this,a=o.options,s=a.cursor,l=a.dataLabels,d=o.points,h=o.hasRendered||0,u=Ze(l.defer,!0),p=o.chart.renderer;(l.enabled||o._hasPointLabels)&&(o.dlProcessOptions&&o.dlProcessOptions(l),n=o.plotGroup("dataLabelsGroup","data-labels",u&&!h?"hidden":"visible",l.zIndex||6),u&&(n.attr({opacity:+h}),h||Ue(o,"afterAnimate",function(){o.visible&&n.show(),n[a.animation?"animate":"attr"]({opacity:1},{duration:200})})),t=l,Fe(d,function(d){var h,u,g,f,m=d.dataLabel,v=d.connector,k=!0,b={};if(e=d.dlOptions||d.options&&d.options.dataLabels,h=Ze(e&&e.enabled,t.enabled)&&null!==d.y,m&&!h)d.dataLabel=m.destroy();else if(h){if(l=r(t,e),f=l.style,h=l.rotation,u=d.getLabelConfig(),i=l.format?y(l.format,u):l.formatter.call(u,l),f.color=Ze(l.color,f.color,o.color,"black"),m)c(i)?(m.attr({text:i}),k=!1):(d.dataLabel=m=m.destroy(),v&&(d.connector=v.destroy()));else if(c(i)){m={fill:l.backgroundColor,stroke:l.borderColor,"stroke-width":l.borderWidth,r:l.borderRadius||0,rotation:h,padding:l.padding,zIndex:1},"contrast"===f.color&&(b.color=l.inside||l.distance<0||a.stacking?p.getContrast(d.color||o.color):"#000000"),s&&(b.cursor=s);for(g in m)m[g]===O&&delete m[g];m=d.dataLabel=p[h?"text":"label"](i,0,-9999,l.shape,null,null,l.useHTML).attr(m).css(Ve(f,b)).add(n).shadow(l.shadow)}m&&o.alignDataLabel(d,m,l,null,k)}}))},mt.prototype.alignDataLabel=function(e,t,i,r,n){var o=this.chart,a=o.inverted,s=Ze(e.plotX,-9999),l=Ze(e.plotY,-9999),c=t.getBBox(),d=o.renderer.fontMetrics(i.style.fontSize).b,h=i.rotation,u=i.align,p=this.visible&&(e.series.forceDL||o.isInsidePlot(s,se(l),a)||r&&o.isInsidePlot(s,a?r.x+1:r.y+r.height-1,a)),g="justify"===Ze(i.overflow,"justify");p&&(r=Ve({x:a?o.plotWidth-l:s,y:se(a?o.plotHeight-s:l),width:0,height:0},r),Ve(i,{width:c.width,height:c.height}),h?(g=!1,a=o.renderer.rotCorr(d,h),a={x:r.x+i.x+r.width/2+a.x,y:r.y+i.y+{top:0,middle:.5,bottom:1}[i.verticalAlign]*r.height},t[n?"attr":"animate"](a).attr({align:u}),s=(h+720)%360,s=s>180&&360>s,"left"===u?a.y-=s?c.height:0:"center"===u?(a.x-=c.width/2,a.y-=c.height/2):"right"===u&&(a.x-=c.width,a.y-=s?0:c.height)):(t.align(i,null,r),a=t.alignAttr),g?this.justifyDataLabel(t,i,a,c,r,n):Ze(i.crop,!0)&&(p=o.isInsidePlot(a.x,a.y)&&o.isInsidePlot(a.x+c.width,a.y+c.height)),i.shape&&!h&&t.attr({anchorX:e.plotX,anchorY:e.plotY})),p||(Xe(t),t.attr({y:-9999}),t.placed=!1)},mt.prototype.justifyDataLabel=function(e,t,i,r,n,o){var a,s,l=this.chart,c=t.align,d=t.verticalAlign,h=e.box?0:e.padding||0;a=i.x+h,0>a&&("right"===c?t.align="left":t.x=-a,s=!0),a=i.x+r.width-h,a>l.plotWidth&&("left"===c?t.align="right":t.x=l.plotWidth-a,s=!0),a=i.y+h,0>a&&("bottom"===d?t.verticalAlign="top":t.y=-a,s=!0),a=i.y+r.height-h,a>l.plotHeight&&("top"===d?t.verticalAlign="bottom":t.y=l.plotHeight-a,s=!0),s&&(e.placed=!o,e.align(t,null,n))},_e.pie&&(_e.pie.prototype.drawDataLabels=function(){var e,t,i,r,n,o,a,s,l,c,d,h=this,u=h.data,p=h.chart,g=h.options.dataLabels,f=Ze(g.connectorPadding,10),m=Ze(g.connectorWidth,1),v=p.plotWidth,y=p.plotHeight,k=Ze(g.softConnector,!0),b=g.distance,C=h.center,x=C[2]/2,T=C[1],w=b>0,P=[[],[]],N=[0,0,0,0],L=function(e,t){return t.y-e.y};if(h.visible&&(g.enabled||h._hasPointLabels)){for(mt.prototype.drawDataLabels.apply(h),Fe(u,function(e){e.dataLabel&&e.visible&&(P[e.half].push(e),e.dataLabel._pos=null)}),c=2;c--;){var I,A=[],M=[],E=P[c],D=E.length;if(D){for(h.sortByAngle(E,c-.5),d=u=0;!u&&E[d];)u=E[d]&&E[d].dataLabel&&(E[d].dataLabel.getBBox().height||21),d++;if(b>0){for(n=he(T+x+b,p.plotHeight),d=de(0,T-x-b);n>=d;d+=u)A.push(d);if(n=A.length,D>n){for(e=[].concat(E),e.sort(L),d=D;d--;)e[d].rank=d;for(d=D;d--;)E[d].rank>=n&&E.splice(d,1);D=E.length}for(d=0;D>d;d++){e=E[d],o=e.labelPos,e=9999;var O,R;for(R=0;n>R;R++)O=ue(A[R]-o[1]),e>O&&(e=O,I=R);if(d>I&&null!==A[d])I=d;else for(D-d+I>n&&null!==A[d]&&(I=n-D+d);null===A[I];)I++;M.push({i:I,y:A[I]}),A[I]=null}M.sort(L)}for(d=0;D>d;d++)e=E[d],o=e.labelPos,r=e.dataLabel,l=e.visible===!1?"hidden":"inherit",e=o[1],b>0?(n=M.pop(),I=n.i,s=n.y,(e>s&&null!==A[I+1]||s>e&&null!==A[I-1])&&(s=he(de(0,e),p.plotHeight))):s=e,a=g.justify?C[0]+(c?-1:1)*(x+b):h.getX(s===T-x-b||s===T+x+b?e:s,c),r._attr={visibility:l,align:o[6]},r._pos={x:a+g.x+({left:f,right:-f}[o[6]]||0),y:s+g.y-10},r.connX=a,r.connY=s,null===this.options.size&&(n=r.width,f>a-n?N[3]=de(se(n-a+f),N[3]):a+n>v-f&&(N[1]=de(se(a+n-v+f),N[1])),0>s-u/2?N[0]=de(se(-s+u/2),N[0]):s+u/2>y&&(N[2]=de(se(s+u/2-y),N[2])))}}(0===S(N)||this.verifyDataLabelOverflow(N))&&(this.placeDataLabels(),w&&m&&Fe(this.points,function(e){t=e.connector,o=e.labelPos,(r=e.dataLabel)&&r._pos&&e.visible?(l=r._attr.visibility,a=r.connX,s=r.connY,i=k?["M",a+("left"===o[6]?5:-5),s,"C",a,s,2*o[2]-o[4],2*o[3]-o[5],o[2],o[3],"L",o[4],o[5]]:["M",a+("left"===o[6]?5:-5),s,"L",o[2],o[3],"L",o[4],o[5]],t?(t.animate({d:i}),t.attr("visibility",l)):e.connector=t=h.chart.renderer.path(i).attr({"stroke-width":m,stroke:g.connectorColor||e.color||"#606060",visibility:l}).add(h.dataLabelsGroup)):t&&(e.connector=t.destroy())}))}},_e.pie.prototype.placeDataLabels=function(){Fe(this.points,function(e){var t=e.dataLabel;t&&e.visible&&((e=t._pos)?(t.attr(t._attr),t[t.moved?"animate":"attr"](e),t.moved=!0):t&&t.attr({y:-9999}))})},_e.pie.prototype.alignDataLabel=Ae,_e.pie.prototype.verifyDataLabelOverflow=function(e){var t,i=this.center,r=this.options,n=r.center,o=r.minSize||80,a=o;return null!==n[0]?a=de(i[2]-de(e[1],e[3]),o):(a=de(i[2]-e[1]-e[3],o),i[0]+=(e[3]-e[1])/2),null!==n[1]?a=de(he(a,i[2]-de(e[0],e[2])),o):(a=de(he(a,i[2]-e[0]-e[2]),o),i[1]+=(e[0]-e[2])/2),a<i[2]?(i[2]=a,i[3]=Math.min(/%$/.test(r.innerSize||0)?a*parseFloat(r.innerSize||0)/100:parseFloat(r.innerSize||0),a),this.translate(i),this.drawDataLabels&&this.drawDataLabels()):t=!0,t}),_e.column&&(_e.column.prototype.alignDataLabel=function(e,t,i,n,o){var a=this.chart.inverted,s=e.series,l=e.dlBox||e.shapeArgs,c=Ze(e.below,e.plotY>Ze(this.translatedThreshold,s.yAxis.len)),d=Ze(i.inside,!!this.options.stacking);l&&(n=r(l),n.y<0&&(n.height+=n.y,n.y=0),l=n.y+n.height-s.yAxis.len,l>0&&(n.height-=l),a&&(n={x:s.yAxis.len-n.y-n.height,y:s.xAxis.len-n.x-n.width,width:n.height,height:n.width}),d||(a?(n.x+=c?0:n.width,n.width=0):(n.y+=c?n.height:0,n.height=0))),i.align=Ze(i.align,!a||d?"center":c?"right":"left"),i.verticalAlign=Ze(i.verticalAlign,a||d?"middle":c?"top":"bottom"),mt.prototype.alignDataLabel.call(this,e,t,i,n,o)}),function(e){var t=e.Chart,i=e.each,r=e.pick,n=e.addEvent;t.prototype.callbacks.push(function(e){function t(){var t=[];i(e.series,function(e){var n=e.options.dataLabels,o=e.dataLabelCollections||["dataLabel"];(n.enabled||e._hasPointLabels)&&!n.allowOverlap&&e.visible&&i(o,function(n){i(e.points,function(e){e[n]&&(e[n].labelrank=r(e.labelrank,e.shapeArgs&&e.shapeArgs.height),t.push(e[n]))})})}),e.hideOverlappingLabels(t)}t(),n(e,"redraw",t)}),t.prototype.hideOverlappingLabels=function(e){var t,r,n,o,a,s,l,c,d,h=e.length;for(r=0;h>r;r++)(t=e[r])&&(t.oldOpacity=t.opacity,t.newOpacity=1);for(e.sort(function(e,t){return(t.labelrank||0)-(e.labelrank||0)}),r=0;h>r;r++)for(n=e[r],t=r+1;h>t;++t)o=e[t],n&&o&&n.placed&&o.placed&&0!==n.newOpacity&&0!==o.newOpacity&&(a=n.alignAttr,s=o.alignAttr,l=n.parentGroup,c=o.parentGroup,d=2*(n.box?0:n.padding),a=!(s.x+c.translateX>a.x+l.translateX+(n.width-d)||s.x+c.translateX+(o.width-d)<a.x+l.translateX||s.y+c.translateY>a.y+l.translateY+(n.height-d)||s.y+c.translateY+(o.height-d)<a.y+l.translateY))&&((n.labelrank<o.labelrank?n:o).newOpacity=0);i(e,function(e){var t,i;e&&(i=e.newOpacity,e.oldOpacity!==i&&e.placed&&(i?e.show(!0):t=function(){e.hide()},e.alignAttr.opacity=i,e[e.isOld?"animate":"attr"](e.alignAttr,null,t)),e.isOld=!0)})}}(ne),et=ne.TrackerMixin={drawTrackerPoint:function(){var e=this,t=e.chart,i=t.pointer,r=e.options.cursor,n=r&&{cursor:r},o=function(e){for(var i,r=e.target;r&&!i;)i=r.point,r=r.parentNode;i!==O&&i!==t.hoverPoint&&i.onMouseOver(e)};Fe(e.points,function(e){e.graphic&&(e.graphic.element.point=e),e.dataLabel&&(e.dataLabel.element.point=e)}),e._hasTracking||(Fe(e.trackerGroups,function(t){e[t]&&(e[t].addClass("highcharts-tracker").on("mouseover",o).on("mouseout",function(e){i.onTrackerMouseOut(e)}).css(n),_)&&e[t].on("touchstart",o)}),e._hasTracking=!0)},drawTrackerGraph:function(){var e=this,t=e.options,i=t.trackByArea,r=[].concat(i?e.areaPath:e.graphPath),n=r.length,o=e.chart,a=o.pointer,s=o.renderer,l=o.options.tooltip.snap,c=e.tracker,d=t.cursor,h=d&&{cursor:d},u=function(){o.hoverSeries!==e&&e.onMouseOver()},p="rgba(192,192,192,"+(we?1e-4:.002)+")";if(n&&!i)for(d=n+1;d--;)"M"===r[d]&&r.splice(d+1,0,r[d+1]-l,r[d+2],"L"),(d&&"M"===r[d]||d===n)&&r.splice(d,0,"L",r[d-2]+l,r[d-1]);c?c.attr({d:r}):(e.tracker=s.path(r).attr({"stroke-linejoin":"round",visibility:e.visible?"visible":"hidden",stroke:p,fill:i?p:"none","stroke-width":t.lineWidth+(i?0:2*l),zIndex:2}).add(e.group),Fe([e.tracker,e.markerGroup],function(e){e.addClass("highcharts-tracker").on("mouseover",u).on("mouseout",function(e){a.onTrackerMouseOut(e)}).css(h),_&&e.on("touchstart",u)}))}},_e.column&&(vt.prototype.drawTracker=et.drawTrackerPoint),_e.pie&&(_e.pie.prototype.drawTracker=et.drawTrackerPoint),_e.scatter&&(yt.prototype.drawTracker=et.drawTrackerPoint),Ve(pt.prototype,{setItemEvents:function(e,t,i,r,n){var o=this;(i?t:e.legendGroup).on("mouseover",function(){e.setState("hover"),t.css(o.options.itemHoverStyle)}).on("mouseout",function(){t.css(e.visible?r:n),e.setState()}).on("click",function(t){var i=function(){e.setVisible&&e.setVisible()},t={browserEvent:t};e.firePointEvent?e.firePointEvent("legendItemClick",t,i):Ye(e,"legendItemClick",t,i)})},createCheckboxForItem:function(e){e.checkbox=g("input",{type:"checkbox",checked:e.selected,defaultChecked:e.selected},this.options.itemCheckboxStyle,this.chart.container),Ue(e.checkbox,"click",function(t){Ye(e.series||e,"checkboxClick",{checked:t.target.checked,item:e},function(){e.select()})})}}),z.legend.itemStyle.cursor="pointer",Ve(gt.prototype,{showResetZoom:function(){var e=this,t=z.lang,i=e.options.chart.resetZoomButton,r=i.theme,n=r.states,o="chart"===i.relativeTo?null:"plotBox";this.resetZoomButton=e.renderer.button(t.resetZoom,null,null,function(){e.zoomOut()},r,n&&n.hover).attr({align:i.position.align,title:t.resetZoomTitle}).add().align(i.position,!1,o)},zoomOut:function(){var e=this;Ye(e,"selection",{resetSelection:!0},function(){e.zoom()})},zoom:function(e){var t,i,r=this.pointer,n=!1;!e||e.resetSelection?Fe(this.axes,function(e){t=e.zoom()}):Fe(e.xAxis.concat(e.yAxis),function(e){var i=e.axis,o=i.isXAxis;(r[o?"zoomX":"zoomY"]||r[o?"pinchX":"pinchY"])&&(t=i.zoom(e.min,e.max),i.displayBtn&&(n=!0))}),i=this.resetZoomButton,n&&!i?this.showResetZoom():!n&&a(i)&&(this.resetZoomButton=i.destroy()),t&&this.redraw(Ze(this.options.chart.animation,e&&e.animation,this.pointCount<100))},pan:function(e,t){var i,r=this,n=r.hoverPoints;n&&Fe(n,function(e){e.setState()}),Fe("xy"===t?[1,0]:[1],function(t){var t=r[t?"xAxis":"yAxis"][0],n=t.horiz,o=e[n?"chartX":"chartY"],n=n?"mouseDownX":"mouseDownY",a=r[n],s=(t.pointRange||0)/2,l=t.getExtremes(),c=t.toValue(a-o,!0)+s,s=t.toValue(a+t.len-o,!0)-s,a=a>o;t.series.length&&(a||c>he(l.dataMin,l.min))&&(!a||s<de(l.dataMax,l.max))&&(t.setExtremes(c,s,!1,!1,{trigger:"pan"}),i=!0),r[n]=o}),i&&r.redraw(!1),p(r.container,{cursor:"move"})}}),Ve(ft.prototype,{select:function(e,t){var i=this,r=i.series,n=r.chart,e=Ze(e,!i.selected);i.firePointEvent(e?"select":"unselect",{accumulate:t},function(){i.selected=i.options.selected=e,r.options.data[ze(i,r.data)]=i.options,i.setState(e&&"select"),t||Fe(n.getSelectedPoints(),function(e){e.selected&&e!==i&&(e.selected=e.options.selected=!1,r.options.data[ze(e,r.data)]=e.options,
e.setState(""),e.firePointEvent("unselect"))})})},onMouseOver:function(e,t){var i=this.series,r=i.chart,n=r.tooltip,o=r.hoverPoint;r.hoverSeries!==i&&i.onMouseOver(),o&&o!==this&&o.onMouseOut(),this.series&&(this.firePointEvent("mouseOver"),n&&(!n.shared||i.noSharedTooltip)&&n.refresh(this,e),this.setState("hover"),!t)&&(r.hoverPoint=this)},onMouseOut:function(){var e=this.series.chart,t=e.hoverPoints;this.firePointEvent("mouseOut"),t&&-1!==ze(this,t)||(this.setState(),e.hoverPoint=null)},importEvents:function(){if(!this.hasImportedEvents){var e,t=r(this.series.options.point,this.options).events;this.events=t;for(e in t)Ue(this,e,t[e]);this.hasImportedEvents=!0}},setState:function(e,t){var i,n=le(this.plotX),o=this.plotY,a=this.series,s=a.options.states,l=Qe[a.type].marker&&a.options.marker,c=l&&!l.enabled,d=l&&l.states[e],h=d&&d.enabled===!1,u=a.stateMarkerGraphic,p=this.marker||{},g=a.chart,f=a.halo,e=e||"";i=this.pointAttr[e]||a.pointAttr[e],e===this.state&&!t||this.selected&&"select"!==e||s[e]&&s[e].enabled===!1||e&&(h||c&&d.enabled===!1)||e&&p.states&&p.states[e]&&p.states[e].enabled===!1||(this.graphic?(l=l&&this.graphic.symbolName&&i.r,this.graphic.attr(r(i,l?{x:n-l,y:o-l,width:2*l,height:2*l}:{})),u&&u.hide()):(e&&d&&(l=d.radius,p=p.symbol||a.symbol,u&&u.currentSymbol!==p&&(u=u.destroy()),u?u[t?"animate":"attr"]({x:n-l,y:o-l}):p&&(a.stateMarkerGraphic=u=g.renderer.symbol(p,n-l,o-l,2*l,2*l).attr(i).add(a.markerGroup),u.currentSymbol=p)),u&&(u[e&&g.isInsidePlot(n,o,g.inverted)?"show":"hide"](),u.element.point=this)),(n=s[e]&&s[e].halo)&&n.size?(f||(a.halo=f=g.renderer.path().add(g.seriesGroup)),f.attr(Ve({fill:this.color||a.color,"fill-opacity":n.opacity,zIndex:-1},n.attributes))[t?"animate":"attr"]({d:this.haloPath(n.size)})):f&&f.attr({d:[]}),this.state=e)},haloPath:function(e){var t=this.series,i=t.chart,r=t.getPlotBox(),n=i.inverted,o=Math.floor(this.plotX);return i.renderer.symbols.circle(r.translateX+(n?t.yAxis.len-this.plotY:o)-e,r.translateY+(n?t.xAxis.len-o:this.plotY)-e,2*e,2*e)}}),Ve(mt.prototype,{onMouseOver:function(){var e=this.chart,t=e.hoverSeries;t&&t!==this&&t.onMouseOut(),this.options.events.mouseOver&&Ye(this,"mouseOver"),this.setState("hover"),e.hoverSeries=this},onMouseOut:function(){var e=this.options,t=this.chart,i=t.tooltip,r=t.hoverPoint;t.hoverSeries=null,r&&r.onMouseOut(),this&&e.events.mouseOut&&Ye(this,"mouseOut"),i&&!e.stickyTracking&&(!i.shared||this.noSharedTooltip)&&i.hide(),this.setState()},setState:function(e){var t=this.options,i=this.graph,r=t.states,n=t.lineWidth,t=0,e=e||"";if(this.state!==e&&(this.state=e,!(r[e]&&r[e].enabled===!1)&&(e&&(n=r[e].lineWidth||n+(r[e].lineWidthPlus||0)),i&&!i.dashstyle)))for(e={"stroke-width":n},i.attr(e);this["zoneGraph"+t];)this["zoneGraph"+t].attr(e),t+=1},setVisible:function(e,t){var i,r=this,n=r.chart,o=r.legendItem,a=n.options.chart.ignoreHiddenSeries,s=r.visible;i=(r.visible=e=r.userOptions.visible=e===O?!s:e)?"show":"hide",Fe(["group","dataLabelsGroup","markerGroup","tracker"],function(e){r[e]&&r[e][i]()}),n.hoverSeries!==r&&(n.hoverPoint&&n.hoverPoint.series)!==r||r.onMouseOut(),o&&n.legend.colorizeItem(r,e),r.isDirty=!0,r.options.stacking&&Fe(n.series,function(e){e.options.stacking&&e.visible&&(e.isDirty=!0)}),Fe(r.linkedSeries,function(t){t.setVisible(e,!1)}),a&&(n.isDirtyBox=!0),t!==!1&&n.redraw(),Ye(r,i)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(e){this.selected=e=e===O?!this.selected:e,this.checkbox&&(this.checkbox.checked=e),Ye(this,e?"select":"unselect")},drawTracker:et.drawTrackerGraph}),Ve(ne,{Color:A,Point:ft,Tick:E,Renderer:R,SVGElement:M,SVGRenderer:tt,arrayMin:x,arrayMax:S,charts:Me,correctFloat:P,dateFormat:F,error:t,format:y,pathAnim:void 0,getOptions:function(){return z},hasBidiBug:Pe,isTouchDevice:Se,setOptions:function(e){return z=r(!0,z,e),I(),z},addEvent:Ue,removeEvent:Ge,createElement:g,discardElement:w,css:p,each:Fe,map:Be,merge:r,splat:h,stableSort:C,extendClass:f,pInt:n,svg:we,canvas:Ne,vml:!we&&!Ne,product:"Highcharts",version:"4.2.5"}),ne}),function(q){var I,J,K,L,M,N,v,s={},w={},x={},O={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},y=[function(e){var t=e.treeObj,i=f.event;t.bind(i.NODECREATED,function(t,i,r){j.apply(e.callback.onNodeCreated,[t,i,r])}),t.bind(i.CLICK,function(t,i,r,n,o){j.apply(e.callback.onClick,[i,r,n,o])}),t.bind(i.EXPAND,function(t,i,r){j.apply(e.callback.onExpand,[t,i,r])}),t.bind(i.COLLAPSE,function(t,i,r){j.apply(e.callback.onCollapse,[t,i,r])}),t.bind(i.ASYNC_SUCCESS,function(t,i,r,n){j.apply(e.callback.onAsyncSuccess,[t,i,r,n])}),t.bind(i.ASYNC_ERROR,function(t,i,r,n,o,a){j.apply(e.callback.onAsyncError,[t,i,r,n,o,a])}),t.bind(i.REMOVE,function(t,i,r){j.apply(e.callback.onRemove,[t,i,r])}),t.bind(i.SELECTED,function(t,i,r){j.apply(e.callback.onSelected,[i,r])}),t.bind(i.UNSELECTED,function(t,i,r){j.apply(e.callback.onUnSelected,[i,r])})}],z=[function(e){var t=f.event;e.treeObj.unbind(t.NODECREATED).unbind(t.CLICK).unbind(t.EXPAND).unbind(t.COLLAPSE).unbind(t.ASYNC_SUCCESS).unbind(t.ASYNC_ERROR).unbind(t.REMOVE).unbind(t.SELECTED).unbind(t.UNSELECTED)}],A=[function(e){var t=h.getCache(e);t||(t={},h.setCache(e,t)),t.nodes=[],t.doms=[]}],B=[function(e,t,i,r,n,o){if(i){var a=h.getRoot(e),s=e.data.key.children;i.level=t,i.tId=e.treeId+"_"+ ++a.zId,i.parentTId=r?r.tId:null,i.open="string"==typeof i.open?j.eqs(i.open,"true"):!!i.open,i[s]&&i[s].length>0?(i.isParent=!0,i.zAsync=!0):(i.isParent="string"==typeof i.isParent?j.eqs(i.isParent,"true"):!!i.isParent,i.open=i.isParent&&!e.async.enable?i.open:!1,i.zAsync=!i.isParent),i.isFirstNode=n,i.isLastNode=o,i.getParentNode=function(){return h.getNodeCache(e,i.parentTId)},i.getPreNode=function(){return h.getPreNode(e,i)},i.getNextNode=function(){return h.getNextNode(e,i)},i.getIndex=function(){return h.getNodeIndex(e,i)},i.getPath=function(){return h.getNodePath(e,i)},i.isAjaxing=!1,h.fixPIdKeyValue(e,i)}}],u=[function(e){var t=e.target,i=h.getSetting(e.data.treeId),r="",n=null,o="",a="",s=null,l=null,c=null;if(j.eqs(e.type,"mousedown")?a="mousedown":j.eqs(e.type,"mouseup")?a="mouseup":j.eqs(e.type,"contextmenu")?a="contextmenu":j.eqs(e.type,"click")?j.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+f.id.SWITCH)?(r=j.getNodeMainDom(t).id,o="switchNode"):(c=j.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+f.id.A}]))&&(r=j.getNodeMainDom(c).id,o="clickNode"):j.eqs(e.type,"dblclick")&&(a="dblclick",c=j.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+f.id.A}]))&&(r=j.getNodeMainDom(c).id,o="switchNode"),a.length>0&&0==r.length&&(c=j.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+f.id.A}]))&&(r=j.getNodeMainDom(c).id),r.length>0)switch(n=h.getNodeCache(i,r),o){case"switchNode":n.isParent&&(j.eqs(e.type,"click")||j.eqs(e.type,"dblclick")&&j.apply(i.view.dblClickExpand,[i.treeId,n],i.view.dblClickExpand))?s=I:o="";break;case"clickNode":s=J}switch(a){case"mousedown":l=K;break;case"mouseup":l=L;break;case"dblclick":l=M;break;case"contextmenu":l=N}return{stop:!1,node:n,nodeEventType:o,nodeEventCallback:s,treeEventType:a,treeEventCallback:l}}],C=[function(e){var t=h.getRoot(e);t||(t={},h.setRoot(e,t)),t[e.data.key.children]=[],t.expandTriggerFlag=!1,t.curSelectedList=[],t.noSelection=!0,t.createdNodes=[],t.zId=0,t._ver=(new Date).getTime()}],D=[],E=[],F=[],G=[],H=[],h={addNodeCache:function(e,t){h.getCache(e).nodes[h.getNodeCacheId(t.tId)]=t},getNodeCacheId:function(e){return e.substring(e.lastIndexOf("_")+1)},addAfterA:function(e){E.push(e)},addBeforeA:function(e){D.push(e)},addInnerAfterA:function(e){G.push(e)},addInnerBeforeA:function(e){F.push(e)},addInitBind:function(e){y.push(e)},addInitUnBind:function(e){z.push(e)},addInitCache:function(e){A.push(e)},addInitNode:function(e){B.push(e)},addInitProxy:function(e,t){t?u.splice(0,0,e):u.push(e)},addInitRoot:function(e){C.push(e)},addNodesData:function(e,t,r,n){var o=e.data.key.children;t[o]?r>=t[o].length&&(r=-1):(t[o]=[],r=-1),t[o].length>0&&0===r?(t[o][0].isFirstNode=!1,i.setNodeLineIcos(e,t[o][0])):t[o].length>0&&0>r&&(t[o][t[o].length-1].isLastNode=!1,i.setNodeLineIcos(e,t[o][t[o].length-1])),t.isParent=!0,0>r?t[o]=t[o].concat(n):(e=[r,0].concat(n),t[o].splice.apply(t[o],e))},addSelectedNode:function(e,t){var i=h.getRoot(e);h.isSelectedNode(e,t)||i.curSelectedList.push(t)},addCreatedNode:function(e,t){(e.callback.onNodeCreated||e.view.addDiyDom)&&h.getRoot(e).createdNodes.push(t)},addZTreeTools:function(e){H.push(e)},exSetting:function(e){q.extend(!0,O,e)},fixPIdKeyValue:function(e,t){e.data.simpleData.enable&&(t[e.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[e.data.simpleData.idKey]:e.data.simpleData.rootPId)},getAfterA:function(e,t,i){for(var r=0,n=E.length;n>r;r++)E[r].apply(this,arguments)},getBeforeA:function(e,t,i){for(var r=0,n=D.length;n>r;r++)D[r].apply(this,arguments)},getInnerAfterA:function(e,t,i){for(var r=0,n=G.length;n>r;r++)G[r].apply(this,arguments)},getInnerBeforeA:function(e,t,i){for(var r=0,n=F.length;n>r;r++)F[r].apply(this,arguments)},getCache:function(e){return x[e.treeId]},getNodeIndex:function(e,t){if(!t)return null;for(var i=e.data.key.children,r=t.parentTId?t.getParentNode():h.getRoot(e),n=0,o=r[i].length-1;o>=n;n++)if(r[i][n]===t)return n;return-1},getNextNode:function(e,t){if(!t)return null;for(var i=e.data.key.children,r=t.parentTId?t.getParentNode():h.getRoot(e),n=0,o=r[i].length-1;o>=n;n++)if(r[i][n]===t)return n==o?null:r[i][n+1];return null},getNodeByParam:function(e,t,i,r){if(!t||!i)return null;for(var n=e.data.key.children,o=0,a=t.length;a>o;o++){if(t[o][i]==r)return t[o];var s=h.getNodeByParam(e,t[o][n],i,r);if(s)return s}return null},getNodeCache:function(e,t){if(!t)return null;var i=x[e.treeId].nodes[h.getNodeCacheId(t)];return i?i:null},getNodeName:function(e,t){return""+t[e.data.key.name]},getNodePath:function(e,t){if(!t)return null;var i;return(i=t.parentTId?t.getParentNode().getPath():[])&&i.push(t),i},getNodeTitle:function(e,t){return""+t[""===e.data.key.title?e.data.key.name:e.data.key.title]},getNodes:function(e){return h.getRoot(e)[e.data.key.children]},getNodesByParam:function(e,t,i,r){if(!t||!i)return[];for(var n=e.data.key.children,o=[],a=0,s=t.length;s>a;a++)t[a][i]==r&&o.push(t[a]),o=o.concat(h.getNodesByParam(e,t[a][n],i,r));return o},getNodesByParamFuzzy:function(e,t,i,r){if(!t||!i)return[];for(var n=e.data.key.children,o=[],r=r.toLowerCase(),a=0,s=t.length;s>a;a++)"string"==typeof t[a][i]&&t[a][i].toLowerCase().indexOf(r)>-1&&o.push(t[a]),o=o.concat(h.getNodesByParamFuzzy(e,t[a][n],i,r));return o},getNodesByFilter:function(e,t,i,r,n){if(!t)return r?null:[];for(var o=e.data.key.children,a=r?null:[],s=0,l=t.length;l>s;s++){if(j.apply(i,[t[s],n],!1)){if(r)return t[s];a.push(t[s])}var c=h.getNodesByFilter(e,t[s][o],i,r,n);if(r&&c)return c;a=r?c:a.concat(c)}return a},getPreNode:function(e,t){if(!t)return null;for(var i=e.data.key.children,r=t.parentTId?t.getParentNode():h.getRoot(e),n=0,o=r[i].length;o>n;n++)if(r[i][n]===t)return 0==n?null:r[i][n-1];return null},getRoot:function(e){return e?w[e.treeId]:null},getRoots:function(){return w},getSetting:function(e){return s[e]},getSettings:function(){return s},getZTreeTools:function(e){return(e=this.getRoot(this.getSetting(e)))?e.treeTools:null},initCache:function(e){for(var t=0,i=A.length;i>t;t++)A[t].apply(this,arguments)},initNode:function(e,t,i,r,n,o){for(var a=0,s=B.length;s>a;a++)B[a].apply(this,arguments)},initRoot:function(e){for(var t=0,i=C.length;i>t;t++)C[t].apply(this,arguments)},isSelectedNode:function(e,t){for(var i=h.getRoot(e),r=0,n=i.curSelectedList.length;n>r;r++)if(t===i.curSelectedList[r])return!0;return!1},removeNodeCache:function(e,t){var i=e.data.key.children;if(t[i])for(var r=0,n=t[i].length;n>r;r++)h.removeNodeCache(e,t[i][r]);h.getCache(e).nodes[h.getNodeCacheId(t.tId)]=null},removeSelectedNode:function(e,t){for(var i=h.getRoot(e),r=0,n=i.curSelectedList.length;n>r;r++)t!==i.curSelectedList[r]&&h.getNodeCache(e,i.curSelectedList[r].tId)||(i.curSelectedList.splice(r,1),e.treeObj.trigger(f.event.UNSELECTED,[e.treeId,t]),r--,n--)},setCache:function(e,t){x[e.treeId]=t},setRoot:function(e,t){w[e.treeId]=t},setZTreeTools:function(e,t){for(var i=0,r=H.length;r>i;i++)H[i].apply(this,arguments)},transformToArrayFormat:function(e,t){if(!t)return[];var i=e.data.key.children,r=[];if(j.isArray(t))for(var n=0,o=t.length;o>n;n++)r.push(t[n]),t[n][i]&&(r=r.concat(h.transformToArrayFormat(e,t[n][i])));else r.push(t),t[i]&&(r=r.concat(h.transformToArrayFormat(e,t[i])));return r},transformTozTreeFormat:function(e,t){var i,r,n=e.data.simpleData.idKey,o=e.data.simpleData.pIdKey,a=e.data.key.children;if(!n||""==n||!t)return[];if(j.isArray(t)){var s=[],l=[];for(i=0,r=t.length;r>i;i++)l[t[i][n]]=t[i];for(i=0,r=t.length;r>i;i++)l[t[i][o]]&&t[i][n]!=t[i][o]?(l[t[i][o]][a]||(l[t[i][o]][a]=[]),l[t[i][o]][a].push(t[i])):s.push(t[i]);return s}return[t]}},l={bindEvent:function(e){for(var t=0,i=y.length;i>t;t++)y[t].apply(this,arguments)},unbindEvent:function(e){for(var t=0,i=z.length;i>t;t++)z[t].apply(this,arguments)},bindTree:function(e){var t={treeId:e.treeId},i=e.treeObj;e.view.txtSelectedEnable||i.bind("selectstart",v).css({"-moz-user-select":"-moz-none"}),i.bind("click",t,l.proxy),i.bind("dblclick",t,l.proxy),i.bind("mouseover",t,l.proxy),i.bind("mouseout",t,l.proxy),i.bind("mousedown",t,l.proxy),i.bind("mouseup",t,l.proxy),i.bind("contextmenu",t,l.proxy)},unbindTree:function(e){e.treeObj.unbind("selectstart",v).unbind("click",l.proxy).unbind("dblclick",l.proxy).unbind("mouseover",l.proxy).unbind("mouseout",l.proxy).unbind("mousedown",l.proxy).unbind("mouseup",l.proxy).unbind("contextmenu",l.proxy)},doProxy:function(e){for(var t=[],i=0,r=u.length;r>i;i++){var n=u[i].apply(this,arguments);if(t.push(n),n.stop)break}return t},proxy:function(e){var t=h.getSetting(e.data.treeId);if(!j.uCanDo(t,e))return!0;for(var t=l.doProxy(e),i=!0,r=0,n=t.length;n>r;r++){var o=t[r];o.nodeEventCallback&&(i=o.nodeEventCallback.apply(o,[e,o.node])&&i),o.treeEventCallback&&(i=o.treeEventCallback.apply(o,[e,o.node])&&i)}return i}};I=function(e,t){var r=h.getSetting(e.data.treeId);if(t.open){if(0==j.apply(r.callback.beforeCollapse,[r.treeId,t],!0))return!0}else if(0==j.apply(r.callback.beforeExpand,[r.treeId,t],!0))return!0;return h.getRoot(r).expandTriggerFlag=!0,i.switchNode(r,t),!0},J=function(e,t){var r=h.getSetting(e.data.treeId),n=r.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&h.isSelectedNode(r,t)?0:r.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&r.view.selectedMulti?2:1;return 0==j.apply(r.callback.beforeClick,[r.treeId,t,n],!0)?!0:(0===n?i.cancelPreSelectedNode(r,t):i.selectNode(r,t,2===n),r.treeObj.trigger(f.event.CLICK,[e,r.treeId,t,n]),!0)},K=function(e,t){var i=h.getSetting(e.data.treeId);return j.apply(i.callback.beforeMouseDown,[i.treeId,t],!0)&&j.apply(i.callback.onMouseDown,[e,i.treeId,t]),!0},L=function(e,t){var i=h.getSetting(e.data.treeId);return j.apply(i.callback.beforeMouseUp,[i.treeId,t],!0)&&j.apply(i.callback.onMouseUp,[e,i.treeId,t]),!0},M=function(e,t){var i=h.getSetting(e.data.treeId);return j.apply(i.callback.beforeDblClick,[i.treeId,t],!0)&&j.apply(i.callback.onDblClick,[e,i.treeId,t]),!0},N=function(e,t){var i=h.getSetting(e.data.treeId);return j.apply(i.callback.beforeRightClick,[i.treeId,t],!0)&&j.apply(i.callback.onRightClick,[e,i.treeId,t]),"function"!=typeof i.callback.onRightClick},v=function(e){return e=e.originalEvent.srcElement.nodeName.toLowerCase(),"input"===e||"textarea"===e};var j={apply:function(e,t,i){return"function"==typeof e?e.apply(P,t?t:[]):i},canAsync:function(e,t){var i=e.data.key.children;return e.async.enable&&t&&t.isParent&&!(t.zAsync||t[i]&&t[i].length>0)},clone:function(e){if(null===e)return null;var t,i=j.isArray(e)?[]:{};for(t in e)i[t]=e[t]instanceof Date?new Date(e[t].getTime()):"object"==typeof e[t]?j.clone(e[t]):e[t];return i},eqs:function(e,t){return e.toLowerCase()===t.toLowerCase()},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},$:function(e,t,i){return t&&"string"!=typeof t&&(i=t,t=""),"string"==typeof e?q(e,i?i.treeObj.get(0).ownerDocument:null):q("#"+e.tId+t,i?i.treeObj:null)},getMDom:function(e,t,i){if(!t)return null;for(;t&&t.id!==e.treeId;){for(var r=0,n=i.length;t.tagName&&n>r;r++)if(j.eqs(t.tagName,i[r].tagName)&&null!==t.getAttribute(i[r].attrName))return t;t=t.parentNode}return null},getNodeMainDom:function(e){return q(e).parent("li").get(0)||q(e).parentsUntil("li").parent().get(0)},isChildOrSelf:function(e,t){return q(e).closest("#"+t).length>0},uCanDo:function(){return!0}},i={addNodes:function(e,t,r,n,o){if(!e.data.keep.leaf||!t||t.isParent)if(j.isArray(n)||(n=[n]),e.data.simpleData.enable&&(n=h.transformTozTreeFormat(e,n)),t){var a=k(t,f.id.SWITCH,e),s=k(t,f.id.ICON,e),l=k(t,f.id.UL,e);t.open||(i.replaceSwitchClass(t,a,f.folder.CLOSE),i.replaceIcoClass(t,s,f.folder.CLOSE),t.open=!1,l.css({display:"none"})),h.addNodesData(e,t,r,n),i.createNodes(e,t.level+1,n,t,r),o||i.expandCollapseParentNode(e,t,!0)}else h.addNodesData(e,h.getRoot(e),r,n),i.createNodes(e,0,n,null,r)},appendNodes:function(e,t,r,n,o,a,s){if(!r)return[];var l,c,d=[],u=e.data.key.children,p=(n?n:h.getRoot(e))[u];(!p||o>=p.length)&&(o=-1);for(var g=0,f=r.length;f>g;g++){var m=r[g];a&&(l=(0===o||p.length==r.length)&&0==g,c=0>o&&g==r.length-1,h.initNode(e,t,m,n,l,c,s),h.addNodeCache(e,m)),l=[],m[u]&&m[u].length>0&&(l=i.appendNodes(e,t+1,m[u],m,-1,a,s&&m.open)),s&&(i.makeDOMNodeMainBefore(d,e,m),i.makeDOMNodeLine(d,e,m),h.getBeforeA(e,m,d),i.makeDOMNodeNameBefore(d,e,m),h.getInnerBeforeA(e,m,d),i.makeDOMNodeIcon(d,e,m),h.getInnerAfterA(e,m,d),i.makeDOMNodeNameAfter(d,e,m),h.getAfterA(e,m,d),m.isParent&&m.open&&i.makeUlHtml(e,m,d,l.join("")),i.makeDOMNodeMainAfter(d,e,m),h.addCreatedNode(e,m))}return d},appendParentULDom:function(e,t){var r=[],n=k(t,e);!n.get(0)&&t.parentTId&&(i.appendParentULDom(e,t.getParentNode()),n=k(t,e));var o=k(t,f.id.UL,e);o.get(0)&&o.remove(),o=i.appendNodes(e,t.level+1,t[e.data.key.children],t,-1,!1,!0),i.makeUlHtml(e,t,r,o.join("")),n.append(r.join(""))},asyncNode:function(b,a,c,d){var e,g;if(a&&!a.isParent)return j.apply(d),!1;if(a&&a.isAjaxing)return!1;if(0==j.apply(b.callback.beforeAsync,[b.treeId,a],!0))return j.apply(d),!1;a&&(a.isAjaxing=!0,k(a,f.id.ICON,b).attr({style:"","class":f.className.BUTTON+" "+f.className.ICO_LOADING}));var m={};for(e=0,g=b.async.autoParam.length;a&&g>e;e++){var o=b.async.autoParam[e].split("="),n=o;o.length>1&&(n=o[1],o=o[0]),m[n]=a[o]}if(j.isArray(b.async.otherParam))for(e=0,g=b.async.otherParam.length;g>e;e+=2)m[b.async.otherParam[e]]=b.async.otherParam[e+1];else for(var l in b.async.otherParam)m[l]=b.async.otherParam[l];var r=h.getRoot(b)._ver;return q.ajax({contentType:b.async.contentType,cache:!1,type:b.async.type,url:j.apply(b.async.url,[b.treeId,a],b.async.url),data:m,dataType:b.async.dataType,success:function(e){if(r==h.getRoot(b)._ver){var g=[];try{g=e&&0!=e.length?"string"==typeof e?eval("("+e+")"):e:[]}catch(m){g=e}a&&(a.isAjaxing=null,a.zAsync=!0),i.setNodeLineIcos(b,a),g&&""!==g?(g=j.apply(b.async.dataFilter,[b.treeId,a,g],g),i.addNodes(b,a,-1,g?j.clone(g):[],!!c)):i.addNodes(b,a,-1,[],!!c),b.treeObj.trigger(f.event.ASYNC_SUCCESS,[b.treeId,a,e]),j.apply(d)}},error:function(e,t,n){r==h.getRoot(b)._ver&&(a&&(a.isAjaxing=null),i.setNodeLineIcos(b,a),b.treeObj.trigger(f.event.ASYNC_ERROR,[b.treeId,a,e,t,n]))}}),!0},cancelPreSelectedNode:function(e,t,i){var r,n,o=h.getRoot(e).curSelectedList;for(r=o.length-1;r>=0;r--)if(n=o[r],t===n||!t&&(!i||i!==n)){if(k(n,f.id.A,e).removeClass(f.node.CURSELECTED),t){h.removeSelectedNode(e,t);break}o.splice(r,1),e.treeObj.trigger(f.event.UNSELECTED,[e.treeId,n])}},createNodeCallback:function(e){if(e.callback.onNodeCreated||e.view.addDiyDom)for(var t=h.getRoot(e);t.createdNodes.length>0;){var i=t.createdNodes.shift();j.apply(e.view.addDiyDom,[e.treeId,i]),e.callback.onNodeCreated&&e.treeObj.trigger(f.event.NODECREATED,[e.treeId,i])}},createNodes:function(e,t,r,n,o){if(r&&0!=r.length){var a=h.getRoot(e),s=e.data.key.children,s=!n||n.open||!!k(n[s][0],e).get(0);a.createdNodes=[];var l,c,t=i.appendNodes(e,t,r,n,o,!0,s);n?(n=k(n,f.id.UL,e),n.get(0)&&(l=n)):l=e.treeObj,l&&(o>=0&&(c=l.children()[o]),o>=0&&c?q(c).before(t.join("")):l.append(t.join(""))),i.createNodeCallback(e)}},destroy:function(e){e&&(h.initCache(e),h.initRoot(e),l.unbindTree(e),l.unbindEvent(e),e.treeObj.empty(),delete s[e.treeId])},expandCollapseNode:function(e,t,r,n,o){var a,s=h.getRoot(e),l=e.data.key.children;if(t)if(s.expandTriggerFlag&&(a=o,o=function(){a&&a(),t.open?e.treeObj.trigger(f.event.EXPAND,[e.treeId,t]):e.treeObj.trigger(f.event.COLLAPSE,[e.treeId,t])},s.expandTriggerFlag=!1),!t.open&&t.isParent&&(!k(t,f.id.UL,e).get(0)||t[l]&&t[l].length>0&&!k(t[l][0],e).get(0))&&(i.appendParentULDom(e,t),i.createNodeCallback(e)),t.open==r)j.apply(o,[]);else{var r=k(t,f.id.UL,e),s=k(t,f.id.SWITCH,e),c=k(t,f.id.ICON,e);t.isParent?(t.open=!t.open,t.iconOpen&&t.iconClose&&c.attr("style",i.makeNodeIcoStyle(e,t)),t.open?(i.replaceSwitchClass(t,s,f.folder.OPEN),i.replaceIcoClass(t,c,f.folder.OPEN),0==n||""==e.view.expandSpeed?(r.show(),j.apply(o,[])):t[l]&&t[l].length>0?r.slideDown(e.view.expandSpeed,o):(r.show(),j.apply(o,[]))):(i.replaceSwitchClass(t,s,f.folder.CLOSE),i.replaceIcoClass(t,c,f.folder.CLOSE),0!=n&&""!=e.view.expandSpeed&&t[l]&&t[l].length>0?r.slideUp(e.view.expandSpeed,o):(r.hide(),j.apply(o,[])))):j.apply(o,[])}else j.apply(o,[])},expandCollapseParentNode:function(e,t,r,n,o){t&&(t.parentTId?(i.expandCollapseNode(e,t,r,n),t.parentTId&&i.expandCollapseParentNode(e,t.getParentNode(),r,n,o)):i.expandCollapseNode(e,t,r,n,o))},expandCollapseSonNode:function(e,t,r,n,o){var a=h.getRoot(e),s=e.data.key.children,a=t?t[s]:a[s],s=t?!1:n,l=h.getRoot(e).expandTriggerFlag;if(h.getRoot(e).expandTriggerFlag=!1,a)for(var c=0,d=a.length;d>c;c++)a[c]&&i.expandCollapseSonNode(e,a[c],r,s);h.getRoot(e).expandTriggerFlag=l,i.expandCollapseNode(e,t,r,n,o)},isSelectedNode:function(e,t){if(!t)return!1;var i,r=h.getRoot(e).curSelectedList;for(i=r.length-1;i>=0;i--)if(t===r[i])return!0;return!1},makeDOMNodeIcon:function(e,t,r){var n=h.getNodeName(t,r),n=t.view.nameIsHTML?n:n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e.push("<span id='",r.tId,f.id.ICON,"' title='' treeNode",f.id.ICON," class='",i.makeNodeIcoClass(t,r),"' style='",i.makeNodeIcoStyle(t,r),"'></span><span id='",r.tId,f.id.SPAN,"' class='",f.className.NAME,"'>",n,"</span>")},makeDOMNodeLine:function(e,t,r){e.push("<span id='",r.tId,f.id.SWITCH,"' title='' class='",i.makeNodeLineClass(t,r),"' treeNode",f.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(e){e.push("</li>")},makeDOMNodeMainBefore:function(e,t,i){e.push("<li id='",i.tId,"' class='",f.className.LEVEL,i.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(e){e.push("</a>")},makeDOMNodeNameBefore:function(e,t,r){var n,o=h.getNodeTitle(t,r),a=i.makeNodeUrl(t,r),s=i.makeNodeFontCss(t,r),l=[];for(n in s)l.push(n,":",s[n],";");e.push("<a id='",r.tId,f.id.A,"' class='",f.className.LEVEL,r.level,"' treeNode",f.id.A,' onclick="',r.click||"",'" ',null!=a&&a.length>0?"href='"+a+"'":""," target='",i.makeNodeTarget(r),"' style='",l.join(""),"'"),j.apply(t.view.showTitle,[t.treeId,r],t.view.showTitle)&&o&&e.push("title='",o.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),e.push(">")},makeNodeFontCss:function(e,t){var i=j.apply(e.view.fontCss,[e.treeId,t],e.view.fontCss);return i&&"function"!=typeof i?i:{}},makeNodeIcoClass:function(e,t){var i=["ico"];return t.isAjaxing||(i[0]=(t.iconSkin?t.iconSkin+"_":"")+i[0],t.isParent?i.push(t.open?f.folder.OPEN:f.folder.CLOSE):i.push(f.folder.DOCU)),f.className.BUTTON+" "+i.join("_")},makeNodeIcoStyle:function(e,t){var i=[];if(!t.isAjaxing){var r=t.isParent&&t.iconOpen&&t.iconClose?t.open?t.iconOpen:t.iconClose:t[e.data.key.icon];r&&i.push("background:url(",r,") 0 0 no-repeat;"),(0==e.view.showIcon||!j.apply(e.view.showIcon,[e.treeId,t],!0))&&i.push("width:0px;height:0px;")}return i.join("")},makeNodeLineClass:function(e,t){var r=[];return e.view.showLine?0==t.level&&t.isFirstNode&&t.isLastNode?r.push(f.line.ROOT):0==t.level&&t.isFirstNode?r.push(f.line.ROOTS):t.isLastNode?r.push(f.line.BOTTOM):r.push(f.line.CENTER):r.push(f.line.NOLINE),t.isParent?r.push(t.open?f.folder.OPEN:f.folder.CLOSE):r.push(f.folder.DOCU),i.makeNodeLineClassEx(t)+r.join("_")},makeNodeLineClassEx:function(e){return f.className.BUTTON+" "+f.className.LEVEL+e.level+" "+f.className.SWITCH+" "},makeNodeTarget:function(e){return e.target||"_blank"},makeNodeUrl:function(e,t){var i=e.data.key.url;return t[i]?t[i]:null},makeUlHtml:function(e,t,r,n){r.push("<ul id='",t.tId,f.id.UL,"' class='",f.className.LEVEL,t.level," ",i.makeUlLineClass(e,t),"' style='display:",t.open?"block":"none","'>"),r.push(n),r.push("</ul>")},makeUlLineClass:function(e,t){return e.view.showLine&&!t.isLastNode?f.line.LINE:""},removeChildNodes:function(e,t){if(t){var r=e.data.key.children,n=t[r];if(n){for(var o=0,a=n.length;a>o;o++)h.removeNodeCache(e,n[o]);h.removeSelectedNode(e),delete t[r],e.data.keep.parent?k(t,f.id.UL,e).empty():(t.isParent=!1,t.open=!1,r=k(t,f.id.SWITCH,e),n=k(t,f.id.ICON,e),i.replaceSwitchClass(t,r,f.folder.DOCU),i.replaceIcoClass(t,n,f.folder.DOCU),k(t,f.id.UL,e).remove())}}},scrollIntoView:function(e){if(e)if(e.scrollIntoViewIfNeeded)e.scrollIntoViewIfNeeded();else if(e.scrollIntoView)e.scrollIntoView(!1);else try{e.focus().blur()}catch(t){}},setFirstNode:function(e,t){var i=e.data.key.children;t[i].length>0&&(t[i][0].isFirstNode=!0)},setLastNode:function(e,t){var i=e.data.key.children,r=t[i].length;r>0&&(t[i][r-1].isLastNode=!0)},removeNode:function(e,t){var r=h.getRoot(e),n=e.data.key.children,o=t.parentTId?t.getParentNode():r;if(t.isFirstNode=!1,t.isLastNode=!1,t.getPreNode=function(){return null},t.getNextNode=function(){return null},h.getNodeCache(e,t.tId)){k(t,e).remove(),h.removeNodeCache(e,t),h.removeSelectedNode(e,t);for(var a=0,s=o[n].length;s>a;a++)if(o[n][a].tId==t.tId){o[n].splice(a,1);break}i.setFirstNode(e,o),i.setLastNode(e,o);var l,a=o[n].length;if(e.data.keep.parent||0!=a){if(e.view.showLine&&a>0){var c=o[n][a-1],a=k(c,f.id.UL,e),s=k(c,f.id.SWITCH,e);l=k(c,f.id.ICON,e),o==r?1==o[n].length?i.replaceSwitchClass(c,s,f.line.ROOT):(r=k(o[n][0],f.id.SWITCH,e),i.replaceSwitchClass(o[n][0],r,f.line.ROOTS),i.replaceSwitchClass(c,s,f.line.BOTTOM)):i.replaceSwitchClass(c,s,f.line.BOTTOM),a.removeClass(f.line.LINE)}}else o.isParent=!1,o.open=!1,a=k(o,f.id.UL,e),s=k(o,f.id.SWITCH,e),l=k(o,f.id.ICON,e),i.replaceSwitchClass(o,s,f.folder.DOCU),i.replaceIcoClass(o,l,f.folder.DOCU),a.css("display","none")}},replaceIcoClass:function(e,t,i){if(t&&!e.isAjaxing&&(e=t.attr("class"),void 0!=e)){switch(e=e.split("_"),i){case f.folder.OPEN:case f.folder.CLOSE:case f.folder.DOCU:e[e.length-1]=i}t.attr("class",e.join("_"))}},replaceSwitchClass:function(e,t,r){if(t){var n=t.attr("class");if(void 0!=n){switch(n=n.split("_"),r){case f.line.ROOT:case f.line.ROOTS:case f.line.CENTER:case f.line.BOTTOM:case f.line.NOLINE:n[0]=i.makeNodeLineClassEx(e)+r;break;case f.folder.OPEN:case f.folder.CLOSE:case f.folder.DOCU:n[1]=r}t.attr("class",n.join("_")),r!==f.folder.DOCU?t.removeAttr("disabled"):t.attr("disabled","disabled")}}},selectNode:function(e,t,r){r||i.cancelPreSelectedNode(e,null,t),k(t,f.id.A,e).addClass(f.node.CURSELECTED),h.addSelectedNode(e,t),e.treeObj.trigger(f.event.SELECTED,[e.treeId,t])},setNodeFontCss:function(e,t){var r=k(t,f.id.A,e),n=i.makeNodeFontCss(e,t);n&&r.css(n)},setNodeLineIcos:function(e,t){if(t){var r=k(t,f.id.SWITCH,e),n=k(t,f.id.UL,e),o=k(t,f.id.ICON,e),a=i.makeUlLineClass(e,t);0==a.length?n.removeClass(f.line.LINE):n.addClass(a),r.attr("class",i.makeNodeLineClass(e,t)),t.isParent?r.removeAttr("disabled"):r.attr("disabled","disabled"),o.removeAttr("style"),o.attr("style",i.makeNodeIcoStyle(e,t)),o.attr("class",i.makeNodeIcoClass(e,t))}},setNodeName:function(e,t){var i=h.getNodeTitle(e,t),r=k(t,f.id.SPAN,e);r.empty(),e.view.nameIsHTML?r.html(h.getNodeName(e,t)):r.text(h.getNodeName(e,t)),j.apply(e.view.showTitle,[e.treeId,t],e.view.showTitle)&&k(t,f.id.A,e).attr("title",i?i:"")},setNodeTarget:function(e,t){k(t,f.id.A,e).attr("target",i.makeNodeTarget(t))},setNodeUrl:function(e,t){var r=k(t,f.id.A,e),n=i.makeNodeUrl(e,t);null==n||0==n.length?r.removeAttr("href"):r.attr("href",n)},switchNode:function(e,t){t.open||!j.canAsync(e,t)?i.expandCollapseNode(e,t,!t.open):e.async.enable?i.asyncNode(e,t)||i.expandCollapseNode(e,t,!t.open):t&&i.expandCollapseNode(e,t,!t.open)}};q.fn.zTree={consts:{className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch",NAME:"node_name"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:j,view:i,event:l,data:h},getZTreeObj:function(e){return(e=h.getZTreeTools(e))?e:null},destroy:function(e){if(e&&e.length>0)i.destroy(h.getSetting(e));else for(var t in s)i.destroy(s[t])},init:function(e,t,r){var n=j.clone(O);return q.extend(!0,n,t),n.treeId=e.attr("id"),n.treeObj=e,n.treeObj.empty(),s[n.treeId]=n,"undefined"==typeof document.body.style.maxHeight&&(n.view.expandSpeed=""),h.initRoot(n),e=h.getRoot(n),t=n.data.key.children,r=r?j.clone(j.isArray(r)?r:[r]):[],e[t]=n.data.simpleData.enable?h.transformTozTreeFormat(n,r):r,h.initCache(n),l.unbindTree(n),l.bindTree(n),l.unbindEvent(n),l.bindEvent(n),r={setting:n,addNodes:function(e,t,r,o){function a(){i.addNodes(n,e,t,l,1==o)}if(e||(e=null),e&&!e.isParent&&n.data.keep.leaf)return null;var s=parseInt(t,10);if(isNaN(s)?(o=!!r,r=t,t=-1):t=s,!r)return null;var l=j.clone(j.isArray(r)?r:[r]);return j.canAsync(n,e)?i.asyncNode(n,e,o,a):a(),l},cancelSelectedNode:function(e){i.cancelPreSelectedNode(n,e)},destroy:function(){i.destroy(n)},expandAll:function(e){return e=!!e,i.expandCollapseSonNode(n,null,e,!0),e},expandNode:function(e,t,r,o,a){function s(){var t=k(e,n).get(0);t&&o!==!1&&i.scrollIntoView(t)}return e&&e.isParent?(t!==!0&&t!==!1&&(t=!e.open),(a=!!a)&&t&&0==j.apply(n.callback.beforeExpand,[n.treeId,e],!0)?null:a&&!t&&0==j.apply(n.callback.beforeCollapse,[n.treeId,e],!0)?null:(t&&e.parentTId&&i.expandCollapseParentNode(n,e.getParentNode(),t,!1),t!==e.open||r?(h.getRoot(n).expandTriggerFlag=a,!j.canAsync(n,e)&&r?i.expandCollapseSonNode(n,e,t,!0,s):(e.open=!t,i.switchNode(this.setting,e),s()),t):null)):null},getNodes:function(){return h.getNodes(n)},getNodeByParam:function(e,t,i){return e?h.getNodeByParam(n,i?i[n.data.key.children]:h.getNodes(n),e,t):null},getNodeByTId:function(e){return h.getNodeCache(n,e)},getNodesByParam:function(e,t,i){return e?h.getNodesByParam(n,i?i[n.data.key.children]:h.getNodes(n),e,t):null},getNodesByParamFuzzy:function(e,t,i){return e?h.getNodesByParamFuzzy(n,i?i[n.data.key.children]:h.getNodes(n),e,t):null;
},getNodesByFilter:function(e,t,i,r){return t=!!t,e&&"function"==typeof e?h.getNodesByFilter(n,i?i[n.data.key.children]:h.getNodes(n),e,t,r):t?null:[]},getNodeIndex:function(e){if(!e)return null;for(var t=n.data.key.children,i=e.parentTId?e.getParentNode():h.getRoot(n),r=0,o=i[t].length;o>r;r++)if(i[t][r]==e)return r;return-1},getSelectedNodes:function(){for(var e=[],t=h.getRoot(n).curSelectedList,i=0,r=t.length;r>i;i++)e.push(t[i]);return e},isSelectedNode:function(e){return h.isSelectedNode(n,e)},reAsyncChildNodes:function(e,t,r){if(this.setting.async.enable){var o=!e;if(o&&(e=h.getRoot(n)),"refresh"==t){for(var t=this.setting.data.key.children,a=0,s=e[t]?e[t].length:0;s>a;a++)h.removeNodeCache(n,e[t][a]);h.removeSelectedNode(n),e[t]=[],o?this.setting.treeObj.empty():k(e,f.id.UL,n).empty()}i.asyncNode(this.setting,o?null:e,!!r)}},refresh:function(){this.setting.treeObj.empty();var e=h.getRoot(n),t=e[n.data.key.children];h.initRoot(n),e[n.data.key.children]=t,h.initCache(n),i.createNodes(n,0,e[n.data.key.children],null,-1)},removeChildNodes:function(e){if(!e)return null;var t=e[n.data.key.children];return i.removeChildNodes(n,e),t?t:null},removeNode:function(e,t){e&&(t=!!t,t&&0==j.apply(n.callback.beforeRemove,[n.treeId,e],!0)||(i.removeNode(n,e),t&&this.setting.treeObj.trigger(f.event.REMOVE,[n.treeId,e])))},selectNode:function(e,t,r){function o(){if(!r){var t=k(e,n).get(0);i.scrollIntoView(t)}}if(e&&j.uCanDo(n)){if(t=n.view.selectedMulti&&t,e.parentTId)i.expandCollapseParentNode(n,e.getParentNode(),!0,!1,o);else try{k(e,n).focus().blur()}catch(a){}i.selectNode(n,e,t)}},transformTozTreeNodes:function(e){return h.transformTozTreeFormat(n,e)},transformToArray:function(e){return h.transformToArrayFormat(n,e)},updateNode:function(e){e&&k(e,n).get(0)&&j.uCanDo(n)&&(i.setNodeName(n,e),i.setNodeTarget(n,e),i.setNodeUrl(n,e),i.setNodeLineIcos(n,e),i.setNodeFontCss(n,e))}},e.treeTools=r,h.setZTreeTools(n,r),e[t]&&e[t].length>0?i.createNodes(n,0,e[t],null,-1):n.async.enable&&n.async.url&&""!==n.async.url&&i.asyncNode(n),r}};var P=q.fn.zTree,k=j.$,f=P.consts}(jQuery),function(e){var t,i,r,n={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},o={check:{enable:!1,autoCheckTrigger:!1,chkStyle:n.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:n.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};t=function(e,t){if(t.chkDisabled===!0)return!1;var i=c.getSetting(e.data.treeId),r=i.data.key.checked;return 0==a.apply(i.callback.beforeCheck,[i.treeId,t],!0)?!0:(t[r]=!t[r],l.checkNodeRelation(i,t),r=d(t,s.id.CHECK,i),l.setChkClass(i,r,t),l.repairParentChkClassWithSelf(i,t),i.treeObj.trigger(s.event.CHECK,[e,i.treeId,t]),!0)},i=function(e,t){if(t.chkDisabled===!0)return!1;var i=c.getSetting(e.data.treeId),r=d(t,s.id.CHECK,i);return t.check_Focus=!0,l.setChkClass(i,r,t),!0},r=function(e,t){if(t.chkDisabled===!0)return!1;var i=c.getSetting(e.data.treeId),r=d(t,s.id.CHECK,i);return t.check_Focus=!1,l.setChkClass(i,r,t),!0},e.extend(!0,e.fn.zTree.consts,n),e.extend(!0,e.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(e,t){var i,r,n,o=e.data.key.children,a=e.data.key.checked;if(i=s.radio,e.check.chkStyle==i.STYLE){var h=c.getRadioCheckedList(e);if(t[a])if(e.check.radioType==i.TYPE_ALL){for(r=h.length-1;r>=0;r--)i=h[r],i[a]&&i!=t&&(i[a]=!1,h.splice(r,1),l.setChkClass(e,d(i,s.id.CHECK,e),i),i.parentTId!=t.parentTId&&l.repairParentChkClassWithSelf(e,i));h.push(t)}else for(h=t.parentTId?t.getParentNode():c.getRoot(e),r=0,n=h[o].length;n>r;r++)i=h[o][r],i[a]&&i!=t&&(i[a]=!1,l.setChkClass(e,d(i,s.id.CHECK,e),i));else if(e.check.radioType==i.TYPE_ALL)for(r=0,n=h.length;n>r;r++)if(t==h[r]){h.splice(r,1);break}}else t[a]&&(!t[o]||0==t[o].length||e.check.chkboxType.Y.indexOf("s")>-1)&&l.setSonNodeCheckBox(e,t,!0),!t[a]&&(!t[o]||0==t[o].length||e.check.chkboxType.N.indexOf("s")>-1)&&l.setSonNodeCheckBox(e,t,!1),t[a]&&e.check.chkboxType.Y.indexOf("p")>-1&&l.setParentNodeCheckBox(e,t,!0),!t[a]&&e.check.chkboxType.N.indexOf("p")>-1&&l.setParentNodeCheckBox(e,t,!1)},makeChkClass:function(e,t){var i=e.data.key.checked,r=s.checkbox,n=s.radio,o="",o=t.chkDisabled===!0?r.DISABLED:t.halfCheck?r.PART:e.check.chkStyle==n.STYLE?t.check_Child_State<1?r.FULL:r.PART:t[i]?2===t.check_Child_State||-1===t.check_Child_State?r.FULL:r.PART:t.check_Child_State<1?r.FULL:r.PART,i=e.check.chkStyle+"_"+(t[i]?r.TRUE:r.FALSE)+"_"+o,i=t.check_Focus&&t.chkDisabled!==!0?i+"_"+r.FOCUS:i;return s.className.BUTTON+" "+r.DEFAULT+" "+i},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===s.checkbox.STYLE)for(var i=e.data.key.checked,r=e.data.key.children,n=c.getRoot(e),o=0,a=n[r].length;a>o;o++){var d=n[r][o];d.nocheck!==!0&&d.chkDisabled!==!0&&(d[i]=t),l.setSonNodeCheckBox(e,d,t)}},repairChkClass:function(e,t){if(t&&(c.makeChkFlag(e,t),t.nocheck!==!0)){var i=d(t,s.id.CHECK,e);l.setChkClass(e,i,t)}},repairParentChkClass:function(e,t){if(t&&t.parentTId){var i=t.getParentNode();l.repairChkClass(e,i),l.repairParentChkClass(e,i)}},repairParentChkClassWithSelf:function(e,t){if(t){var i=e.data.key.children;t[i]&&t[i].length>0?l.repairParentChkClass(e,t[i][0]):l.repairParentChkClass(e,t)}},repairSonChkDisabled:function(e,t,i,r){if(t){var n=e.data.key.children;if(t.chkDisabled!=i&&(t.chkDisabled=i),l.repairChkClass(e,t),t[n]&&r)for(var o=0,a=t[n].length;a>o;o++)l.repairSonChkDisabled(e,t[n][o],i,r)}},repairParentChkDisabled:function(e,t,i,r){t&&(t.chkDisabled!=i&&r&&(t.chkDisabled=i),l.repairChkClass(e,t),l.repairParentChkDisabled(e,t.getParentNode(),i,r))},setChkClass:function(e,t,i){t&&(i.nocheck===!0?t.hide():t.show(),t.attr("class",l.makeChkClass(e,i)))},setParentNodeCheckBox:function(e,t,i,r){var n=e.data.key.children,o=e.data.key.checked,a=d(t,s.id.CHECK,e);if(r||(r=t),c.makeChkFlag(e,t),t.nocheck!==!0&&t.chkDisabled!==!0&&(t[o]=i,l.setChkClass(e,a,t),e.check.autoCheckTrigger&&t!=r&&e.treeObj.trigger(s.event.CHECK,[null,e.treeId,t])),t.parentTId){if(a=!0,!i)for(var n=t.getParentNode()[n],h=0,u=n.length;u>h;h++)if(n[h].nocheck!==!0&&n[h].chkDisabled!==!0&&n[h][o]||(n[h].nocheck===!0||n[h].chkDisabled===!0)&&n[h].check_Child_State>0){a=!1;break}a&&l.setParentNodeCheckBox(e,t.getParentNode(),i,r)}},setSonNodeCheckBox:function(e,t,i,r){if(t){var n=e.data.key.children,o=e.data.key.checked,a=d(t,s.id.CHECK,e);r||(r=t);var h=!1;if(t[n])for(var u=0,p=t[n].length;p>u;u++){var g=t[n][u];l.setSonNodeCheckBox(e,g,i,r),g.chkDisabled===!0&&(h=!0)}t!=c.getRoot(e)&&t.chkDisabled!==!0&&(h&&t.nocheck!==!0&&c.makeChkFlag(e,t),t.nocheck!==!0&&t.chkDisabled!==!0?(t[o]=i,h||(t.check_Child_State=t[n]&&t[n].length>0?i?2:0:-1)):t.check_Child_State=-1,l.setChkClass(e,a,t),e.check.autoCheckTrigger&&t!=r&&t.nocheck!==!0&&t.chkDisabled!==!0&&e.treeObj.trigger(s.event.CHECK,[null,e.treeId,t]))}}},event:{},data:{getRadioCheckedList:function(e){for(var t=c.getRoot(e).radioCheckedList,i=0,r=t.length;r>i;i++)c.getNodeCache(e,t[i].tId)||(t.splice(i,1),i--,r--);return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var i=e.data.key.checked;return{checked:t[i],half:t.halfCheck?t.halfCheck:e.check.chkStyle==s.radio.STYLE?2===t.check_Child_State:t[i]?t.check_Child_State>-1&&t.check_Child_State<2:t.check_Child_State>0}},getTreeCheckedNodes:function(e,t,i,r){if(!t)return[];for(var n=e.data.key.children,o=e.data.key.checked,a=i&&e.check.chkStyle==s.radio.STYLE&&e.check.radioType==s.radio.TYPE_ALL,r=r?r:[],l=0,d=t.length;d>l&&(t[l].nocheck===!0||t[l].chkDisabled===!0||t[l][o]!=i||(r.push(t[l]),!a))&&(c.getTreeCheckedNodes(e,t[l][n],i,r),!(a&&r.length>0));l++);return r},getTreeChangeCheckedNodes:function(e,t,i){if(!t)return[];for(var r=e.data.key.children,n=e.data.key.checked,i=i?i:[],o=0,a=t.length;a>o;o++)t[o].nocheck!==!0&&t[o].chkDisabled!==!0&&t[o][n]!=t[o].checkedOld&&i.push(t[o]),c.getTreeChangeCheckedNodes(e,t[o][r],i);return i},makeChkFlag:function(e,t){if(t){var i=e.data.key.children,r=e.data.key.checked,n=-1;if(t[i])for(var o=0,a=t[i].length;a>o;o++){var l=t[i][o],c=-1;if(e.check.chkStyle==s.radio.STYLE){if(c=l.nocheck===!0||l.chkDisabled===!0?l.check_Child_State:l.halfCheck===!0?2:l[r]?2:l.check_Child_State>0?2:0,2==c){n=2;break}0==c&&(n=0)}else if(e.check.chkStyle==s.checkbox.STYLE){if(c=l.nocheck===!0||l.chkDisabled===!0?l.check_Child_State:l.halfCheck===!0?1:l[r]?-1===l.check_Child_State||2===l.check_Child_State?2:1:l.check_Child_State>0?1:0,1===c){n=1;break}if(2===c&&n>-1&&o>0&&c!==n){n=1;break}if(2===n&&c>-1&&2>c){n=1;break}c>-1&&(n=c)}}t.check_Child_State=n}}}});var e=e.fn.zTree,a=e._z.tools,s=e.consts,l=e._z.view,c=e._z.data,d=a.$;c.exSetting(o),c.addInitBind(function(e){e.treeObj.bind(s.event.CHECK,function(t,i,r,n){t.srcEvent=i,a.apply(e.callback.onCheck,[t,r,n])})}),c.addInitUnBind(function(e){e.treeObj.unbind(s.event.CHECK)}),c.addInitCache(function(){}),c.addInitNode(function(e,t,i,r){i&&(t=e.data.key.checked,"string"==typeof i[t]&&(i[t]=a.eqs(i[t],"true")),i[t]=!!i[t],i.checkedOld=i[t],"string"==typeof i.nocheck&&(i.nocheck=a.eqs(i.nocheck,"true")),i.nocheck=!!i.nocheck||e.check.nocheckInherit&&r&&!!r.nocheck,"string"==typeof i.chkDisabled&&(i.chkDisabled=a.eqs(i.chkDisabled,"true")),i.chkDisabled=!!i.chkDisabled||e.check.chkDisabledInherit&&r&&!!r.chkDisabled,"string"==typeof i.halfCheck&&(i.halfCheck=a.eqs(i.halfCheck,"true")),i.halfCheck=!!i.halfCheck,i.check_Child_State=-1,i.check_Focus=!1,i.getCheckStatus=function(){return c.getCheckStatus(e,i)},e.check.chkStyle==s.radio.STYLE&&e.check.radioType==s.radio.TYPE_ALL&&i[t]&&c.getRoot(e).radioCheckedList.push(i))}),c.addInitProxy(function(e){var n=e.target,o=c.getSetting(e.data.treeId),l="",d=null,h="",u=null;if(a.eqs(e.type,"mouseover")?o.check.enable&&a.eqs(n.tagName,"span")&&null!==n.getAttribute("treeNode"+s.id.CHECK)&&(l=a.getNodeMainDom(n).id,h="mouseoverCheck"):a.eqs(e.type,"mouseout")?o.check.enable&&a.eqs(n.tagName,"span")&&null!==n.getAttribute("treeNode"+s.id.CHECK)&&(l=a.getNodeMainDom(n).id,h="mouseoutCheck"):a.eqs(e.type,"click")&&o.check.enable&&a.eqs(n.tagName,"span")&&null!==n.getAttribute("treeNode"+s.id.CHECK)&&(l=a.getNodeMainDom(n).id,h="checkNode"),l.length>0)switch(d=c.getNodeCache(o,l),h){case"checkNode":u=t;break;case"mouseoverCheck":u=i;break;case"mouseoutCheck":u=r}return{stop:"checkNode"===h,node:d,nodeEventType:h,nodeEventCallback:u,treeEventType:"",treeEventCallback:null}},!0),c.addInitRoot(function(e){c.getRoot(e).radioCheckedList=[]}),c.addBeforeA(function(e,t,i){e.check.enable&&(c.makeChkFlag(e,t),i.push("<span ID='",t.tId,s.id.CHECK,"' class='",l.makeChkClass(e,t),"' treeNode",s.id.CHECK,t.nocheck===!0?" style='display:none;'":"","></span>"))}),c.addZTreeTools(function(e,t){t.checkNode=function(e,t,i,r){var n=this.setting.data.key.checked;e.chkDisabled===!0||(t!==!0&&t!==!1&&(t=!e[n]),r=!!r,e[n]===t&&!i||r&&0==a.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],!0)||!a.uCanDo(this.setting)||!this.setting.check.enable||e.nocheck===!0)||(e[n]=t,t=d(e,s.id.CHECK,this.setting),(i||this.setting.check.chkStyle===s.radio.STYLE)&&l.checkNodeRelation(this.setting,e),l.setChkClass(this.setting,t,e),l.repairParentChkClassWithSelf(this.setting,e),r&&this.setting.treeObj.trigger(s.event.CHECK,[null,this.setting.treeId,e]))},t.checkAllNodes=function(e){l.repairAllChk(this.setting,!!e)},t.getCheckedNodes=function(e){var t=this.setting.data.key.children;return c.getTreeCheckedNodes(this.setting,c.getRoot(this.setting)[t],e!==!1)},t.getChangeCheckedNodes=function(){var e=this.setting.data.key.children;return c.getTreeChangeCheckedNodes(this.setting,c.getRoot(this.setting)[e])},t.setChkDisabled=function(e,t,i,r){t=!!t,i=!!i,l.repairSonChkDisabled(this.setting,e,t,!!r),l.repairParentChkDisabled(this.setting,e.getParentNode(),t,i)};var i=t.updateNode;t.updateNode=function(e,r){if(i&&i.apply(t,arguments),e&&this.setting.check.enable&&d(e,this.setting).get(0)&&a.uCanDo(this.setting)){var n=d(e,s.id.CHECK,this.setting);(1==r||this.setting.check.chkStyle===s.radio.STYLE)&&l.checkNodeRelation(this.setting,e),l.setChkClass(this.setting,n,e),l.repairParentChkClassWithSelf(this.setting,e)}}});var h=l.createNodes;l.createNodes=function(e,t,i,r,n){h&&h.apply(l,arguments),i&&l.repairParentChkClassWithSelf(e,r)};var u=l.removeNode;l.removeNode=function(e,t){var i=t.getParentNode();u&&u.apply(l,arguments),t&&i&&(l.repairChkClass(e,i),l.repairParentChkClass(e,i))};var p=l.appendNodes;l.appendNodes=function(e,t,i,r,n,o,a){var s="";return p&&(s=p.apply(l,arguments)),r&&c.makeChkFlag(e,r),s}}(jQuery),function(e){var t={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},i={onHoverOverNode:function(e,t){var r=s.getSetting(e.data.treeId),n=s.getRoot(r);n.curHoverNode!=t&&i.onHoverOutNode(e),n.curHoverNode=t,a.addHoverDom(r,t)},onHoverOutNode:function(e){var e=s.getSetting(e.data.treeId),t=s.getRoot(e);t.curHoverNode&&!s.isSelectedNode(e,t.curHoverNode)&&(a.removeTreeDom(e,t.curHoverNode),t.curHoverNode=null)},onMousedownNode:function(i,r){function c(i){if(0==f.dragFlag&&Math.abs(O-i.clientX)<g.edit.drag.minMoveSize&&Math.abs(R-i.clientY)<g.edit.drag.minMoveSize)return!0;var r,c,h,u,p;if(p=g.data.key.children,P.css("cursor","pointer"),0==f.dragFlag){if(0==n.apply(g.callback.beforeDrag,[g.treeId,k],!0))return d(i),!0;for(r=0,c=k.length;c>r;r++)0==r&&(f.dragNodeShowBefore=[]),h=k[r],h.isParent&&h.open?(a.expandCollapseNode(g,h,!h.open),f.dragNodeShowBefore[h.tId]=!0):f.dragNodeShowBefore[h.tId]=!1;if(f.dragFlag=1,m.showHoverDom=!1,n.showIfameMask(g,!0),h=!0,u=-1,k.length>1){var v=k[0].parentTId?k[0].getParentNode()[p]:s.getNodes(g);for(p=[],r=0,c=v.length;c>r;r++)if(void 0!==f.dragNodeShowBefore[v[r].tId]&&(h&&u>-1&&u+1!==r&&(h=!1),p.push(v[r]),u=r),k.length===p.length){k=p;break}}for(h&&(S=k[0].getPreNode(),T=k[k.length-1].getNextNode()),b=l("<ul class='zTreeDragUL'></ul>",g),r=0,c=k.length;c>r;r++)h=k[r],h.editNameFlag=!1,a.selectNode(g,h,r>0),a.removeTreeDom(g,h),r>g.edit.drag.maxShowNodeNum-1||(u=l("<li id='"+h.tId+"_tmp'></li>",g),u.append(l(h,o.id.A,g).clone()),u.css("padding","0"),u.children("#"+h.tId+o.id.A).removeClass(o.node.CURSELECTED),b.append(u),r==g.edit.drag.maxShowNodeNum-1&&(u=l("<li id='"+h.tId+"_moretmp'><a>  ...  </a></li>",g),b.append(u)));b.attr("id",k[0].tId+o.id.UL+"_tmp"),b.addClass(g.treeObj.attr("class")),b.appendTo(P),C=l("<span class='tmpzTreeMove_arrow'></span>",g),C.attr("id","zTreeMove_arrow_tmp"),C.appendTo(P),g.treeObj.trigger(o.event.DRAG,[i,g.treeId,k])}if(1==f.dragFlag){x&&C.attr("id")==i.target.id&&E&&i.clientX+w.scrollLeft()+2>e("#"+E+o.id.A,x).offset().left?(h=e("#"+E+o.id.A,x),i.target=h.length>0?h.get(0):i.target):x&&(x.removeClass(o.node.TMPTARGET_TREE),E&&e("#"+E+o.id.A,x).removeClass(o.node.TMPTARGET_NODE+"_"+o.move.TYPE_PREV).removeClass(o.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(o.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER)),E=x=null,N=!1,L=g,h=s.getSettings();for(var y in h)h[y].treeId&&h[y].edit.enable&&h[y].treeId!=g.treeId&&(i.target.id==h[y].treeId||e(i.target).parents("#"+h[y].treeId).length>0)&&(N=!0,L=h[y]);y=w.scrollTop(),u=w.scrollLeft(),p=L.treeObj.offset(),r=L.treeObj.get(0).scrollHeight,h=L.treeObj.get(0).scrollWidth,c=i.clientY+y-p.top;var I=L.treeObj.height()+p.top-i.clientY-y,j=i.clientX+u-p.left,z=L.treeObj.width()+p.left-i.clientX-u;p=c<g.edit.drag.borderMax&&c>g.edit.drag.borderMin;var v=I<g.edit.drag.borderMax&&I>g.edit.drag.borderMin,F=j<g.edit.drag.borderMax&&j>g.edit.drag.borderMin,$=z<g.edit.drag.borderMax&&z>g.edit.drag.borderMin,I=c>g.edit.drag.borderMin&&I>g.edit.drag.borderMin&&j>g.edit.drag.borderMin&&z>g.edit.drag.borderMin,j=p&&L.treeObj.scrollTop()<=0,z=v&&L.treeObj.scrollTop()+L.treeObj.height()+10>=r,H=F&&L.treeObj.scrollLeft()<=0,B=$&&L.treeObj.scrollLeft()+L.treeObj.width()+10>=h;if(i.target&&n.isChildOrSelf(i.target,L.treeId)){for(var U=i.target;U&&U.tagName&&!n.eqs(U.tagName,"li")&&U.id!=L.treeId;)U=U.parentNode;var G=!0;for(r=0,c=k.length;c>r;r++){if(h=k[r],U.id===h.tId){G=!1;break}if(l(h,g).find("#"+U.id).length>0){G=!1;break}}G&&i.target&&n.isChildOrSelf(i.target,U.id+o.id.A)&&(x=e(U),E=U.id)}if(h=k[0],I&&n.isChildOrSelf(i.target,L.treeId)&&(!x&&(i.target.id==L.treeId||j||z||H||B)&&(N||!N&&h.parentTId)&&(x=L.treeObj),p?L.treeObj.scrollTop(L.treeObj.scrollTop()-10):v&&L.treeObj.scrollTop(L.treeObj.scrollTop()+10),F?L.treeObj.scrollLeft(L.treeObj.scrollLeft()-10):$&&L.treeObj.scrollLeft(L.treeObj.scrollLeft()+10),x&&x!=L.treeObj&&x.offset().left<L.treeObj.offset().left&&L.treeObj.scrollLeft(L.treeObj.scrollLeft()+x.offset().left-L.treeObj.offset().left)),b.css({top:i.clientY+y+3+"px",left:i.clientX+u+3+"px"}),c=r=0,x&&x.attr("id")!=L.treeId){var Y=null==E?null:s.getNodeCache(L,E);p=(i.ctrlKey||i.metaKey)&&g.edit.drag.isMove&&g.edit.drag.isCopy||!g.edit.drag.isMove&&g.edit.drag.isCopy,u=!(!S||E!==S.tId),F=!(!T||E!==T.tId),v=h.parentTId&&h.parentTId==E,h=(p||!F)&&n.apply(L.edit.drag.prev,[L.treeId,k,Y],!!L.edit.drag.prev),u=(p||!u)&&n.apply(L.edit.drag.next,[L.treeId,k,Y],!!L.edit.drag.next),p=(p||!v)&&!(L.data.keep.leaf&&!Y.isParent)&&n.apply(L.edit.drag.inner,[L.treeId,k,Y],!!L.edit.drag.inner),v=function(){x=null,E="",D=o.move.TYPE_INNER,C.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)},h||u||p?(F=e("#"+E+o.id.A,x),$=Y.isLastNode?null:e("#"+Y.getNextNode().tId+o.id.A,x.next()),I=F.offset().top,j=F.offset().left,z=h?p?.25:u?.5:1:-1,H=u?p?.75:h?.5:0:-1,y=(i.clientY+y-I)/F.height(),(1==z||z>=y&&y>=-.2)&&h?(r=1-C.width(),c=I-C.height()/2,D=o.move.TYPE_PREV):(0==H||y>=H&&1.2>=y)&&u?(r=1-C.width(),c=null==$||Y.isParent&&Y.open?I+F.height()-C.height()/2:$.offset().top-C.height()/2,D=o.move.TYPE_NEXT):p?(r=5-C.width(),c=I,D=o.move.TYPE_INNER):v(),x&&(C.css({display:"block",top:c+"px",left:j+r+"px"}),F.addClass(o.node.TMPTARGET_NODE+"_"+D),A==E&&M==D||(_=(new Date).getTime()),Y&&Y.isParent&&D==o.move.TYPE_INNER&&(y=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==Y.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===Y.tId&&(y=!1),y)&&(window.zTreeMoveTimer=setTimeout(function(){D==o.move.TYPE_INNER&&Y&&Y.isParent&&!Y.open&&(new Date).getTime()-_>L.edit.drag.autoOpenTime&&n.apply(L.callback.beforeDragOpen,[L.treeId,Y],!0)&&(a.switchNode(L,Y),L.edit.drag.autoExpandTrigger&&L.treeObj.trigger(o.event.EXPAND,[L.treeId,Y]))},L.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=Y.tId))):v()}else D=o.move.TYPE_INNER,x&&n.apply(L.edit.drag.inner,[L.treeId,k,null],!!L.edit.drag.inner)?x.addClass(o.node.TMPTARGET_TREE):x=null,C.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);A=E,M=D,g.treeObj.trigger(o.event.DRAGMOVE,[i,g.treeId,k])}return!1}function d(i){if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),M=A=null,w.unbind("mousemove",c),w.unbind("mouseup",d),w.unbind("selectstart",h),P.css("cursor","auto"),x&&(x.removeClass(o.node.TMPTARGET_TREE),E&&e("#"+E+o.id.A,x).removeClass(o.node.TMPTARGET_NODE+"_"+o.move.TYPE_PREV).removeClass(o.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(o.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER)),n.showIfameMask(g,!1),m.showHoverDom=!0,0!=f.dragFlag){f.dragFlag=0;var r,u,p;for(r=0,u=k.length;u>r;r++)p=k[r],p.isParent&&f.dragNodeShowBefore[p.tId]&&!p.open&&(a.expandCollapseNode(g,p,!p.open),delete f.dragNodeShowBefore[p.tId]);b&&b.remove(),C&&C.remove();var v=(i.ctrlKey||i.metaKey)&&g.edit.drag.isMove&&g.edit.drag.isCopy||!g.edit.drag.isMove&&g.edit.drag.isCopy;if(!v&&x&&E&&k[0].parentTId&&E==k[0].parentTId&&D==o.move.TYPE_INNER&&(x=null),x){var y=null==E?null:s.getNodeCache(L,E);if(0==n.apply(g.callback.beforeDrop,[L.treeId,k,y,D,v],!0))a.selectNodes(I,k);else{var S=v?n.clone(k):k;r=function(){if(N){if(!v)for(var e=0,t=k.length;t>e;e++)a.removeNode(g,k[e]);D==o.move.TYPE_INNER?a.addNodes(L,y,-1,S):a.addNodes(L,y.getParentNode(),D==o.move.TYPE_PREV?y.getIndex():y.getIndex()+1,S)}else if(v&&D==o.move.TYPE_INNER)a.addNodes(L,y,-1,S);else if(v)a.addNodes(L,y.getParentNode(),D==o.move.TYPE_PREV?y.getIndex():y.getIndex()+1,S);else if(D!=o.move.TYPE_NEXT)for(e=0,t=S.length;t>e;e++)a.moveNode(L,y,S[e],D,!1);else for(e=-1,t=S.length-1;t>e;t--)a.moveNode(L,y,S[t],D,!1);a.selectNodes(L,S),e=l(S[0],g).get(0),a.scrollIntoView(e),g.treeObj.trigger(o.event.DROP,[i,L.treeId,S,y,D,v])},D==o.move.TYPE_INNER&&n.canAsync(L,y)?a.asyncNode(L,y,!1,r):r()}}else a.selectNodes(I,k),g.treeObj.trigger(o.event.DROP,[i,g.treeId,k,null,null,null])}}function h(){return!1}var u,p,g=s.getSetting(i.data.treeId),f=s.getRoot(g),m=s.getRoots();if(2==i.button||!g.edit.enable||!g.edit.drag.isCopy&&!g.edit.drag.isMove)return!0;var v=i.target,y=s.getRoot(g).curSelectedList,k=[];if(s.isSelectedNode(g,r))for(u=0,p=y.length;p>u;u++){if(y[u].editNameFlag&&n.eqs(v.tagName,"input")&&null!==v.getAttribute("treeNode"+o.id.INPUT))return!0;if(k.push(y[u]),k[0].parentTId!==y[u].parentTId){k=[r];break}}else k=[r];a.editNodeBlur=!0,a.cancelCurEditNode(g);var b,C,x,S,T,w=e(g.treeObj.get(0).ownerDocument),P=e(g.treeObj.get(0).ownerDocument.body),N=!1,L=g,I=g,A=null,M=null,E=null,D=o.move.TYPE_INNER,O=i.clientX,R=i.clientY,_=(new Date).getTime();return n.uCanDo(g)&&w.bind("mousemove",c),w.bind("mouseup",d),w.bind("selectstart",h),i.preventDefault&&i.preventDefault(),!0}};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,{tools:{getAbs:function(e){return e=e.getBoundingClientRect(),[e.left+(document.body.scrollLeft+document.documentElement.scrollLeft),e.top+(document.body.scrollTop+document.documentElement.scrollTop)]},inputFocus:function(e){e.get(0)&&(e.focus(),n.setCursorPosition(e.get(0),e.val().length))},inputSelect:function(e){e.get(0)&&(e.focus(),e.select())},setCursorPosition:function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}},showIfameMask:function(e,t){for(var i=s.getRoot(e);i.dragMaskList.length>0;)i.dragMaskList[0].remove(),i.dragMaskList.shift();if(t)for(var r=l("iframe",e),o=0,a=r.length;a>o;o++){var c=r.get(o),d=n.getAbs(c),c=l("<div id='zTreeMask_"+o+"' class='zTreeMask' style='top:"+d[1]+"px; left:"+d[0]+"px; width:"+c.offsetWidth+"px; height:"+c.offsetHeight+"px;'></div>",e);c.appendTo(l("body",e)),i.dragMaskList.push(c)}}},view:{addEditBtn:function(e,t){if(!(t.editNameFlag||l(t,o.id.EDIT,e).length>0)&&n.apply(e.edit.showRenameBtn,[e.treeId,t],e.edit.showRenameBtn)){var i=l(t,o.id.A,e),r="<span class='"+o.className.BUTTON+" edit' id='"+t.tId+o.id.EDIT+"' title='"+n.apply(e.edit.renameTitle,[e.treeId,t],e.edit.renameTitle)+"' treeNode"+o.id.EDIT+" style='display:none;'></span>";i.append(r),l(t,o.id.EDIT,e).bind("click",function(){return n.uCanDo(e)&&0!=n.apply(e.callback.beforeEditName,[e.treeId,t],!0)?(a.editNode(e,t),!1):!1}).show()}},addRemoveBtn:function(e,t){if(!(t.editNameFlag||l(t,o.id.REMOVE,e).length>0)&&n.apply(e.edit.showRemoveBtn,[e.treeId,t],e.edit.showRemoveBtn)){var i=l(t,o.id.A,e),r="<span class='"+o.className.BUTTON+" remove' id='"+t.tId+o.id.REMOVE+"' title='"+n.apply(e.edit.removeTitle,[e.treeId,t],e.edit.removeTitle)+"' treeNode"+o.id.REMOVE+" style='display:none;'></span>";i.append(r),l(t,o.id.REMOVE,e).bind("click",function(){return n.uCanDo(e)&&0!=n.apply(e.callback.beforeRemove,[e.treeId,t],!0)?(a.removeNode(e,t),e.treeObj.trigger(o.event.REMOVE,[e.treeId,t]),!1):!1}).bind("mousedown",function(){return!0}).show()}},addHoverDom:function(e,t){s.getRoots().showHoverDom&&(t.isHover=!0,e.edit.enable&&(a.addEditBtn(e,t),a.addRemoveBtn(e,t)),n.apply(e.view.addHoverDom,[e.treeId,t]))},cancelCurEditNode:function(e,t,i){var r=s.getRoot(e),c=e.data.key.name,d=r.curEditNode;if(d){var h=r.curEditInput,t=t?t:i?d[c]:h.val();if(n.apply(e.callback.beforeRename,[e.treeId,d,t,i],!0)===!1)return!1;d[c]=t,l(d,o.id.A,e).removeClass(o.node.CURSELECTED_EDIT),h.unbind(),a.setNodeName(e,d),d.editNameFlag=!1,r.curEditNode=null,r.curEditInput=null,a.selectNode(e,d,!1),e.treeObj.trigger(o.event.RENAME,[e.treeId,d,i])}return r.noSelection=!0},editNode:function(e,t){var i=s.getRoot(e);if(a.editNodeBlur=!1,s.isSelectedNode(e,t)&&i.curEditNode==t&&t.editNameFlag)setTimeout(function(){n.inputFocus(i.curEditInput)},0);else{var r=e.data.key.name;t.editNameFlag=!0,a.removeTreeDom(e,t),a.cancelCurEditNode(e),a.selectNode(e,t,!1),l(t,o.id.SPAN,e).html("<input type=text class='rename' id='"+t.tId+o.id.INPUT+"' treeNode"+o.id.INPUT+" >");var c=l(t,o.id.INPUT,e);c.attr("value",t[r]),e.edit.editNameSelectAll?n.inputSelect(c):n.inputFocus(c),c.bind("blur",function(){a.editNodeBlur||a.cancelCurEditNode(e)}).bind("keydown",function(t){"13"==t.keyCode?(a.editNodeBlur=!0,a.cancelCurEditNode(e)):"27"==t.keyCode&&a.cancelCurEditNode(e,null,!0)}).bind("click",function(){return!1}).bind("dblclick",function(){return!1}),l(t,o.id.A,e).addClass(o.node.CURSELECTED_EDIT),i.curEditInput=c,i.noSelection=!1,i.curEditNode=t}},moveNode:function(e,t,i,r,n,c){var d=s.getRoot(e),h=e.data.key.children;if(t!=i&&(!e.data.keep.leaf||!t||t.isParent||r!=o.move.TYPE_INNER)){var u=i.parentTId?i.getParentNode():d,p=null===t||t==d;p&&null===t&&(t=d),p&&(r=o.move.TYPE_INNER),d=t.parentTId?t.getParentNode():d,r!=o.move.TYPE_PREV&&r!=o.move.TYPE_NEXT&&(r=o.move.TYPE_INNER),r==o.move.TYPE_INNER&&(p?i.parentTId=null:(t.isParent||(t.isParent=!0,t.open=!!t.open,a.setNodeLineIcos(e,t)),i.parentTId=t.tId));var g;p?g=p=e.treeObj:(c||r!=o.move.TYPE_INNER?c||a.expandCollapseNode(e,t.getParentNode(),!0,!1):a.expandCollapseNode(e,t,!0,!1),p=l(t,e),g=l(t,o.id.UL,e),p.get(0)&&!g.get(0)&&(g=[],a.makeUlHtml(e,t,g,""),p.append(g.join(""))),g=l(t,o.id.UL,e));var f=l(i,e);f.get(0)?p.get(0)||f.remove():f=a.appendNodes(e,i.level,[i],null,-1,!1,!0).join(""),g.get(0)&&r==o.move.TYPE_INNER?g.append(f):p.get(0)&&r==o.move.TYPE_PREV?p.before(f):p.get(0)&&r==o.move.TYPE_NEXT&&p.after(f);var m=-1,v=0,y=null,p=null,k=i.level;if(i.isFirstNode)m=0,u[h].length>1&&(y=u[h][1],y.isFirstNode=!0);else if(i.isLastNode)m=u[h].length-1,y=u[h][m-1],y.isLastNode=!0;else for(g=0,f=u[h].length;f>g;g++)if(u[h][g].tId==i.tId){m=g;break}if(m>=0&&u[h].splice(m,1),r!=o.move.TYPE_INNER)for(g=0,f=d[h].length;f>g;g++)d[h][g].tId==t.tId&&(v=g);r==o.move.TYPE_INNER?(t[h]||(t[h]=[]),t[h].length>0&&(p=t[h][t[h].length-1],p.isLastNode=!1),t[h].splice(t[h].length,0,i),i.isLastNode=!0,i.isFirstNode=1==t[h].length):t.isFirstNode&&r==o.move.TYPE_PREV?(d[h].splice(v,0,i),p=t,p.isFirstNode=!1,i.parentTId=t.parentTId,i.isFirstNode=!0,i.isLastNode=!1):t.isLastNode&&r==o.move.TYPE_NEXT?(d[h].splice(v+1,0,i),p=t,p.isLastNode=!1,i.parentTId=t.parentTId,i.isFirstNode=!1,i.isLastNode=!0):(r==o.move.TYPE_PREV?d[h].splice(v,0,i):d[h].splice(v+1,0,i),i.parentTId=t.parentTId,i.isFirstNode=!1,i.isLastNode=!1),s.fixPIdKeyValue(e,i),s.setSonNodeLevel(e,i.getParentNode(),i),a.setNodeLineIcos(e,i),a.repairNodeLevelClass(e,i,k),!e.data.keep.parent&&u[h].length<1?(u.isParent=!1,u.open=!1,t=l(u,o.id.UL,e),r=l(u,o.id.SWITCH,e),h=l(u,o.id.ICON,e),a.replaceSwitchClass(u,r,o.folder.DOCU),a.replaceIcoClass(u,h,o.folder.DOCU),t.css("display","none")):y&&a.setNodeLineIcos(e,y),p&&a.setNodeLineIcos(e,p),e.check&&e.check.enable&&a.repairChkClass&&(a.repairChkClass(e,u),a.repairParentChkClassWithSelf(e,u),u!=i.parent&&a.repairParentChkClassWithSelf(e,i)),c||a.expandCollapseParentNode(e,i.getParentNode(),!0,n)}},removeEditBtn:function(e,t){l(t,o.id.EDIT,e).unbind().remove()},removeRemoveBtn:function(e,t){l(t,o.id.REMOVE,e).unbind().remove()},removeTreeDom:function(e,t){t.isHover=!1,a.removeEditBtn(e,t),a.removeRemoveBtn(e,t),n.apply(e.view.removeHoverDom,[e.treeId,t])},repairNodeLevelClass:function(e,t,i){if(i!==t.level){var r=l(t,e),n=l(t,o.id.A,e),e=l(t,o.id.UL,e),i=o.className.LEVEL+i,t=o.className.LEVEL+t.level;r.removeClass(i),r.addClass(t),n.removeClass(i),n.addClass(t),e.removeClass(i),e.addClass(t)}},selectNodes:function(e,t){for(var i=0,r=t.length;r>i;i++)a.selectNode(e,t[i],i>0)}},event:{},data:{setSonNodeLevel:function(e,t,i){if(i){var r=e.data.key.children;if(i.level=t?t.level+1:0,i[r])for(var t=0,n=i[r].length;n>t;t++)i[r][t]&&s.setSonNodeLevel(e,i,i[r][t])}}}});var r=e.fn.zTree,n=r._z.tools,o=r.consts,a=r._z.view,s=r._z.data,l=n.$;s.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}}),s.addInitBind(function(e){var t=e.treeObj,i=o.event;t.bind(i.RENAME,function(t,i,r,o){n.apply(e.callback.onRename,[t,i,r,o])}),t.bind(i.DRAG,function(t,i,r,o){n.apply(e.callback.onDrag,[i,r,o])}),t.bind(i.DRAGMOVE,function(t,i,r,o){n.apply(e.callback.onDragMove,[i,r,o])}),t.bind(i.DROP,function(t,i,r,o,a,s,l){n.apply(e.callback.onDrop,[i,r,o,a,s,l])})}),s.addInitUnBind(function(e){var e=e.treeObj,t=o.event;e.unbind(t.RENAME),e.unbind(t.DRAG),e.unbind(t.DRAGMOVE),e.unbind(t.DROP)}),s.addInitCache(function(){}),s.addInitNode(function(e,t,i){i&&(i.isHover=!1,i.editNameFlag=!1)}),s.addInitProxy(function(e){var t=e.target,r=s.getSetting(e.data.treeId),a=e.relatedTarget,l="",c=null,d="",h=null,u=null;if(n.eqs(e.type,"mouseover")?(u=n.getMDom(r,t,[{tagName:"a",attrName:"treeNode"+o.id.A}]))&&(l=n.getNodeMainDom(u).id,d="hoverOverNode"):n.eqs(e.type,"mouseout")?(u=n.getMDom(r,a,[{tagName:"a",attrName:"treeNode"+o.id.A}]),u||(l="remove",d="hoverOutNode")):n.eqs(e.type,"mousedown")&&(u=n.getMDom(r,t,[{tagName:"a",attrName:"treeNode"+o.id.A}]))&&(l=n.getNodeMainDom(u).id,d="mousedownNode"),l.length>0)switch(c=s.getNodeCache(r,l),d){case"mousedownNode":h=i.onMousedownNode;break;case"hoverOverNode":h=i.onHoverOverNode;break;case"hoverOutNode":h=i.onHoverOutNode}return{stop:!1,node:c,nodeEventType:d,nodeEventCallback:h,treeEventType:"",treeEventCallback:null}}),s.addInitRoot(function(e){var e=s.getRoot(e),t=s.getRoots();e.curEditNode=null,e.curEditInput=null,e.curHoverNode=null,e.dragFlag=0,e.dragNodeShowBefore=[],e.dragMaskList=[],t.showHoverDom=!0}),s.addZTreeTools(function(e,t){t.cancelEditName=function(e){s.getRoot(this.setting).curEditNode&&a.cancelCurEditNode(this.setting,e?e:null,!0)},t.copyNode=function(e,t,i,r){if(!t)return null;if(e&&!e.isParent&&this.setting.data.keep.leaf&&i===o.move.TYPE_INNER)return null;var s=this,l=n.clone(t);return e||(e=null,i=o.move.TYPE_INNER),i==o.move.TYPE_INNER?(t=function(){a.addNodes(s.setting,e,-1,[l],r)},n.canAsync(this.setting,e)?a.asyncNode(this.setting,e,r,t):t()):(a.addNodes(this.setting,e.parentNode,-1,[l],r),a.moveNode(this.setting,e,l,i,!1,r)),l},t.editName=function(e){e&&e.tId&&e===s.getNodeCache(this.setting,e.tId)&&(e.parentTId&&a.expandCollapseParentNode(this.setting,e.getParentNode(),!0),a.editNode(this.setting,e))},t.moveNode=function(e,t,i,r){function s(){a.moveNode(c.setting,e,t,i,!1,r)}if(!t)return t;if(e&&!e.isParent&&this.setting.data.keep.leaf&&i===o.move.TYPE_INNER)return null;if(e&&(t.parentTId==e.tId&&i==o.move.TYPE_INNER||l(t,this.setting).find("#"+e.tId).length>0))return null;e||(e=null);var c=this;return n.canAsync(this.setting,e)&&i===o.move.TYPE_INNER?a.asyncNode(this.setting,e,r,s):s(),t},t.setEditable=function(e){
return this.setting.edit.enable=e,this.refresh()}});var c=a.cancelPreSelectedNode;a.cancelPreSelectedNode=function(e,t){for(var i=s.getRoot(e).curSelectedList,r=0,n=i.length;n>r&&(t&&t!==i[r]||(a.removeTreeDom(e,i[r]),!t));r++);c&&c.apply(a,arguments)};var d=a.createNodes;a.createNodes=function(e,t,i,r,n){d&&d.apply(a,arguments),i&&a.repairParentChkClassWithSelf&&a.repairParentChkClassWithSelf(e,r)};var h=a.makeNodeUrl;a.makeNodeUrl=function(e,t){return e.edit.enable?null:h.apply(a,arguments)};var u=a.removeNode;a.removeNode=function(e,t){var i=s.getRoot(e);i.curEditNode===t&&(i.curEditNode=null),u&&u.apply(a,arguments)};var p=a.selectNode;a.selectNode=function(e,t,i){var r=s.getRoot(e);return s.isSelectedNode(e,t)&&r.curEditNode==t&&t.editNameFlag?!1:(p&&p.apply(a,arguments),a.addHoverDom(e,t),!0)};var g=n.uCanDo;n.uCanDo=function(e,t){var i=s.getRoot(e);return t&&(n.eqs(t.type,"mouseover")||n.eqs(t.type,"mouseout")||n.eqs(t.type,"mousedown")||n.eqs(t.type,"mouseup"))?!0:(i.curEditNode&&(a.editNodeBlur=!1,i.curEditInput.focus()),!i.curEditNode&&(g?g.apply(a,arguments):!0))}}(jQuery),angular.module("angular-json-editor",[]).provider("JSONEditor",function(){function e(t){return angular.forEach(arguments,function(i){i!==t&&angular.forEach(i,function(i,r){t[r]&&t[r].constructor&&t[r].constructor===Object?e(t[r],i):t[r]=i})}),t}var t={defaults:{options:{iconlib:"bootstrap3",theme:"bootstrap3"}}};this.configure=function(i){e(t,i)},this.$get=["$window",function(i){var r=i.JSONEditor;return e(r,t),i.JSONEditor}]}).directive("jsonEditor",["$q","JSONEditor",function(e,t){return{restrict:"E",transclude:!0,scope:{schema:"=",startval:"=",isValid:"=",jsonValue:"=",buttonsController:"@",onChange:"&"},controller:["$scope","$attrs","$controller",function(e,t,i){var r,n,o=t.buttonsController;if(angular.isString(o)&&""!==o){n={$scope:e};try{r=i(o,n)}catch(a){throw new Error("angular-json-editor: buttons-controller attribute must be a valid controller.")}}}],link:function(i,r,n,o,a){var s=e.when({}),l=e.when(null);if(i.isValid=!1,!angular.isString(n.schema))throw new Error("angular-json-editor: schema attribute has to be defined.");angular.isObject(i.schema)&&(l=e.when(i.schema)),angular.isObject(i.startval)&&(s=e.when(i.startval)),e.all([l,s]).then(function(e){function n(){var e=s;i.editor&&i.editor.destroy&&(e=i.editor.getValue(),i.editor.destroy()),i.editor=new t(r[0],{startval:e,schema:o},!0),i.editor.on("ready",function(){r.find("h3").append("<i>&#9888</i>"),r.find("h3").find("i").bind("click",function(){angular.element(this).parent("h3").siblings("p").toggle()}),$("<i>&#9888</i>").insertAfter(r.find(".control-label")),r.find(".form-group").find("i").bind("click",function(){angular.element(this).siblings(".help-block").first().toggle()})}),i.editor.on("change",function(){i.isValid=0===i.editor.validate().length,i.jsonValue=i.editor.getValue()}),r.append(l),i.jsonValue=i.editor.getValue()}var o=e[0].data||e[0],s=e[1].data||e[1];if(null===o)throw new Error("angular-json-editor: could not resolve schema data.");n(s,o),i.$watch("schema",function(e,t){e.success?e.success(function(e){o=e}):o=e,n()},!0);var l=a(i,function(e){return e});r.append(l)})}}}]),!function(e){function t(t,i){if(i=i||{},i.worker&&T.WORKERS_SUPPORTED){var r=d();return r.userStep=i.step,r.userChunk=i.chunk,r.userComplete=i.complete,r.userError=i.error,i.step=v(i.step),i.chunk=v(i.chunk),i.complete=v(i.complete),i.error=v(i.error),delete i.worker,void r.postMessage({input:t,config:i,workerId:r.id})}var s=null;return"string"==typeof t?s=i.download?new n(i):new a(i):(e.File&&t instanceof File||t instanceof Object)&&(s=new o(i)),s.stream(t)}function i(e,t){function i(){"object"==typeof t&&("string"==typeof t.delimiter&&1==t.delimiter.length&&-1==T.BAD_DELIMITERS.indexOf(t.delimiter)&&(l=t.delimiter),("boolean"==typeof t.quotes||t.quotes instanceof Array)&&(s=t.quotes),"string"==typeof t.newline&&(c=t.newline))}function r(e){if("object"!=typeof e)return[];var t=[];for(var i in e)t.push(i);return t}function n(e,t){var i="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var r=e instanceof Array&&e.length>0,n=!(t[0]instanceof Array);if(r){for(var a=0;a<e.length;a++)a>0&&(i+=l),i+=o(e[a],a);t.length>0&&(i+=c)}for(var s=0;s<t.length;s++){for(var d=r?e.length:t[s].length,h=0;d>h;h++){h>0&&(i+=l);var u=r&&n?e[h]:h;i+=o(t[s][u],h)}s<t.length-1&&(i+=c)}return i}function o(e,t){if("undefined"==typeof e||null===e)return"";e=e.toString().replace(/"/g,'""');var i="boolean"==typeof s&&s||s instanceof Array&&s[t]||a(e,T.BAD_DELIMITERS)||e.indexOf(l)>-1||" "==e.charAt(0)||" "==e.charAt(e.length-1);return i?'"'+e+'"':e}function a(e,t){for(var i=0;i<t.length;i++)if(e.indexOf(t[i])>-1)return!0;return!1}var s=!1,l=",",c="\r\n";if(i(),"string"==typeof e&&(e=JSON.parse(e)),e instanceof Array){if(!e.length||e[0]instanceof Array)return n(null,e);if("object"==typeof e[0])return n(r(e[0]),e)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),e.data instanceof Array&&(e.fields||(e.fields=e.data[0]instanceof Array?e.fields:r(e.data[0])),e.data[0]instanceof Array||"object"==typeof e.data[0]||(e.data=[e.data])),n(e.fields||[],e.data||[]);throw"exception: Unable to serialize unrecognized input"}function r(t){function i(e){var t=f(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new s(t),this._handle.streamer=this,this._config=t}this._handle=null,this._paused=!1,this._finished=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},i.call(this,t),this.parseChunk=function(t){if(this.isFirstChunk&&v(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(t);void 0!==i&&(t=i)}this.isFirstChunk=!1;var r=this._partialLine+t;this._partialLine="";var n=this._handle.parse(r,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var o=n.meta.cursor;this._finished||(this._partialLine=r.substring(o-this._baseIndex),this._baseIndex=o),n&&n.data&&(this._rowCount+=n.data.length);var a=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(b)e.postMessage({results:n,workerId:T.WORKER_ID,finished:a});else if(v(this._config.chunk)){if(this._config.chunk(n,this._handle),this._paused)return;n=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(n.data),this._completeResults.errors=this._completeResults.errors.concat(n.errors),this._completeResults.meta=n.meta),!a||!v(this._config.complete)||n&&n.meta.aborted||this._config.complete(this._completeResults),a||n&&n.meta.paused||this._nextChunk(),n}},this._sendError=function(t){v(this._config.error)?this._config.error(t):b&&this._config.error&&e.postMessage({workerId:T.WORKER_ID,error:t,finished:!1})}}function n(e){function t(e){var t=e.getResponseHeader("Content-Range");return parseInt(t.substr(t.lastIndexOf("/")+1))}e=e||{},e.chunkSize||(e.chunkSize=T.RemoteChunkSize),r.call(this,e);var i;this._nextChunk=k?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)return void this._chunkLoaded();if(i=new XMLHttpRequest,k||(i.onload=m(this._chunkLoaded,this),i.onerror=m(this._chunkError,this)),i.open("GET",this._input,!k),this._config.chunkSize){var e=this._start+this._config.chunkSize-1;i.setRequestHeader("Range","bytes="+this._start+"-"+e),i.setRequestHeader("If-None-Match","webkit-no-cache")}try{i.send()}catch(t){this._chunkError(t.message)}k&&0==i.status?this._chunkError():this._start+=this._config.chunkSize},this._chunkLoaded=function(){if(4==i.readyState){if(i.status<200||i.status>=400)return void this._chunkError();this._finished=!this._config.chunkSize||this._start>t(i),this.parseChunk(i.responseText)}},this._chunkError=function(e){var t=i.statusText||e;this._sendError(t)}}function o(e){e=e||{},e.chunkSize||(e.chunkSize=T.LocalChunkSize),r.call(this,e);var t,i,n="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,i=e.slice||e.webkitSlice||e.mozSlice,n?(t=new FileReader,t.onload=m(this._chunkLoaded,this),t.onerror=m(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var r=Math.min(this._start+this._config.chunkSize,this._input.size);e=i.call(e,this._start,r)}var o=t.readAsText(e,this._config.encoding);n||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function a(e){e=e||{},r.call(this,e);var t,i;this.stream=function(e){return t=e,i=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e=this._config.chunkSize,t=e?i.substr(0,e):i;return i=e?i.substr(e):"",this._finished=!i,this.parseChunk(t)}}}function s(e){function t(){if(C&&u&&(c("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+T.DefaultDelimiter+"'"),u=!1),e.skipEmptyLines)for(var t=0;t<C.data.length;t++)1==C.data[t].length&&""==C.data[t][0]&&C.data.splice(t--,1);return i()&&r(),n()}function i(){return e.header&&0==b.length}function r(){if(C){for(var e=0;i()&&e<C.data.length;e++)for(var t=0;t<C.data[e].length;t++)b.push(C.data[e][t]);C.data.splice(0,1)}}function n(){if(!C||!e.header&&!e.dynamicTyping)return C;for(var t=0;t<C.data.length;t++){for(var i={},r=0;r<C.data[t].length;r++){if(e.dynamicTyping){var n=C.data[t][r];C.data[t][r]="true"==n||"TRUE"==n?!0:"false"==n||"FALSE"==n?!1:s(n)}e.header&&(r>=b.length?(i.__parsed_extra||(i.__parsed_extra=[]),i.__parsed_extra.push(C.data[t][r])):i[b[r]]=C.data[t][r])}e.header&&(C.data[t]=i,r>b.length?c("FieldMismatch","TooManyFields","Too many fields: expected "+b.length+" fields but parsed "+r,t):r<b.length&&c("FieldMismatch","TooFewFields","Too few fields: expected "+b.length+" fields but parsed "+r,t))}return e.header&&C.meta&&(C.meta.fields=b),C}function o(t){for(var i,r,n,o=[",","	","|",";",T.RECORD_SEP,T.UNIT_SEP],a=0;a<o.length;a++){var s=o[a],c=0,d=0;n=void 0;for(var h=new l({delimiter:s,preview:10}).parse(t),u=0;u<h.data.length;u++){var p=h.data[u].length;d+=p,"undefined"!=typeof n?p>1&&(c+=Math.abs(p-n),n=p):n=p}h.data.length>0&&(d/=h.data.length),("undefined"==typeof r||r>c)&&d>1.99&&(r=c,i=s)}return e.delimiter=i,{successful:!!i,bestDelimiter:i}}function a(e){e=e.substr(0,1048576);var t=e.split("\r");if(1==t.length)return"\n";for(var i=0,r=0;r<t.length;r++)"\n"==t[r][0]&&i++;return i>=t.length/2?"\r\n":"\r"}function s(e){var t=p.test(e);return t?parseFloat(e):e}function c(e,t,i,r){C.errors.push({type:e,code:t,message:i,row:r})}var d,h,u,p=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,g=this,m=0,y=!1,k=!1,b=[],C={data:[],errors:[],meta:{}};if(v(e.step)){var x=e.step;e.step=function(r){if(C=r,i())t();else{if(t(),0==C.data.length)return;m+=r.data.length,e.preview&&m>e.preview?h.abort():x(C,g)}}}this.parse=function(i,r,n){if(e.newline||(e.newline=a(i)),u=!1,!e.delimiter){var s=o(i);s.successful?e.delimiter=s.bestDelimiter:(u=!0,e.delimiter=T.DefaultDelimiter),C.meta.delimiter=e.delimiter}var c=f(e);return e.preview&&e.header&&c.preview++,d=i,h=new l(c),C=h.parse(d,r,n),t(),y?{meta:{paused:!0}}:C||{meta:{paused:!1}}},this.paused=function(){return y},this.pause=function(){y=!0,h.abort(),d=d.substr(h.getCharIndex())},this.resume=function(){y=!1,g.streamer.parseChunk(d)},this.aborted=function(){return k},this.abort=function(){k=!0,h.abort(),C.meta.aborted=!0,v(e.complete)&&e.complete(C),d=""}}function l(e){e=e||{};var t=e.delimiter,i=e.newline,r=e.comments,n=e.step,o=e.preview,a=e.fastMode;if(("string"!=typeof t||T.BAD_DELIMITERS.indexOf(t)>-1)&&(t=","),r===t)throw"Comment character same as delimiter";r===!0?r="#":("string"!=typeof r||T.BAD_DELIMITERS.indexOf(r)>-1)&&(r=!1),"\n"!=i&&"\r"!=i&&"\r\n"!=i&&(i="\n");var s=0,l=!1;this.parse=function(e,c,d){function h(e){C.push(e),T=s}function u(t){return d?g():("undefined"==typeof t&&(t=e.substr(s)),S.push(t),s=m,h(S),b&&f(),g())}function p(t){s=t,h(S),S=[],L=e.indexOf(i,s)}function g(e){return{data:C,errors:x,meta:{delimiter:t,linebreak:i,aborted:l,truncated:!!e,cursor:T+(c||0)}}}function f(){n(g()),C=[],x=[]}if("string"!=typeof e)throw"Input must be a string";var m=e.length,v=t.length,y=i.length,k=r.length,b="function"==typeof n;s=0;var C=[],x=[],S=[],T=0;if(!e)return g();if(a||a!==!1&&-1===e.indexOf('"')){for(var w=e.split(i),P=0;P<w.length;P++){var S=w[P];if(s+=S.length,P!==w.length-1)s+=i.length;else if(d)return g();if(!r||S.substr(0,k)!=r){if(b){if(C=[],h(S.split(t)),f(),l)return g()}else h(S.split(t));if(o&&P>=o)return C=C.slice(0,o),g(!0)}}return g()}for(var N=e.indexOf(t,s),L=e.indexOf(i,s);;)if('"'!=e[s])if(r&&0===S.length&&e.substr(s,k)===r){if(-1==L)return g();s=L+y,L=e.indexOf(i,s),N=e.indexOf(t,s)}else if(-1!==N&&(L>N||-1===L))S.push(e.substring(s,N)),s=N+v,N=e.indexOf(t,s);else{if(-1===L)break;if(S.push(e.substring(s,L)),p(L+y),b&&(f(),l))return g();if(o&&C.length>=o)return g(!0)}else{var I=s;for(s++;;){var I=e.indexOf('"',I+1);if(-1===I)return d||x.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:C.length,index:s}),u();if(I===m-1){var A=e.substring(s,I).replace(/""/g,'"');return u(A)}if('"'!=e[I+1]){if(e[I+1]==t){S.push(e.substring(s,I).replace(/""/g,'"')),s=I+1+v,N=e.indexOf(t,s),L=e.indexOf(i,s);break}if(e.substr(I+1,y)===i){if(S.push(e.substring(s,I).replace(/""/g,'"')),p(I+1+y),N=e.indexOf(t,s),b&&(f(),l))return g();if(o&&C.length>=o)return g(!0);break}}else I++}}return u()},this.abort=function(){l=!0},this.getCharIndex=function(){return s}}function c(){var e=document.getElementsByTagName("script");return e.length?e[e.length-1].src:""}function d(){if(!T.WORKERS_SUPPORTED)return!1;if(!C&&null===T.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var t=T.SCRIPT_PATH||y;t+=(-1!==t.indexOf("?")?"&":"?")+"papaworker";var i=new e.Worker(t);return i.onmessage=h,i.id=S++,x[i.id]=i,i}function h(e){var t=e.data,i=x[t.workerId],r=!1;if(t.error)i.userError(t.error,t.file);else if(t.results&&t.results.data){var n=function(){r=!0,u(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},o={abort:n,pause:p,resume:p};if(v(i.userStep)){for(var a=0;a<t.results.data.length&&(i.userStep({data:[t.results.data[a]],errors:t.results.errors,meta:t.results.meta},o),!r);a++);delete t.results}else v(i.userChunk)&&(i.userChunk(t.results,o,t.file),delete t.results)}t.finished&&!r&&u(t.workerId,t.results)}function u(e,t){var i=x[e];v(i.userComplete)&&i.userComplete(t),i.terminate(),delete x[e]}function p(){throw"Not implemented."}function g(t){var i=t.data;if("undefined"==typeof T.WORKER_ID&&i&&(T.WORKER_ID=i.workerId),"string"==typeof i.input)e.postMessage({workerId:T.WORKER_ID,results:T.parse(i.input,i.config),finished:!0});else if(e.File&&i.input instanceof File||i.input instanceof Object){var r=T.parse(i.input,i.config);r&&e.postMessage({workerId:T.WORKER_ID,results:r,finished:!0})}}function f(e){if("object"!=typeof e)return e;var t=e instanceof Array?[]:{};for(var i in e)t[i]=f(e[i]);return t}function m(e,t){return function(){e.apply(t,arguments)}}function v(e){return"function"==typeof e}var y,k=!e.document&&!!e.postMessage,b=k&&/(\?|&)papaworker(=|&|$)/.test(e.location.search),C=!1,x={},S=0,T={};if(T.parse=t,T.unparse=i,T.RECORD_SEP=String.fromCharCode(30),T.UNIT_SEP=String.fromCharCode(31),T.BYTE_ORDER_MARK="\ufeff",T.BAD_DELIMITERS=["\r","\n",'"',T.BYTE_ORDER_MARK],T.WORKERS_SUPPORTED=!k&&!!e.Worker,T.SCRIPT_PATH=null,T.LocalChunkSize=10485760,T.RemoteChunkSize=5242880,T.DefaultDelimiter=",",T.Parser=l,T.ParserHandle=s,T.NetworkStreamer=n,T.FileStreamer=o,T.StringStreamer=a,"undefined"!=typeof module&&module.exports?module.exports=T:v(e.define)&&e.define.amd?define(function(){return T}):e.Papa=T,e.jQuery){var w=e.jQuery;w.fn.parse=function(t){function i(){if(0==a.length)return void(v(t.complete)&&t.complete());var e=a[0];if(v(t.before)){var i=t.before(e.file,e.inputElem);if("object"==typeof i){if("abort"==i.action)return void r("AbortError",e.file,e.inputElem,i.reason);if("skip"==i.action)return void n();"object"==typeof i.config&&(e.instanceConfig=w.extend(e.instanceConfig,i.config))}else if("skip"==i)return void n()}var o=e.instanceConfig.complete;e.instanceConfig.complete=function(t){v(o)&&o(t,e.file,e.inputElem),n()},T.parse(e.file,e.instanceConfig)}function r(e,i,r,n){v(t.error)&&t.error({name:e},i,r,n)}function n(){a.splice(0,1),i()}var o=t.config||{},a=[];return this.each(function(){var t="INPUT"==w(this).prop("tagName").toUpperCase()&&"file"==w(this).attr("type").toLowerCase()&&e.FileReader;if(!t||!this.files||0==this.files.length)return!0;for(var i=0;i<this.files.length;i++)a.push({file:this.files[i],inputElem:this,instanceConfig:w.extend({},o)})}),i(),this}}b?e.onmessage=g:T.WORKERS_SUPPORTED&&(y=c(),document.body?document.addEventListener("DOMContentLoaded",function(){C=!0},!0):C=!0),n.prototype=Object.create(r.prototype),n.prototype.constructor=n,o.prototype=Object.create(r.prototype),o.prototype.constructor=o,a.prototype=Object.create(a.prototype),a.prototype.constructor=a}("undefined"!=typeof window?window:this);